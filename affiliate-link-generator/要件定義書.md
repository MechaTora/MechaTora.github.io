# Amazon・楽天アフィリエイトリンク生成ツール 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
Amazon・楽天アフィリエイトリンク生成ツール

### 1.2 目的
- Excelファイルに記載された商品名から自動的にAmazon・楽天のアフィリエイトリンクを生成
- 第三者配布可能な形で整備し、Python未経験者でも使用可能にする

### 1.3 対象ユーザー
- アフィリエイトサイト運営者
- ブロガー・コンテンツ作成者
- Python未経験者を含む一般ユーザー

## 2. 機能要件

### 2.1 基本機能

#### 2.1.1 Excel ファイル読み込み機能
- **対応形式**: .xlsx, .xls, .et（WPS Spreadsheets）
- **データ構造**: 
  - A列: 商品番号（オプション）
  - B列: 商品名（必須）
  - C列: Amazonリンク（出力）
  - D列: 楽天リンク（出力）
- **互換性**: WPS Spreadsheets形式のファイル読み込み対応
- **エラーハンドリング**: 詳細なエラー分析と解決方法の提示

#### 2.1.2 商品検索機能
- **Amazon検索**: 商品名からAmazon商品を検索
- **楽天検索**: 商品名から楽天市場商品を検索
- **検索アルゴリズム**: 関連度の高い商品を上位表示

#### 2.1.3 アフィリエイトリンク生成機能
- **Amazonアフィリエイト**: Amazon Associates対応リンク生成
- **楽天アフィリエイト**: 楽天アフィリエイト対応リンク生成
- **リンク検証**: 生成されたリンクの有効性確認

#### 2.1.4 Excel ファイル保存機能
- **自動保存**: 処理完了後の自動保存機能
- **手動保存**: ユーザー操作による保存機能
- **バックアップ**: 元ファイルのバックアップ作成（タイムスタンプ付き）
- **スタイル設定**: ヘッダー行の装飾、列幅自動調整

### 2.2 GUI機能

#### 2.2.1 メインインターface
- **tkinter**ベースのデスクトップアプリケーション
- **ファイル選択**: ドラッグ&ドロップまたはファイル選択ダイアログ
- **進捗表示**: リアルタイム処理状況表示
- **ログ表示**: 処理結果とエラーメッセージ表示

#### 2.2.2 設定機能
- **アフィリエイトID設定**: Amazon・楽天のアフィリエイトID管理
- **処理オプション**: バックアップ作成の有無等

#### 2.2.3 サンプルファイル作成
- **テンプレート生成**: 適切な形式のExcelファイル自動作成
- **サンプルデータ**: 動作確認用のサンプル商品データ

## 3. 非機能要件

### 3.1 性能要件
- **処理速度**: 100商品あたり5-10分以内での処理完了
- **同時処理**: 複数商品の並行処理対応
- **メモリ使用量**: 一般的なPC環境（4GB RAM）で動作

### 3.2 互換性要件
- **OS対応**: Windows 10/11（主要対象）、Linux（開発環境）
- **Python バージョン**: Python 3.8以上
- **Excel 互換性**: Microsoft Excel、WPS Spreadsheets対応

### 3.3 可用性要件
- **エラー処理**: 網羅的なエラーハンドリング
- **復旧機能**: 処理中断時の状態復旧
- **ログ機能**: 詳細な処理ログ出力

## 4. 実装要件

### 4.1 技術スタック
- **メイン言語**: Python 3.8+
- **GUI**: tkinter
- **Excel操作**: openpyxl
- **Web スクレイピング**: selenium
- **設定管理**: configparser

### 4.2 ファイル構成
```
affiliate-link-generator/
├── main_app.py              # メインGUIアプリケーション
├── excel_manager.py         # Excel操作管理
├── amazon_scraper.py        # Amazon検索・スクレイピング
├── rakuten_scraper.py       # 楽天検索・スクレイピング
├── config_manager.py        # 設定管理
├── run_app.py              # アプリケーションランチャー
├── requirements.txt         # 依存関係
├── 配布用/                 # 配布パッケージ
│   ├── start.bat           # Windows起動スクリプト
│   ├── インストールと使い方.html
│   ├── WPS_互換性ガイド.md
│   └── ソースコード/       # 実行コード一式
└── 要件定義書.md           # この文書
```

### 4.3 配布要件
- **Windows バッチファイル**: 非技術者向け起動スクリプト
- **HTML ドキュメント**: 使用方法ガイド
- **フォルダ構成**: 分かりやすいファイル配置
- **エラーガイド**: WPS互換性ガイド等のトラブルシューティング

## 5. 制約事項

### 5.1 技術制約
- **ブラウザ依存**: Selenium WebDriverによるブラウザ自動化
- **ネットワーク依存**: インターネット接続必須
- **レート制限**: Amazon・楽天側のアクセス制限への配慮

### 5.2 法的制約
- **利用規約遵守**: Amazon Associates、楽天アフィリエイトの利用規約
- **個人情報**: アフィリエイトIDは適切に管理
- **著作権**: スクレイピング対象サイトの著作権配慮

## 6. 実装履歴

### 6.1 Phase 1: 基本機能実装
- ✅ Excel読み込み機能
- ✅ Amazon・楽天検索機能  
- ✅ GUI基本機能
- ✅ 自動保存機能追加

### 6.2 Phase 2: 配布対応
- ✅ 配布用フォルダ整備
- ✅ Windows バッチファイル作成
- ✅ HTML使用ガイド作成
- ✅ GUI モダン化試行（後に元に戻す）

### 6.3 Phase 3: 互換性強化
- ✅ WPS Spreadsheets対応
- ✅ 詳細エラー分析機能
- ✅ 互換性ガイド作成
- ✅ エラーログ詳細化

## 7. 今後の改善予定

### 7.1 機能拡張
- [ ] Yahoo!ショッピング対応
- [ ] 価格比較機能
- [ ] 商品画像取得機能
- [ ] バッチ処理最適化

### 7.2 UI/UX 改善
- [ ] プログレスバー追加
- [ ] 結果プレビュー機能
- [ ] 設定画面改善

### 7.3 配布改善
- [ ] インストーラー作成
- [ ] 自動アップデート機能
- [ ] 使用統計収集

## 8. サポート情報

### 8.1 ドキュメント
- **使用ガイド**: `/配布用/インストールと使い方.html`
- **互換性ガイド**: `/配布用/WPS_互換性ガイド.md`
- **要件定義**: `/要件定義書.md`

### 8.2 トラブルシューティング
- **エラー分析**: 詳細なエラーメッセージと解決方法
- **ファイル形式**: Excel/WPS互換性問題の対処法
- **環境問題**: Python・依存関係インストール問題

---

**最終更新日**: 2025年9月4日  
**バージョン**: v1.0  
**作成者**: Claude Code Assistant