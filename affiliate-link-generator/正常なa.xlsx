#!/usr/bin/env python3
"""
正常なa.xlsxファイルを作成するスクリプト
"""

from openpyxl import Workbook
import os

def create_proper_a_xlsx():
    """
    正常なExcel形式のa.xlsxファイルを作成
    """
    print("📄 正常なa.xlsxファイルを作成中...")
    
    wb = Workbook()
    ws = wb.active
    ws.title = "商品リスト"
    
    # ヘッダー
    ws['A1'] = "商品番号"
    ws['B1'] = "商品名" 
    ws['C1'] = "Amazonリンク"
    ws['D1'] = "楽天リンク"
    
    # サンプル商品データ
    products = [
        "iPhone 15 Pro",
        "MacBook Air M3", 
        "AirPods Pro",
        "Apple Watch Series 9",
        "iPad Air"
    ]
    
    for i, product in enumerate(products, 2):
        ws[f'A{i}'] = i-1
        ws[f'B{i}'] = product
    
    # 正常なExcel形式で保存
    wb.save("a.xlsx")
    
    # ファイル情報確認
    size = os.path.getsize("a.xlsx")
    print(f"✅ 正常なa.xlsxファイル作成完了")
    print(f"   ファイルサイズ: {size / 1024:.1f} KB")
    print(f"   商品数: {len(products)}個")

if __name__ == "__main__":
    create_proper_a_xlsx()