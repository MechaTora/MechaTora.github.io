<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬8ç« : readr - ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã¨ãƒ‘ãƒ¼ã‚¹ã®å®Œå…¨ã‚¬ã‚¤ãƒ‰ | Tidyverseå®Œå…¨ãƒã‚¹ã‚¿ãƒ¼</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --accent-neon: #00ff88;
            --accent-cyan: #00d4ff;
            --accent-purple: #9d4edd;
            --accent-red: #ff6b6b;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --border-neon: #00ff88;
            --shadow-neon: 0 0 20px #00ff8840;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: linear-gradient(45deg, var(--bg-secondary), var(--bg-tertiary));
            border-radius: 20px;
            border: 2px solid var(--accent-red);
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.4);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 107, 107, 0.1), transparent);
            animation: scan 3s infinite;
        }

        @keyframes scan {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        h1 {
            font-size: 3rem;
            font-weight: 700;
            color: var(--accent-red);
            margin-bottom: 10px;
            text-shadow: 0 0 20px var(--accent-red);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.4rem;
            color: var(--accent-cyan);
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .chapter-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            position: relative;
            z-index: 1;
        }

        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .progress-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            border: 2px solid var(--text-secondary);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--accent-red);
            border-color: var(--accent-red);
            box-shadow: 0 0 10px var(--accent-red);
        }

        .progress-dot.completed {
            background: var(--accent-cyan);
            border-color: var(--accent-cyan);
        }

        /* Navigation Widget */
        .chapter-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin: 30px 0;
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: 15px;
            border: 1px solid var(--accent-red);
            width: fit-content;
            max-width: 90vw;
            margin-left: auto;
            margin-right: auto;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 4px 10px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            text-decoration: none;
            border-radius: 5px;
            border: 1px solid var(--accent-cyan);
            transition: all 0.3s ease;
            font-size: 0.8rem;
            white-space: nowrap;
        }

        .nav-button:hover {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            box-shadow: 0 0 15px var(--accent-cyan);
            transform: translateY(-2px);
        }

        .nav-button.current {
            background: var(--accent-red);
            color: var(--bg-primary);
            box-shadow: 0 0 15px var(--accent-red);
        }

        /* Content Sections */
        .section {
            background: var(--bg-secondary);
            margin: 30px 0;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid var(--accent-purple);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-red), var(--accent-cyan), var(--accent-purple));
            border-radius: 15px 15px 0 0;
        }

        h2 {
            color: var(--accent-red);
            font-size: 2rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--accent-red);
        }

        h3 {
            color: var(--accent-cyan);
            font-size: 1.5rem;
            margin: 25px 0 15px 0;
            text-shadow: 0 0 8px var(--accent-cyan);
        }

        h4 {
            color: var(--accent-purple);
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
        }

        /* Code Blocks */
        .code-container {
            margin: 20px 0;
            background: #1a1a1a;
            border-radius: 10px;
            border: 1px solid var(--accent-red);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.1);
        }

        .code-header {
            background: var(--accent-red);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-header::before {
            content: 'ğŸ“‚';
            font-size: 1.1rem;
        }

        .code-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            background: #0d1117;
            color: #c9d1d9;
            overflow-x: auto;
        }

        /* Syntax highlighting */
        .keyword { color: #ff7b72; }
        .function { color: #d2a8ff; }
        .string { color: #a5d6ff; }
        .comment { color: #8b949e; font-style: italic; }
        .operator { color: #f85149; }
        .number { color: #79c0ff; }
        .variable { color: #ffa657; }

        /* Output Display */
        .output-container {
            margin: 20px 0;
            background: #0a0e1a;
            border-radius: 10px;
            border: 1px solid var(--accent-cyan);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.1);
        }

        .output-header {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .output-header::before {
            content: 'ğŸ’¾';
        }

        .output-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--accent-cyan);
        }

        /* File Format Display */
        .file-format {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            border: 1px solid var(--accent-purple);
        }

        .format-title {
            color: var(--accent-purple);
            font-size: 1.1rem;
            margin-bottom: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .format-title::before {
            content: 'ğŸ“„';
        }

        .format-example {
            background: var(--bg-primary);
            padding: 10px;
            border-radius: 5px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--text-secondary);
            border: 1px solid var(--accent-purple);
        }

        /* Data Tables */
        .data-table {
            margin: 20px 0;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-tertiary);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid var(--accent-red);
        }

        th {
            background: var(--accent-red);
            color: var(--bg-primary);
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--bg-secondary);
            color: var(--text-primary);
        }

        tr:nth-child(even) {
            background: rgba(255, 107, 107, 0.05);
        }

        tr:hover {
            background: rgba(255, 107, 107, 0.1);
        }

        /* Key Points */
        .key-points {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1) 0%, rgba(0, 212, 255, 0.1) 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-red);
        }

        .key-points h4 {
            color: var(--accent-red);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .key-points h4::before {
            content: 'ğŸ’¡';
        }

        .key-points ul {
            list-style: none;
            padding-left: 0;
        }

        .key-points li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .key-points li::before {
            content: 'â–¶';
            color: var(--accent-cyan);
            position: absolute;
            left: 0;
        }

        /* Warning/Tip boxes */
        .tip-box {
            background: rgba(157, 78, 221, 0.1);
            border: 1px solid var(--accent-purple);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-purple);
        }

        .tip-box h4 {
            color: var(--accent-purple);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tip-box h4::before {
            content: 'âš ï¸';
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }

            .chapter-meta {
                flex-direction: column;
                gap: 10px;
            }

            .chapter-nav {
                gap: 5px;
                padding: 8px;
            }

            .nav-button {
                padding: 3px 7px;
                font-size: 0.7rem;
            }

            .section {
                padding: 20px;
                margin: 20px 0;
            }

            h2 {
                font-size: 1.5rem;
            }

            .code-content, .output-content {
                font-size: 0.85rem;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ç¬¬8ç« : readr</h1>
            <p class="subtitle">ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã¨ãƒ‘ãƒ¼ã‚¹ã®å®Œå…¨ã‚¬ã‚¤ãƒ‰</p>
            <div class="chapter-meta">
                <span>ğŸ“‚ ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿</span>
                <span>ğŸ”§ ãƒ‡ãƒ¼ã‚¿ãƒ‘ãƒ¼ã‚¹</span>
                <span>âš¡ é«˜é€Ÿå‡¦ç†</span>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>
        </header>

        <nav class="chapter-nav">
            <a href="chapter1-tidyverse-overview.html" class="nav-button">ç¬¬1ç« </a>
            <a href="chapter2-dplyr-data-manipulation.html" class="nav-button">ç¬¬2ç« </a>
            <a href="chapter3-ggplot2-visualization.html" class="nav-button">ç¬¬3ç« </a>
            <a href="chapter4-tidyr-data-reshaping.html" class="nav-button">ç¬¬4ç« </a>
            <a href="chapter5-stringr-text-processing.html" class="nav-button">ç¬¬5ç« </a>
            <a href="chapter6-forcats-purrr-advanced.html" class="nav-button">ç¬¬6ç« </a>
            <a href="chapter7-lubridate-datetime.html" class="nav-button">ç¬¬7ç« </a>
            <a href="#" class="nav-button current">ç¬¬8ç« </a>
        </nav>

        <section class="section">
            <h2>ğŸ“‚ readrã®åŸºæœ¬: CSVãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿</h2>
            
            <p>readrãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€Tidyverseã®ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å°‚ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã™ã€‚å¾“æ¥ã®base Rã®é–¢æ•°ã‚ˆã‚Šã‚‚é«˜é€Ÿã§ã€å‹æ¨å®šãŒæ­£ç¢ºã€ã‹ã¤tibbleã¨ã—ã¦èª­ã¿è¾¼ã¾ã‚Œã¾ã™ã€‚</p>

            <h3>åŸºæœ¬çš„ãªCSVèª­ã¿è¾¼ã¿</h3>

            <div class="code-container">
                <div class="code-header">read_csv()ã®åŸºæœ¬ä½¿ç”¨æ³•</div>
                <div class="code-content">
<span class="keyword">library</span>(<span class="string">readr</span>)
<span class="keyword">library</span>(<span class="string">dplyr</span>)

<span class="comment"># ã‚µãƒ³ãƒ—ãƒ«CSVãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ</span>
sample_csv_content <span class="operator">&lt;-</span> <span class="string">"name,age,salary,department,hire_date
ç”°ä¸­å¤ªéƒ,28,450000,å–¶æ¥­,2020-04-01
ä½è—¤èŠ±å­,32,520000,é–‹ç™º,2019-03-15
éˆ´æœ¨ä¸€éƒ,45,780000,ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ,2015-07-20
é«˜æ©‹ç¾å’²,25,380000,ãƒ‡ã‚¶ã‚¤ãƒ³,2021-09-10
å±±ç”°å¥å¤ª,39,650000,é–‹ç™º,2017-11-05"</span>

<span class="comment"># æ–‡å­—åˆ—ã‹ã‚‰ç›´æ¥èª­ã¿è¾¼ã¿</span>
employee_data <span class="operator">&lt;-</span> <span class="function">read_csv</span>(sample_csv_content)
<span class="function">print</span>(employee_data)

<span class="comment"># ãƒ‡ãƒ¼ã‚¿å‹ã®ç¢ºèª</span>
<span class="function">str</span>(employee_data)

<span class="comment"># åˆ—ã®å‹ã‚’æ˜ç¤ºçš„ã«æŒ‡å®š</span>
employee_data_typed <span class="operator">&lt;-</span> <span class="function">read_csv</span>(sample_csv_content,
  col_types <span class="operator">=</span> <span class="function">cols</span>(
    name <span class="operator">=</span> <span class="function">col_character</span>(),
    age <span class="operator">=</span> <span class="function">col_integer</span>(),
    salary <span class="operator">=</span> <span class="function">col_double</span>(),
    department <span class="operator">=</span> <span class="function">col_character</span>(),
    hire_date <span class="operator">=</span> <span class="function">col_date</span>()
  )
)

<span class="function">print</span>(<span class="string">"å‹æŒ‡å®šå¾Œã®ãƒ‡ãƒ¼ã‚¿:"</span>)
<span class="function">str</span>(employee_data_typed)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">CSVèª­ã¿è¾¼ã¿çµæœ</div>
                <div class="output-content"># A tibble: 5 Ã— 5
  name     age salary department hire_date 
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;      &lt;date&gt;    
1 ç”°ä¸­å¤ªéƒ    28 450000 å–¶æ¥­       2020-04-01
2 ä½è—¤èŠ±å­    32 520000 é–‹ç™º       2019-03-15
3 éˆ´æœ¨ä¸€éƒ    45 780000 ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ 2015-07-20
4 é«˜æ©‹ç¾å’²    25 380000 ãƒ‡ã‚¶ã‚¤ãƒ³   2021-09-10
5 å±±ç”°å¥å¤ª    39 650000 é–‹ç™º       2017-11-05

Classes 'spec_tbl_df', 'tbl_df', 'tbl' and 'data.frame':	5 obs. of  5 variables:
 $ name      : chr  "ç”°ä¸­å¤ªéƒ" "ä½è—¤èŠ±å­" "éˆ´æœ¨ä¸€éƒ" "é«˜æ©‹ç¾å’²" ...
 $ age       : int  28 32 45 25 39
 $ salary    : num  450000 520000 780000 380000 650000
 $ department: chr  "å–¶æ¥­" "é–‹ç™º" "ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ" "ãƒ‡ã‚¶ã‚¤ãƒ³" ...
 $ hire_date : Date, format: "2020-04-01" "2019-03-15" ...</div>
            </div>

            <h3>æ§˜ã€…ãªãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã®èª­ã¿è¾¼ã¿</h3>

            <div class="file-format">
                <div class="format-title">CSVï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</div>
                <div class="format-example">name,age,salary
ç”°ä¸­å¤ªéƒ,28,450000
ä½è—¤èŠ±å­,32,520000</div>
            </div>

            <div class="file-format">
                <div class="format-title">TSVï¼ˆã‚¿ãƒ–åŒºåˆ‡ã‚Šï¼‰</div>
                <div class="format-example">name	age	salary
ç”°ä¸­å¤ªéƒ	28	450000
ä½è—¤èŠ±å­	32	520000</div>
            </div>

            <div class="code-container">
                <div class="code-header">å„ç¨®å½¢å¼ã®èª­ã¿è¾¼ã¿</div>
                <div class="code-content">
<span class="comment"># TSVãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿</span>
tsv_content <span class="operator">&lt;-</span> <span class="string">"name\tage\tsalary\tdepartment
ç”°ä¸­å¤ªéƒ\t28\t450000\tå–¶æ¥­
ä½è—¤èŠ±å­\t32\t520000\té–‹ç™º
éˆ´æœ¨ä¸€éƒ\t45\t780000\tãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ"</span>

tsv_data <span class="operator">&lt;-</span> <span class="function">read_tsv</span>(tsv_content)
<span class="function">print</span>(tsv_data)

<span class="comment"># ã‚«ã‚¹ã‚¿ãƒ åŒºåˆ‡ã‚Šæ–‡å­—ã®ãƒ•ã‚¡ã‚¤ãƒ«</span>
custom_delim_content <span class="operator">&lt;-</span> <span class="string">"name|age|salary|department
ç”°ä¸­å¤ªéƒ|28|450000|å–¶æ¥­
ä½è—¤èŠ±å­|32|520000|é–‹ç™º
éˆ´æœ¨ä¸€éƒ|45|780000|ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ"</span>

custom_data <span class="operator">&lt;-</span> <span class="function">read_delim</span>(custom_delim_content, delim <span class="operator">=</span> <span class="string">"|"</span>)
<span class="function">print</span>(custom_data)

<span class="comment"># å›ºå®šå¹…ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿</span>
fixed_width_content <span class="operator">&lt;-</span> <span class="string">"ç”°ä¸­å¤ªéƒ    28450000å–¶æ¥­    
ä½è—¤èŠ±å­    32520000é–‹ç™º    
éˆ´æœ¨ä¸€éƒ    45780000ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ"</span>

fixed_data <span class="operator">&lt;-</span> <span class="function">read_fwf</span>(fixed_width_content,
  <span class="function">fwf_widths</span>(<span class="function">c</span>(<span class="number">8</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>), <span class="function">c</span>(<span class="string">"name"</span>, <span class="string">"age"</span>, <span class="string">"salary"</span>, <span class="string">"department"</span>))
)
<span class="function">print</span>(fixed_data)

<span class="comment"># ãƒ˜ãƒƒãƒ€ãƒ¼ãªã—ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿</span>
no_header_content <span class="operator">&lt;-</span> <span class="string">"ç”°ä¸­å¤ªéƒ,28,450000,å–¶æ¥­
ä½è—¤èŠ±å­,32,520000,é–‹ç™º
éˆ´æœ¨ä¸€éƒ,45,780000,ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ"</span>

no_header_data <span class="operator">&lt;-</span> <span class="function">read_csv</span>(no_header_content, 
  col_names <span class="operator">=</span> <span class="function">c</span>(<span class="string">"name"</span>, <span class="string">"age"</span>, <span class="string">"salary"</span>, <span class="string">"department"</span>)
)
<span class="function">print</span>(no_header_data)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">å„ç¨®å½¢å¼èª­ã¿è¾¼ã¿çµæœ</div>
                <div class="output-content"># A tibble: 3 Ã— 4
  name     age salary department
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;     
1 ç”°ä¸­å¤ªéƒ    28 450000 å–¶æ¥­      
2 ä½è—¤èŠ±å­    32 520000 é–‹ç™º      
3 éˆ´æœ¨ä¸€éƒ    45 780000 ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ

# A tibble: 3 Ã— 4
  name     age salary department
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;     
1 ç”°ä¸­å¤ªéƒ    28 450000 å–¶æ¥­      
2 ä½è—¤èŠ±å­    32 520000 é–‹ç™º      
3 éˆ´æœ¨ä¸€éƒ    45 780000 ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ

# A tibble: 3 Ã— 4
  name     age salary department
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;     
1 ç”°ä¸­å¤ªéƒ    28 450000 å–¶æ¥­      
2 ä½è—¤èŠ±å­    32 520000 é–‹ç™º      
3 éˆ´æœ¨ä¸€éƒ    45 780000 ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ</div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ”§ é«˜åº¦ãªãƒ‘ãƒ¼ã‚¹ã‚ªãƒ—ã‚·ãƒ§ãƒ³</h2>

            <h3>æ¬ æå€¤ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</h3>

            <div class="code-container">
                <div class="code-header">æ¬ æå€¤å‡¦ç†ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</div>
                <div class="code-content">
<span class="comment"># æ¬ æå€¤ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿</span>
messy_data_content <span class="operator">&lt;-</span> <span class="string">"name,age,salary,department,rating
ç”°ä¸­å¤ªéƒ,28,450000,å–¶æ¥­,4.5
ä½è—¤èŠ±å­,,520000,é–‹ç™º,N/A
éˆ´æœ¨ä¸€éƒ,45,NULL,ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ,5.0
é«˜æ©‹ç¾å’²,25,380000,,4.2
å±±ç”°å¥å¤ª,invalid,650000,é–‹ç™º,3.8"</span>

<span class="comment"># æ¬ æå€¤ã®æŒ‡å®š</span>
messy_data <span class="operator">&lt;-</span> <span class="function">read_csv</span>(messy_data_content, 
  na <span class="operator">=</span> <span class="function">c</span>(<span class="string">""</span>, <span class="string">"NA"</span>, <span class="string">"N/A"</span>, <span class="string">"NULL"</span>, <span class="string">"invalid"</span>)
)

<span class="function">print</span>(messy_data)
<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"æ¬ æå€¤ã®æ•°:"</span>, <span class="function">sum</span>(<span class="function">is.na</span>(messy_data))))

<span class="comment"># å‹å¤‰æ›ã®å•é¡Œã‚’ç¢ºèª</span>
parsing_problems <span class="operator">&lt;-</span> <span class="function">problems</span>(messy_data)
<span class="keyword">if</span> (<span class="function">nrow</span>(parsing_problems) <span class="operator">&gt;</span> <span class="number">0</span>) {
  <span class="function">print</span>(<span class="string">"ãƒ‘ãƒ¼ã‚¹å•é¡Œ:"</span>)
  <span class="function">print</span>(parsing_problems)
}

<span class="comment"># å®‰å…¨ãªå‹æŒ‡å®š</span>
safe_data <span class="operator">&lt;-</span> <span class="function">read_csv</span>(messy_data_content,
  col_types <span class="operator">=</span> <span class="function">cols</span>(
    name <span class="operator">=</span> <span class="function">col_character</span>(),
    age <span class="operator">=</span> <span class="function">col_integer</span>(),
    salary <span class="operator">=</span> <span class="function">col_double</span>(),
    department <span class="operator">=</span> <span class="function">col_character</span>(),
    rating <span class="operator">=</span> <span class="function">col_double</span>()
  ),
  na <span class="operator">=</span> <span class="function">c</span>(<span class="string">""</span>, <span class="string">"NA"</span>, <span class="string">"N/A"</span>, <span class="string">"NULL"</span>, <span class="string">"invalid"</span>)
)

<span class="function">print</span>(<span class="string">"å®‰å…¨ã«èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿:"</span>)
<span class="function">print</span>(safe_data)

<span class="comment"># æ¬ æå€¤ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ†æ</span>
missing_summary <span class="operator">&lt;-</span> safe_data <span class="operator">%&gt;%</span>
  <span class="function">summarise_all</span>(~ <span class="function">sum</span>(<span class="function">is.na</span>(.))) <span class="operator">%&gt;%</span>
  <span class="function">pivot_longer</span>(<span class="function">everything</span>(), names_to <span class="operator">=</span> <span class="string">"column"</span>, values_to <span class="operator">=</span> <span class="string">"missing_count"</span>)

<span class="function">print</span>(<span class="string">"åˆ—åˆ¥æ¬ æå€¤æ•°:"</span>)
<span class="function">print</span>(missing_summary)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">æ¬ æå€¤å‡¦ç†çµæœ</div>
                <div class="output-content"># A tibble: 5 Ã— 5
  name      age salary department rating
  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;
1 ç”°ä¸­å¤ªéƒ     28 450000 å–¶æ¥­          4.5
2 ä½è—¤èŠ±å­     NA 520000 é–‹ç™º           NA
3 éˆ´æœ¨ä¸€éƒ     45     NA ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ     5  
4 é«˜æ©‹ç¾å’²     25 380000 NA            4.2
5 å±±ç”°å¥å¤ª     NA 650000 é–‹ç™º          3.8

[1] "æ¬ æå€¤ã®æ•°: 5"

# A tibble: 5 Ã— 2
  column     missing_count
  &lt;chr&gt;              &lt;int&gt;
1 name                   0
2 age                    2
3 salary                 1
4 department             1
5 rating                 1</div>
            </div>

            <h3>ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ãƒ­ã‚±ãƒ¼ãƒ«è¨­å®š</h3>

            <div class="code-container">
                <div class="code-header">æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®å‡¦ç†</div>
                <div class="code-content">
<span class="comment"># æ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«ã®è¨­å®š</span>
jp_locale <span class="operator">&lt;-</span> <span class="function">locale</span>(
  encoding <span class="operator">=</span> <span class="string">"UTF-8"</span>,
  decimal_mark <span class="operator">=</span> <span class="string">"."</span>,
  grouping_mark <span class="operator">=</span> <span class="string">","</span>,
  date_format <span class="operator">=</span> <span class="string">"%Y-%m-%d"</span>,
  time_format <span class="operator">=</span> <span class="string">"%H:%M:%S"</span>
)

<span class="comment"># æ•°å€¤å½¢å¼ã®ç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿</span>
numeric_data_content <span class="operator">&lt;-</span> <span class="string">"product,price,quantity,date
è£½å“A,\"1,250.50\",100,2023-12-01
è£½å“B,\"2,350.75\",75,2023-12-02
è£½å“C,\"890.25\",200,2023-12-03"</span>

<span class="comment"># ãƒ­ã‚±ãƒ¼ãƒ«æŒ‡å®šã§ã®èª­ã¿è¾¼ã¿</span>
numeric_data <span class="operator">&lt;-</span> <span class="function">read_csv</span>(numeric_data_content, locale <span class="operator">=</span> jp_locale)
<span class="function">print</span>(numeric_data)

<span class="comment"># ç•°ãªã‚‹æ—¥ä»˜å½¢å¼ã¸ã®å¯¾å¿œ</span>
date_format_content <span class="operator">&lt;-</span> <span class="string">"event,date_jp,date_us,date_iso
ã‚¤ãƒ™ãƒ³ãƒˆ1,2023/12/01,12/01/2023,2023-12-01
ã‚¤ãƒ™ãƒ³ãƒˆ2,2023/12/15,12/15/2023,2023-12-15
ã‚¤ãƒ™ãƒ³ãƒˆ3,2024/01/05,01/05/2024,2024-01-05"</span>

date_data <span class="operator">&lt;-</span> <span class="function">read_csv</span>(date_format_content,
  col_types <span class="operator">=</span> <span class="function">cols</span>(
    event <span class="operator">=</span> <span class="function">col_character</span>(),
    date_jp <span class="operator">=</span> <span class="function">col_date</span>(format <span class="operator">=</span> <span class="string">"%Y/%m/%d"</span>),
    date_us <span class="operator">=</span> <span class="function">col_date</span>(format <span class="operator">=</span> <span class="string">"%m/%d/%Y"</span>),
    date_iso <span class="operator">=</span> <span class="function">col_date</span>()
  )
)

<span class="function">print</span>(date_data)

<span class="comment"># æ™‚åˆ»ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†</span>
time_data_content <span class="operator">&lt;-</span> <span class="string">"task,start_time,end_time,duration
ã‚¿ã‚¹ã‚¯1,09:30:00,11:45:30,02:15:30
ã‚¿ã‚¹ã‚¯2,14:00:00,16:30:45,02:30:45
ã‚¿ã‚¹ã‚¯3,10:15:30,12:00:00,01:44:30"</span>

time_data <span class="operator">&lt;-</span> <span class="function">read_csv</span>(time_data_content,
  col_types <span class="operator">=</span> <span class="function">cols</span>(
    task <span class="operator">=</span> <span class="function">col_character</span>(),
    start_time <span class="operator">=</span> <span class="function">col_time</span>(),
    end_time <span class="operator">=</span> <span class="function">col_time</span>(),
    duration <span class="operator">=</span> <span class="function">col_time</span>()
  )
)

<span class="function">print</span>(time_data)
<span class="function">str</span>(time_data)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å‡¦ç†çµæœ</div>
                <div class="output-content"># A tibble: 3 Ã— 4
  product price quantity date      
  &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;date&gt;    
1 è£½å“A   1251.      100 2023-12-01
2 è£½å“B   2351.       75 2023-12-02
3 è£½å“C    890.      200 2023-12-03

# A tibble: 3 Ã— 4
  event     date_jp    date_us    date_iso  
  &lt;chr&gt;     &lt;date&gt;     &lt;date&gt;     &lt;date&gt;    
1 ã‚¤ãƒ™ãƒ³ãƒˆ1 2023-12-01 2023-12-01 2023-12-01
2 ã‚¤ãƒ™ãƒ³ãƒˆ2 2023-12-15 2023-12-15 2023-12-15
3 ã‚¤ãƒ™ãƒ³ãƒˆ3 2024-01-05 2024-01-05 2024-01-05

# A tibble: 3 Ã— 4
  task    start_time end_time   duration  
  &lt;chr&gt;   &lt;time&gt;     &lt;time&gt;     &lt;time&gt;    
1 ã‚¿ã‚¹ã‚¯1 09:30      11:45:30   02:15:30  
2 ã‚¿ã‚¹ã‚¯2 14:00      16:30:45   02:30:45  
3 ã‚¿ã‚¹ã‚¯3 10:15:30   12:00      01:44:30</div>
            </div>
        </section>

        <section class="section">
            <h2>âš¡ å¤§å®¹é‡ãƒ‡ãƒ¼ã‚¿ã®é«˜é€Ÿå‡¦ç†</h2>

            <div class="code-container">
                <div class="code-header">ãƒãƒ£ãƒ³ã‚¯èª­ã¿è¾¼ã¿ã¨ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†</div>
                <div class="code-content">
<span class="comment"># å¤§å®¹é‡ãƒ‡ãƒ¼ã‚¿ã®ã‚µãƒ³ãƒ—ãƒ«ä½œæˆ</span>
<span class="function">set.seed</span>(<span class="number">123</span>)
large_data_sample <span class="operator">&lt;-</span> <span class="function">tibble</span>(
  id <span class="operator">=</span> <span class="number">1</span>:<span class="number">10000</span>,
  name <span class="operator">=</span> <span class="function">paste0</span>(<span class="string">"User_"</span>, <span class="function">sprintf</span>(<span class="string">"%05d"</span>, <span class="number">1</span>:<span class="number">10000</span>)),
  category <span class="operator">=</span> <span class="function">sample</span>(<span class="function">c</span>(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>), <span class="number">10000</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>),
  value <span class="operator">=</span> <span class="function">rnorm</span>(<span class="number">10000</span>, <span class="number">100</span>, <span class="number">20</span>),
  date <span class="operator">=</span> <span class="function">sample</span>(<span class="function">seq</span>(<span class="function">as.Date</span>(<span class="string">"2023-01-01"</span>), <span class="function">as.Date</span>(<span class="string">"2023-12-31"</span>), by <span class="operator">=</span> <span class="string">"day"</span>), <span class="number">10000</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>)
)

<span class="comment"># CSVãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ï¼ˆå®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼‰</span>
large_csv_content <span class="operator">&lt;-</span> <span class="function">format_csv</span>(large_data_sample)

<span class="comment"># æœ€åˆã®æ•°è¡Œã ã‘ç¢ºèª</span>
<span class="function">print</span>(<span class="string">"å¤§å®¹é‡ãƒ‡ãƒ¼ã‚¿ã®å…ˆé ­è¡Œ:"</span>)
<span class="function">cat</span>(<span class="function">substr</span>(large_csv_content, <span class="number">1</span>, <span class="number">300</span>), <span class="string">"..."</span>)

<span class="comment"># ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºã‚’æŒ‡å®šã—ãŸèª­ã¿è¾¼ã¿</span>
process_chunk <span class="operator">&lt;-</span> <span class="keyword">function</span>(chunk, pos) {
  <span class="comment"># å„ãƒãƒ£ãƒ³ã‚¯ã®çµ±è¨ˆã‚’è¨ˆç®—</span>
  chunk_stats <span class="operator">&lt;-</span> chunk <span class="operator">%&gt;%</span>
    <span class="function">group_by</span>(category) <span class="operator">%&gt;%</span>
    <span class="function">summarise</span>(
      count <span class="operator">=</span> <span class="function">n</span>(),
      avg_value <span class="operator">=</span> <span class="function">mean</span>(value),
      max_value <span class="operator">=</span> <span class="function">max</span>(value),
      .groups <span class="operator">=</span> <span class="string">'drop'</span>
    ) <span class="operator">%&gt;%</span>
    <span class="function">mutate</span>(chunk_pos <span class="operator">=</span> pos)
  
  <span class="keyword">return</span>(chunk_stats)
}

<span class="comment"># ãƒãƒ£ãƒ³ã‚¯å˜ä½ã§ã®å‡¦ç†ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰</span>
chunk_size <span class="operator">&lt;-</span> <span class="number">2000</span>
chunk_results <span class="operator">&lt;-</span> <span class="function">list</span>()

<span class="keyword">for</span> (i <span class="keyword">in</span> <span class="function">seq</span>(<span class="number">1</span>, <span class="function">nrow</span>(large_data_sample), by <span class="operator">=</span> chunk_size)) {
  end_idx <span class="operator">&lt;-</span> <span class="function">min</span>(i <span class="operator">+</span> chunk_size <span class="operator">-</span> <span class="number">1</span>, <span class="function">nrow</span>(large_data_sample))
  chunk <span class="operator">&lt;-</span> large_data_sample[i:end_idx, ]
  chunk_result <span class="operator">&lt;-</span> <span class="function">process_chunk</span>(chunk, i)
  chunk_results[[<span class="function">length</span>(chunk_results) <span class="operator">+</span> <span class="number">1</span>]] <span class="operator">&lt;-</span> chunk_result
}

<span class="comment"># ãƒãƒ£ãƒ³ã‚¯çµæœã®çµ±åˆ</span>
combined_results <span class="operator">&lt;-</span> <span class="function">bind_rows</span>(chunk_results) <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(category) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    total_count <span class="operator">=</span> <span class="function">sum</span>(count),
    avg_value <span class="operator">=</span> <span class="function">weighted.mean</span>(avg_value, count),
    max_value <span class="operator">=</span> <span class="function">max</span>(max_value),
    chunks_processed <span class="operator">=</span> <span class="function">n_distinct</span>(chunk_pos),
    .groups <span class="operator">=</span> <span class="string">'drop'</span>
  )

<span class="function">print</span>(<span class="string">"ãƒãƒ£ãƒ³ã‚¯å‡¦ç†çµæœ:"</span>)
<span class="function">print</span>(combined_results)

<span class="comment"># ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æ¯”è¼ƒ</span>
<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"å…¨ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º:"</span>, <span class="function">object.size</span>(large_data_sample), <span class="string">"bytes"</span>))
<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º:"</span>, <span class="function">object.size</span>(large_data_sample[<span class="number">1</span>:chunk_size, ]), <span class="string">"bytes"</span>))
</div>
            </div>

            <div class="output-container">
                <div class="output-header">å¤§å®¹é‡ãƒ‡ãƒ¼ã‚¿å‡¦ç†çµæœ</div>
                <div class="output-content">å¤§å®¹é‡ãƒ‡ãƒ¼ã‚¿ã®å…ˆé ­è¡Œ:
id,name,category,value,date
1,User_00001,A,87.3769775281997,2023-11-15
2,User_00002,D,99.1648379853979,2023-06-24
3,User_00003,E,115.872981428754,2023-03-12
4,User_00004,A,118.207475714851,2023-08-...

ãƒãƒ£ãƒ³ã‚¯å‡¦ç†çµæœ:
# A tibble: 5 Ã— 5
  category total_count avg_value max_value chunks_processed
  &lt;chr&gt;          &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;            &lt;int&gt;
1 A               1986      99.8      164.                5
2 B               2038     100.       169.                5
3 C               1974      99.9      171.                5
4 D               2011     100.       165.                5
5 E               1991     100.       170.                5

[1] "å…¨ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º: 560344 bytes"
[1] "ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º: 112344 bytes"</div>
            </div>

            <h3>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯</h3>

            <div class="code-container">
                <div class="code-header">èª­ã¿è¾¼ã¿æ€§èƒ½ã®æœ€é©åŒ–</div>
                <div class="code-content">
<span class="comment"># å‹æ¨å®šã®ã‚¹ã‚­ãƒƒãƒ—ï¼ˆäº‹å‰ã«å‹ãŒã‚ã‹ã£ã¦ã„ã‚‹å ´åˆï¼‰</span>
optimized_read <span class="operator">&lt;-</span> <span class="keyword">function</span>(content) {
  <span class="comment"># å‹ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹ã“ã¨ã§æ¨å®šå‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—</span>
  <span class="function">read_csv</span>(content,
    col_types <span class="operator">=</span> <span class="function">cols</span>(
      id <span class="operator">=</span> <span class="function">col_integer</span>(),
      name <span class="operator">=</span> <span class="function">col_character</span>(),
      category <span class="operator">=</span> <span class="function">col_character</span>(),
      value <span class="operator">=</span> <span class="function">col_double</span>(),
      date <span class="operator">=</span> <span class="function">col_date</span>()
    ),
    progress <span class="operator">=</span> <span class="variable">FALSE</span>  <span class="comment"># ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’ç„¡åŠ¹åŒ–</span>
  )
}

<span class="comment"># å¿…è¦ãªåˆ—ã®ã¿èª­ã¿è¾¼ã¿</span>
selective_read <span class="operator">&lt;-</span> <span class="keyword">function</span>(content, selected_cols) {
  all_cols <span class="operator">&lt;-</span> <span class="function">c</span>(<span class="string">"id"</span>, <span class="string">"name"</span>, <span class="string">"category"</span>, <span class="string">"value"</span>, <span class="string">"date"</span>)
  col_types_list <span class="operator">&lt;-</span> <span class="function">list</span>(
    id <span class="operator">=</span> <span class="function">col_integer</span>(),
    name <span class="operator">=</span> <span class="function">col_character</span>(),
    category <span class="operator">=</span> <span class="function">col_character</span>(),
    value <span class="operator">=</span> <span class="function">col_double</span>(),
    date <span class="operator">=</span> <span class="function">col_date</span>()
  )
  
  <span class="comment"># ä¸è¦ãªåˆ—ã‚’ã‚¹ã‚­ãƒƒãƒ—</span>
  skip_cols <span class="operator">&lt;-</span> all_cols[!all_cols <span class="operator">%in%</span> selected_cols]
  <span class="keyword">for</span> (col <span class="keyword">in</span> skip_cols) {
    col_types_list[[col]] <span class="operator">&lt;-</span> <span class="function">col_skip</span>()
  }
  
  <span class="function">read_csv</span>(content, col_types <span class="operator">=</span> <span class="function">do.call</span>(cols, col_types_list))
}

<span class="comment"># æ€§èƒ½ãƒ†ã‚¹ãƒˆã®ä¾‹</span>
<span class="function">print</span>(<span class="string">"æœ€é©åŒ–ã•ã‚ŒãŸèª­ã¿è¾¼ã¿ï¼ˆIDã€ã‚«ãƒ†ã‚´ãƒªã€å€¤ã®ã¿ï¼‰:"</span>)
optimized_data <span class="operator">&lt;-</span> <span class="function">selective_read</span>(large_csv_content, <span class="function">c</span>(<span class="string">"id"</span>, <span class="string">"category"</span>, <span class="string">"value"</span>))
<span class="function">print</span>(<span class="function">head</span>(optimized_data))

<span class="comment"># ãƒ‡ãƒ¼ã‚¿å¤‰æ›ã¨åŒæ™‚èª­ã¿è¾¼ã¿</span>
transform_on_read <span class="operator">&lt;-</span> <span class="keyword">function</span>(content) {
  <span class="function">read_csv</span>(content,
    col_types <span class="operator">=</span> <span class="function">cols</span>(
      id <span class="operator">=</span> <span class="function">col_integer</span>(),
      name <span class="operator">=</span> <span class="function">col_character</span>(),
      category <span class="operator">=</span> <span class="function">col_character</span>(),
      value <span class="operator">=</span> <span class="function">col_double</span>(),
      date <span class="operator">=</span> <span class="function">col_date</span>()
    )
  ) <span class="operator">%&gt;%</span>
    <span class="function">mutate</span>(
      value_category <span class="operator">=</span> <span class="function">case_when</span>(
        value <span class="operator">&lt;</span> <span class="number">80</span> ~ <span class="string">"ä½"</span>,
        value <span class="operator">&lt;</span> <span class="number">120</span> ~ <span class="string">"ä¸­"</span>,
        <span class="variable">TRUE</span> ~ <span class="string">"é«˜"</span>
      ),
      is_weekend <span class="operator">=</span> <span class="function">lubridate::wday</span>(date) <span class="operator">%in%</span> <span class="function">c</span>(<span class="number">1</span>, <span class="number">7</span>)
    )
}

<span class="comment"># å¤‰æ›ä»˜ãèª­ã¿è¾¼ã¿ã®ä¾‹</span>
<span class="function">print</span>(<span class="string">"å¤‰æ›ä»˜ãèª­ã¿è¾¼ã¿ã®çµæœ:"</span>)
transformed_data <span class="operator">&lt;-</span> <span class="function">transform_on_read</span>(<span class="function">head</span>(<span class="function">strsplit</span>(large_csv_content, <span class="string">"\n"</span>)[[<span class="number">1</span>]], <span class="number">10</span>) <span class="operator">%&gt;%</span> <span class="function">paste</span>(collapse <span class="operator">=</span> <span class="string">"\n"</span>))
<span class="function">print</span>(transformed_data)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">æœ€é©åŒ–èª­ã¿è¾¼ã¿çµæœ</div>
                <div class="output-content">æœ€é©åŒ–ã•ã‚ŒãŸèª­ã¿è¾¼ã¿ï¼ˆIDã€ã‚«ãƒ†ã‚´ãƒªã€å€¤ã®ã¿ï¼‰:
# A tibble: 6 Ã— 3
     id category value
  &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;
1     1 A         87.4
2     2 D         99.2
3     3 E        116. 
4     4 A        118. 
5     5 C         95.7
6     6 B        101. 

å¤‰æ›ä»˜ãèª­ã¿è¾¼ã¿ã®çµæœ:
# A tibble: 9 Ã— 7
     id name      category value date       value_category is_weekend
  &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;          &lt;lgl&gt;     
1     1 User_00001 A         87.4 2023-11-15 ä¸­             FALSE     
2     2 User_00002 D         99.2 2023-06-24 ä¸­             TRUE      
3     3 User_00003 E        116.  2023-03-12 ä¸­             TRUE      
4     4 User_00004 A        118.  2023-08-30 ä¸­             FALSE     
5     5 User_00005 C         95.7 2023-04-23 ä¸­             TRUE      
6     6 User_00006 B        101.  2023-02-06 ä¸­             FALSE     
7     7 User_00007 E         99.5 2023-07-12 ä¸­             FALSE     
8     8 User_00008 C        135.  2023-10-18 é«˜             FALSE     
9     9 User_00009 A         88.6 2023-05-31 ä¸­             FALSE</div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ“Š å®Ÿè·µçš„ãªãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h2>

            <div class="code-container">
                <div class="code-header">è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ‹¬èª­ã¿è¾¼ã¿</div>
                <div class="code-content">
<span class="comment"># è¤‡æ•°ã®æœˆæ¬¡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ</span>
create_monthly_sales <span class="operator">&lt;-</span> <span class="keyword">function</span>(month) {
  <span class="function">set.seed</span>(month)
  <span class="function">tibble</span>(
    month <span class="operator">=</span> month,
    product_id <span class="operator">=</span> <span class="function">paste0</span>(<span class="string">"P"</span>, <span class="function">sprintf</span>(<span class="string">"%03d"</span>, <span class="number">1</span>:<span class="number">50</span>)),
    sales <span class="operator">=</span> <span class="function">round</span>(<span class="function">rnorm</span>(<span class="number">50</span>, <span class="number">1000</span> <span class="operator">+</span> month <span class="operator">*</span> <span class="number">100</span>, <span class="number">200</span>)),
    region <span class="operator">=</span> <span class="function">sample</span>(<span class="function">c</span>(<span class="string">"åŒ—æµ·é“"</span>, <span class="string">"é–¢æ±"</span>, <span class="string">"é–¢è¥¿"</span>, <span class="string">"ä¹å·"</span>), <span class="number">50</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>),
    date <span class="operator">=</span> <span class="function">as.Date</span>(<span class="function">paste0</span>(<span class="string">"2023-"</span>, <span class="function">sprintf</span>(<span class="string">"%02d"</span>, month), <span class="string">"-15"</span>))
  )
}

<span class="comment"># 12ãƒ¶æœˆåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ</span>
monthly_files <span class="operator">&lt;-</span> <span class="function">map</span>(<span class="number">1</span>:<span class="number">12</span>, create_monthly_sales)
<span class="function">names</span>(monthly_files) <span class="operator">&lt;-</span> <span class="function">paste0</span>(<span class="string">"sales_2023_"</span>, <span class="function">sprintf</span>(<span class="string">"%02d"</span>, <span class="number">1</span>:<span class="number">12</span>), <span class="string">".csv"</span>)

<span class="comment"># å„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’CSVæ–‡å­—åˆ—ã«å¤‰æ›</span>
csv_contents <span class="operator">&lt;-</span> <span class="function">map</span>(monthly_files, format_csv)

<span class="comment"># å„ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿é–¢æ•°</span>
read_monthly_file <span class="operator">&lt;-</span> <span class="keyword">function</span>(csv_content, filename) {
  data <span class="operator">&lt;-</span> <span class="function">read_csv</span>(csv_content, 
    col_types <span class="operator">=</span> <span class="function">cols</span>(
      month <span class="operator">=</span> <span class="function">col_integer</span>(),
      product_id <span class="operator">=</span> <span class="function">col_character</span>(),
      sales <span class="operator">=</span> <span class="function">col_double</span>(),
      region <span class="operator">=</span> <span class="function">col_character</span>(),
      date <span class="operator">=</span> <span class="function">col_date</span>()
    ),
    progress <span class="operator">=</span> <span class="variable">FALSE</span>
  ) <span class="operator">%&gt;%</span>
    <span class="function">mutate</span>(source_file <span class="operator">=</span> filename)
  
  <span class="keyword">return</span>(data)
}

<span class="comment"># å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ‹¬èª­ã¿è¾¼ã¿</span>
all_sales_data <span class="operator">&lt;-</span> <span class="function">map2_dfr</span>(csv_contents, <span class="function">names</span>(csv_contents), read_monthly_file)

<span class="comment"># ãƒ‡ãƒ¼ã‚¿ã®çµ±åˆã¨æ¤œè¨¼</span>
data_summary <span class="operator">&lt;-</span> all_sales_data <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(month, region) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    total_sales <span class="operator">=</span> <span class="function">sum</span>(sales),
    avg_sales <span class="operator">=</span> <span class="function">mean</span>(sales),
    product_count <span class="operator">=</span> <span class="function">n_distinct</span>(product_id),
    .groups <span class="operator">=</span> <span class="string">'drop'</span>
  ) <span class="operator">%&gt;%</span>
  <span class="function">arrange</span>(month, region)

<span class="function">print</span>(<span class="string">"çµ±åˆãƒ‡ãƒ¼ã‚¿ã®è¦ç´„:"</span>)
<span class="function">print</span>(<span class="function">head</span>(data_summary, <span class="number">10</span>))

<span class="comment"># ãƒ‡ãƒ¼ã‚¿å“è³ªãƒã‚§ãƒƒã‚¯</span>
quality_check <span class="operator">&lt;-</span> all_sales_data <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    total_records <span class="operator">=</span> <span class="function">n</span>(),
    missing_sales <span class="operator">=</span> <span class="function">sum</span>(<span class="function">is.na</span>(sales)),
    duplicate_records <span class="operator">=</span> <span class="function">sum</span>(<span class="function">duplicated</span>(.)),
    unique_products <span class="operator">=</span> <span class="function">n_distinct</span>(product_id),
    date_range <span class="operator">=</span> <span class="function">paste</span>(<span class="function">min</span>(date), <span class="string">"to"</span>, <span class="function">max</span>(date)),
    files_processed <span class="operator">=</span> <span class="function">n_distinct</span>(source_file)
  )

<span class="function">print</span>(<span class="string">"ãƒ‡ãƒ¼ã‚¿å“è³ªãƒã‚§ãƒƒã‚¯:"</span>)
<span class="function">print</span>(quality_check)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿çµæœ</div>
                <div class="output-content">çµ±åˆãƒ‡ãƒ¼ã‚¿ã®è¦ç´„:
# A tibble: 10 Ã— 5
   month region total_sales avg_sales product_count
   &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;         &lt;int&gt;
 1     1 ä¹å·        13145      1095.            12
 2     1 åŒ—æµ·é“      14036      1170.            12
 3     1 é–¢æ±        13015      1085.            12
 4     1 é–¢è¥¿        13874      1156.            12
 5     2 ä¹å·        15034      1253.            12
 6     2 åŒ—æµ·é“      15789      1316.            12
 7     2 é–¢æ±        15456      1288.            12
 8     2 é–¢è¥¿        14721      1227.            12
 9     3 ä¹å·        16123      1344.            12
10     3 åŒ—æµ·é“      17234      1436.            12

ãƒ‡ãƒ¼ã‚¿å“è³ªãƒã‚§ãƒƒã‚¯:
# A tibble: 1 Ã— 6
  total_records missing_sales duplicate_records unique_products date_range    files_processed
          &lt;int&gt;         &lt;int&gt;             &lt;int&gt;           &lt;int&gt; &lt;chr&gt;                   &lt;int&gt;
1           600             0                 0              50 2023-01-15 to 2023-12-15          12</div>
            </div>

            <div class="data-table">
                <table>
                    <thead>
                        <tr>
                            <th>readré–¢æ•°</th>
                            <th>ç”¨é€”</th>
                            <th>ä¸»è¦ã‚ªãƒ—ã‚·ãƒ§ãƒ³</th>
                            <th>å‡ºåŠ›å½¢å¼</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>read_csv()</td>
                            <td>CSVï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</td>
                            <td>col_types, na, locale</td>
                            <td>tibble</td>
                        </tr>
                        <tr>
                            <td>read_tsv()</td>
                            <td>TSVï¼ˆã‚¿ãƒ–åŒºåˆ‡ã‚Šï¼‰</td>
                            <td>col_types, na</td>
                            <td>tibble</td>
                        </tr>
                        <tr>
                            <td>read_delim()</td>
                            <td>ä»»æ„ã®åŒºåˆ‡ã‚Šæ–‡å­—</td>
                            <td>delim, col_types</td>
                            <td>tibble</td>
                        </tr>
                        <tr>
                            <td>read_fwf()</td>
                            <td>å›ºå®šå¹…ãƒ•ã‚¡ã‚¤ãƒ«</td>
                            <td>fwf_widths, col_types</td>
                            <td>tibble</td>
                        </tr>
                        <tr>
                            <td>read_lines()</td>
                            <td>è¡Œå˜ä½èª­ã¿è¾¼ã¿</td>
                            <td>n_max, skip</td>
                            <td>character vector</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <div class="key-points">
            <h4>ç¬¬8ç« ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆ</h4>
            <ul>
                <li><strong>é«˜é€Ÿèª­ã¿è¾¼ã¿</strong>ï¼šreadrã¯base Rã‚ˆã‚Šé«˜é€Ÿã§å‹æ¨å®šãŒæ­£ç¢º</li>
                <li><strong>å‹æŒ‡å®š</strong>ï¼šcol_typeså¼•æ•°ã§æ­£ç¢ºãªãƒ‡ãƒ¼ã‚¿å‹ã‚’ä¿è¨¼</li>
                <li><strong>æ¬ æå€¤å‡¦ç†</strong>ï¼šnaå¼•æ•°ã§æ§˜ã€…ãªæ¬ æå€¤è¡¨ç¾ã«å¯¾å¿œ</li>
                <li><strong>ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°</strong>ï¼šlocaleè¨­å®šã§å›½éš›åŒ–ãƒ‡ãƒ¼ã‚¿ã«å¯¾å¿œ</li>
                <li><strong>å¤§å®¹é‡ãƒ‡ãƒ¼ã‚¿</strong>ï¼šãƒãƒ£ãƒ³ã‚¯èª­ã¿è¾¼ã¿ã§ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ã‚’æœ€é©åŒ–</li>
                <li><strong>ä¸€æ‹¬å‡¦ç†</strong>ï¼šè¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ±åˆèª­ã¿è¾¼ã¿ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</li>
            </ul>
        </div>

        <div class="tip-box">
            <h4>å®Ÿè·µçš„ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h4>
            <p>readrãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€ãƒ‡ãƒ¼ã‚¿åˆ†æã®æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã§é‡è¦ãªå½¹å‰²ã‚’æœãŸã—ã¾ã™ã€‚ç‰¹ã«ã€å¤§å®¹é‡ãƒ‡ãƒ¼ã‚¿ã‚„è¤‡é›‘ãªå½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†éš›ã¯ã€é©åˆ‡ãªå‹æŒ‡å®šã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå¾Œç¶šã®åˆ†æç²¾åº¦ã‚’å¤§ããå·¦å³ã—ã¾ã™ã€‚</p>
        </div>

        <nav class="chapter-nav">
            <a href="chapter7-lubridate-datetime.html" class="nav-button">â† ç¬¬7ç« </a>
            <a href="chapter9-tibble-modern-dataframe.html" class="nav-button">ç¬¬9ç«  â†’</a>
        </nav>
    </div>
</body>
</html>