<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á¨¨12Á´†: ÊôÇÁ≥ªÂàóÂàÜÊûê„Å®modeltime | TidyverseÂÆåÂÖ®„Éû„Çπ„Çø„Éº</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --accent-neon: #00ff88;
            --accent-cyan: #00d4ff;
            --accent-purple: #9d4edd;
            --accent-blue: #4dabf7;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --border-neon: #00ff88;
            --shadow-neon: 0 0 20px #00ff8840;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: linear-gradient(45deg, var(--bg-secondary), var(--bg-tertiary));
            border-radius: 20px;
            border: 2px solid var(--accent-blue);
            box-shadow: 0 0 20px rgba(77, 171, 247, 0.4);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(77, 171, 247, 0.1), transparent);
            animation: scan 3s infinite;
        }

        @keyframes scan {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        h1 {
            font-size: 3rem;
            font-weight: 700;
            color: var(--accent-blue);
            margin-bottom: 10px;
            text-shadow: 0 0 20px var(--accent-blue);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.4rem;
            color: var(--accent-cyan);
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .chapter-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            position: relative;
            z-index: 1;
        }

        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: 3px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .progress-dot {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            border: 1px solid var(--text-secondary);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
            box-shadow: 0 0 5px var(--accent-blue);
        }

        .progress-dot.completed {
            background: var(--accent-cyan);
            border-color: var(--accent-cyan);
        }

        /* Navigation Widget */
        .chapter-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 3px;
            margin: 30px 0;
            padding: 6px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--accent-blue);
            width: fit-content;
            max-width: 90vw;
            margin-left: auto;
            margin-right: auto;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 1px 5px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            text-decoration: none;
            border-radius: 2px;
            border: 1px solid var(--accent-cyan);
            transition: all 0.3s ease;
            font-size: 0.65rem;
            white-space: nowrap;
        }

        .nav-button:hover {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            box-shadow: 0 0 6px var(--accent-cyan);
        }

        .nav-button.current {
            background: var(--accent-blue);
            color: var(--bg-primary);
            box-shadow: 0 0 6px var(--accent-blue);
        }

        /* Content Sections */
        .section {
            background: var(--bg-secondary);
            margin: 30px 0;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid var(--accent-purple);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-cyan), var(--accent-purple));
            border-radius: 15px 15px 0 0;
        }

        h2 {
            color: var(--accent-blue);
            font-size: 2rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--accent-blue);
        }

        h3 {
            color: var(--accent-cyan);
            font-size: 1.5rem;
            margin: 25px 0 15px 0;
            text-shadow: 0 0 8px var(--accent-cyan);
        }

        h4 {
            color: var(--accent-purple);
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
        }

        /* Code Blocks */
        .code-container {
            margin: 20px 0;
            background: #1a1a1a;
            border-radius: 10px;
            border: 1px solid var(--accent-blue);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(77, 171, 247, 0.1);
        }

        .code-header {
            background: var(--accent-blue);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-header::before {
            content: 'üìà';
            font-size: 1.1rem;
        }

        .code-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            background: #0d1117;
            color: #c9d1d9;
            overflow-x: auto;
        }

        /* Syntax highlighting */
        .keyword { color: #ff7b72; }
        .function { color: #d2a8ff; }
        .string { color: #a5d6ff; }
        .comment { color: #8b949e; font-style: italic; }
        .operator { color: #f85149; }
        .number { color: #79c0ff; }
        .variable { color: #ffa657; }

        /* Output Display */
        .output-container {
            margin: 20px 0;
            background: #0a0e1a;
            border-radius: 10px;
            border: 1px solid var(--accent-cyan);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.1);
        }

        .output-header {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .output-header::before {
            content: 'üìä';
        }

        .output-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--accent-cyan);
        }

        /* Time Series Visualization */
        .ts-viz {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--accent-purple);
            text-align: center;
        }

        .viz-title {
            color: var(--accent-purple);
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: bold;
        }

        /* Forecast Components */
        .forecast-components {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .component-box {
            background: var(--bg-tertiary);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--accent-cyan);
            text-align: center;
        }

        .component-title {
            color: var(--accent-cyan);
            font-weight: bold;
            margin-bottom: 10px;
        }

        .component-value {
            color: var(--accent-blue);
            font-size: 1.2rem;
            font-weight: bold;
        }

        /* Data Tables */
        .data-table {
            margin: 20px 0;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-tertiary);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid var(--accent-blue);
        }

        th {
            background: var(--accent-blue);
            color: var(--bg-primary);
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--bg-secondary);
            color: var(--text-primary);
        }

        tr:nth-child(even) {
            background: rgba(77, 171, 247, 0.05);
        }

        tr:hover {
            background: rgba(77, 171, 247, 0.1);
        }

        /* Key Points */
        .key-points {
            background: linear-gradient(135deg, rgba(77, 171, 247, 0.1) 0%, rgba(0, 212, 255, 0.1) 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-blue);
        }

        .key-points h4 {
            color: var(--accent-blue);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .key-points h4::before {
            content: 'üí°';
        }

        .key-points ul {
            list-style: none;
            padding-left: 0;
        }

        .key-points li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .key-points li::before {
            content: '‚ñ∂';
            color: var(--accent-cyan);
            position: absolute;
            left: 0;
        }

        /* Warning/Tip boxes */
        .tip-box {
            background: rgba(157, 78, 221, 0.1);
            border: 1px solid var(--accent-purple);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-purple);
        }

        .tip-box h4 {
            color: var(--accent-purple);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tip-box h4::before {
            content: '‚ö†Ô∏è';
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }

            .chapter-meta {
                flex-direction: column;
                gap: 10px;
            }

            .chapter-nav {
                gap: 2px;
                padding: 4px;
            }

            .nav-button {
                padding: 1px 3px;
                font-size: 0.6rem;
            }

            .section {
                padding: 20px;
                margin: 20px 0;
            }

            h2 {
                font-size: 1.5rem;
            }

            .forecast-components {
                grid-template-columns: 1fr;
            }

            .code-content, .output-content {
                font-size: 0.85rem;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Á¨¨12Á´†: ÊôÇÁ≥ªÂàóÂàÜÊûê„Å®modeltime</h1>
            <p class="subtitle">Tidyverse„Å´„Çà„ÇãÊôÇÁ≥ªÂàó‰∫àÊ∏¨„Å®„Éà„É¨„É≥„ÉâÂàÜÊûê</p>
            <div class="chapter-meta">
                <span>üìà „Éà„É¨„É≥„ÉâÂàÜÊûê</span>
                <span>üîÆ ‰∫àÊ∏¨„É¢„Éá„É´</span>
                <span>üìä Â≠£ÁØÄÊÄßÂàÜËß£</span>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>
        </header>

        <nav class="chapter-nav">
            <a href="chapter1-tidyverse-overview.html" class="nav-button">1</a>
            <a href="chapter2-dplyr-data-manipulation.html" class="nav-button">2</a>
            <a href="chapter3-ggplot2-visualization.html" class="nav-button">3</a>
            <a href="chapter4-tidyr-data-reshaping.html" class="nav-button">4</a>
            <a href="chapter5-stringr-text-processing.html" class="nav-button">5</a>
            <a href="chapter6-forcats-purrr-advanced.html" class="nav-button">6</a>
            <a href="chapter7-lubridate-datetime.html" class="nav-button">7</a>
            <a href="chapter8-readr-data-import.html" class="nav-button">8</a>
            <a href="chapter9-tibble-modern-dataframe.html" class="nav-button">9</a>
            <a href="chapter10-statistics-modeling.html" class="nav-button">10</a>
            <a href="chapter11-machine-learning.html" class="nav-button">11</a>
            <a href="#" class="nav-button current">12</a>
        </nav>

        <section class="section">
            <h2>üìà ÊôÇÁ≥ªÂàó„Éá„Éº„Çø„ÅÆÂü∫Á§é„Å®tibbletime</h2>
            
            <p>ÊôÇÁ≥ªÂàóÂàÜÊûê„ÅØ„ÄÅÊôÇÈñì„ÅÆÁµåÈÅé„Å®„Å®„ÇÇ„Å´Â§âÂåñ„Åô„Çã„Éá„Éº„Çø„ÅÆ„Éë„Çø„Éº„É≥„ÇíÁêÜËß£„Åó„ÄÅÂ∞ÜÊù•„ÅÆÂÄ§„Çí‰∫àÊ∏¨„Åô„ÇãÊâãÊ≥ï„Åß„Åô„ÄÇTidyverse„Ç®„Ç≥„Ç∑„Çπ„ÉÜ„É†„Åß„ÅØ„ÄÅlubridate„Å®tibletime„ÇíÁµÑ„ÅøÂêà„Çè„Åõ„Å¶ÂäπÁéáÁöÑ„Å™ÊôÇÁ≥ªÂàóÂá¶ÁêÜ„ÇíÂÆüÁèæ„Åß„Åç„Åæ„Åô„ÄÇ</p>

            <h3>ÊôÇÁ≥ªÂàó„Éá„Éº„Çø„ÅÆÊ∫ñÂÇô„Å®Êé¢Á¥¢</h3>

            <div class="code-container">
                <div class="code-header">Â£≤‰∏ä„Éá„Éº„Çø„ÅÆÊôÇÁ≥ªÂàóÂàÜÊûê</div>
                <div class="code-content">
<span class="keyword">library</span>(<span class="string">tidyverse</span>)
<span class="keyword">library</span>(<span class="string">lubridate</span>)
<span class="keyword">library</span>(<span class="string">timetk</span>)
<span class="keyword">library</span>(<span class="string">modeltime</span>)

<span class="comment"># Ë§áÈõë„Å™Â£≤‰∏äÊôÇÁ≥ªÂàó„Éá„Éº„Çø„ÅÆ‰ΩúÊàê</span>
<span class="function">set.seed</span>(<span class="number">123</span>)
<span class="comment"># 2019Âπ¥1Êúà„Åã„Çâ2023Âπ¥12Êúà„Åæ„Åß„ÅÆÊó•Ê¨°„Éá„Éº„Çø</span>
start_date <span class="operator">&lt;-</span> <span class="function">as.Date</span>(<span class="string">"2019-01-01"</span>)
end_date <span class="operator">&lt;-</span> <span class="function">as.Date</span>(<span class="string">"2023-12-31"</span>)
dates <span class="operator">&lt;-</span> <span class="function">seq</span>(start_date, end_date, by <span class="operator">=</span> <span class="string">"day"</span>)

sales_ts <span class="operator">&lt;-</span> <span class="function">tibble</span>(
  date <span class="operator">=</span> dates
) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    <span class="comment"># Âü∫Êú¨„Éà„É¨„É≥„ÉâÔºàÂπ¥ÈñìÊàêÈï∑Áéá5%Ôºâ</span>
    trend <span class="operator">=</span> <span class="number">1000</span> <span class="operator">+</span> <span class="function">as.numeric</span>(date <span class="operator">-</span> start_date) <span class="operator">*</span> <span class="number">0.1</span>,
    
    <span class="comment"># Âπ¥Ê¨°Â≠£ÁØÄÊÄßÔºàÂπ¥Êú´Âπ¥Âßã„ÄÅÂ§è„ÅÆ„Éú„Éº„Éä„ÇπÊôÇÊúüÔºâ</span>
    yearly_seasonal <span class="operator">=</span> <span class="number">200</span> <span class="operator">*</span> <span class="function">sin</span>(<span class="number">2</span> <span class="operator">*</span> pi <span class="operator">*</span> <span class="function">yday</span>(date) / <span class="number">365</span>) <span class="operator">+</span>
                        <span class="number">150</span> <span class="operator">*</span> <span class="function">cos</span>(<span class="number">4</span> <span class="operator">*</span> pi <span class="operator">*</span> <span class="function">yday</span>(date) / <span class="number">365</span>),
    
    <span class="comment"># ÈÄ±Ê¨°Â≠£ÁØÄÊÄßÔºàÂπ≥Êó•È´ò„ÄÅÈÄ±Êú´‰ΩéÔºâ</span>
    weekly_seasonal <span class="operator">=</span> <span class="function">case_when</span>(
      <span class="function">wday</span>(date) <span class="operator">%in%</span> <span class="function">c</span>(<span class="number">1</span>, <span class="number">7</span>) ~ <span class="number">-100</span>,  <span class="comment"># ÈÄ±Êú´</span>
      <span class="function">wday</span>(date) <span class="operator">==</span> <span class="number">6</span> ~ <span class="number">-50</span>,               <span class="comment"># ÈáëÊõúÊó•</span>
      <span class="variable">TRUE</span> ~ <span class="number">50</span>                           <span class="comment"># Âπ≥Êó•</span>
    ),
    
    <span class="comment"># ÁâπÂà•„Å™Êó•ÔºàÁ•ùÊó•ÂäπÊûú„Å™„Å©Ôºâ</span>
    special_events <span class="operator">=</span> <span class="function">case_when</span>(
      <span class="function">month</span>(date) <span class="operator">==</span> <span class="number">12</span> <span class="operator">&amp;&amp;</span> <span class="function">day</span>(date) <span class="operator">%in%</span> <span class="function">c</span>(<span class="number">24</span>, <span class="number">25</span>) ~ <span class="number">300</span>,  <span class="comment"># „ÇØ„É™„Çπ„Éû„Çπ</span>
      <span class="function">month</span>(date) <span class="operator">==</span> <span class="number">1</span> <span class="operator">&amp;&amp;</span> <span class="function">day</span>(date) <span class="operator">==</span> <span class="number">1</span> ~ <span class="number">-200</span>,         <span class="comment"># ÂÖÉÊó•</span>
      <span class="function">month</span>(date) <span class="operator">==</span> <span class="number">7</span> <span class="operator">&amp;&amp;</span> <span class="function">day</span>(date) <span class="operator">%in%</span> <span class="function">c</span>(<span class="number">15</span>:<span class="number">25</span>) ~ <span class="number">100</span>,  <span class="comment"># Â§è„ÅÆ„Çª„Éº„É´</span>
      <span class="variable">TRUE</span> ~ <span class="number">0</span>
    ),
    
    <span class="comment"># „É©„É≥„ÉÄ„É†„Éé„Ç§„Ç∫</span>
    noise <span class="operator">=</span> <span class="function">rnorm</span>(<span class="function">n</span>(), <span class="number">0</span>, <span class="number">80</span>),
    
    <span class="comment"># ÊúÄÁµÇÁöÑ„Å™Â£≤‰∏ä</span>
    sales <span class="operator">=</span> trend <span class="operator">+</span> yearly_seasonal <span class="operator">+</span> weekly_seasonal <span class="operator">+</span> special_events <span class="operator">+</span> noise
  ) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(sales <span class="operator">=</span> <span class="function">pmax</span>(sales, <span class="number">100</span>)) <span class="operator">%&gt;%</span>  <span class="comment"># ÊúÄÂ∞èÂÄ§Ë®≠ÂÆö</span>
  <span class="function">select</span>(date, sales)

<span class="function">print</span>(<span class="function">head</span>(sales_ts, <span class="number">10</span>))

<span class="comment"># Âü∫Êú¨ÁöÑ„Å™ÊôÇÁ≥ªÂàóÁµ±Ë®à</span>
ts_summary <span class="operator">&lt;-</span> sales_ts <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    start_date <span class="operator">=</span> <span class="function">min</span>(date),
    end_date <span class="operator">=</span> <span class="function">max</span>(date),
    total_days <span class="operator">=</span> <span class="function">n</span>(),
    mean_sales <span class="operator">=</span> <span class="function">mean</span>(sales),
    median_sales <span class="operator">=</span> <span class="function">median</span>(sales),
    sd_sales <span class="operator">=</span> <span class="function">sd</span>(sales),
    min_sales <span class="operator">=</span> <span class="function">min</span>(sales),
    max_sales <span class="operator">=</span> <span class="function">max</span>(sales)
  )

<span class="function">print</span>(<span class="string">"ÊôÇÁ≥ªÂàó„Éá„Éº„ÇøÊ¶ÇË¶Å:"</span>)
<span class="function">print</span>(ts_summary)

<span class="comment"># ÊúàÊ¨°ÈõÜË®à</span>
monthly_sales <span class="operator">&lt;-</span> sales_ts <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    year <span class="operator">=</span> <span class="function">year</span>(date),
    month <span class="operator">=</span> <span class="function">month</span>(date),
    yearmon <span class="operator">=</span> <span class="function">floor_date</span>(date, <span class="string">"month"</span>)
  ) <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(yearmon) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    monthly_total <span class="operator">=</span> <span class="function">sum</span>(sales),
    monthly_avg <span class="operator">=</span> <span class="function">mean</span>(sales),
    days_count <span class="operator">=</span> <span class="function">n</span>(),
    .groups <span class="operator">=</span> <span class="string">'drop'</span>
  )

<span class="function">print</span>(<span class="string">"ÊúàÊ¨°Â£≤‰∏äÔºàÊúÄÂàù„ÅÆ12„É∂ÊúàÔºâ:"</span>)
<span class="function">print</span>(<span class="function">head</span>(monthly_sales, <span class="number">12</span>))

<span class="comment"># Âπ¥Ê¨°ÊàêÈï∑Áéá„ÅÆË®àÁÆó</span>
yearly_growth <span class="operator">&lt;-</span> sales_ts <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(year <span class="operator">=</span> <span class="function">year</span>(date)) <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(year) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(yearly_total <span class="operator">=</span> <span class="function">sum</span>(sales), .groups <span class="operator">=</span> <span class="string">'drop'</span>) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    growth_rate <span class="operator">=</span> (<span class="function">lag</span>(yearly_total, <span class="number">1</span>) <span class="operator">-</span> yearly_total) / <span class="function">lag</span>(yearly_total, <span class="number">1</span>) <span class="operator">*</span> <span class="number">100</span>
  ) <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(!<span class="function">is.na</span>(growth_rate))

<span class="function">print</span>(<span class="string">"Âπ¥Ê¨°ÊàêÈï∑Áéá:"</span>)
<span class="function">print</span>(yearly_growth)

<span class="comment"># ÈÄ±Ê¨°„ÉªÊúàÊ¨°„Éë„Çø„Éº„É≥„ÅÆÂàÜÊûê</span>
pattern_analysis <span class="operator">&lt;-</span> sales_ts <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    weekday <span class="operator">=</span> <span class="function">wday</span>(date, label <span class="operator">=</span> <span class="variable">TRUE</span>, abbr <span class="operator">=</span> <span class="variable">FALSE</span>),
    month_name <span class="operator">=</span> <span class="function">month</span>(date, label <span class="operator">=</span> <span class="variable">TRUE</span>, abbr <span class="operator">=</span> <span class="variable">FALSE</span>)
  )

weekday_pattern <span class="operator">&lt;-</span> pattern_analysis <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(weekday) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    avg_sales <span class="operator">=</span> <span class="function">mean</span>(sales),
    median_sales <span class="operator">=</span> <span class="function">median</span>(sales),
    .groups <span class="operator">=</span> <span class="string">'drop'</span>
  ) <span class="operator">%&gt;%</span>
  <span class="function">arrange</span>(<span class="function">desc</span>(avg_sales))

<span class="function">print</span>(<span class="string">"ÊõúÊó•Âà•Â£≤‰∏ä„Éë„Çø„Éº„É≥:"</span>)
<span class="function">print</span>(weekday_pattern)

monthly_pattern <span class="operator">&lt;-</span> pattern_analysis <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(month_name) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    avg_sales <span class="operator">=</span> <span class="function">mean</span>(sales),
    median_sales <span class="operator">=</span> <span class="function">median</span>(sales),
    .groups <span class="operator">=</span> <span class="string">'drop'</span>
  )

<span class="function">print</span>(<span class="string">"ÊúàÂà•Â£≤‰∏ä„Éë„Çø„Éº„É≥:"</span>)
<span class="function">print</span>(monthly_pattern)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">ÊôÇÁ≥ªÂàó„Éá„Éº„ÇøÊé¢Á¥¢ÁµêÊûú</div>
                <div class="output-content"># A tibble: 10 √ó 2
   date       sales
   &lt;date&gt;     &lt;dbl&gt;
 1 2019-01-01  990.
 2 2019-01-02 1088.
 3 2019-01-03 1142.
 4 2019-01-04 1165.
 5 2019-01-05  941.
 6 2019-01-06  898.
 7 2019-01-07  961.
 8 2019-01-08 1134.
 9 2019-01-09 1089.
10 2019-01-10 1203.

ÊôÇÁ≥ªÂàó„Éá„Éº„ÇøÊ¶ÇË¶Å:
# A tibble: 1 √ó 8
  start_date end_date   total_days mean_sales median_sales sd_sales min_sales max_sales
  &lt;date&gt;     &lt;date&gt;          &lt;int&gt;      &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 2019-01-01 2023-12-31       1826      1275.        1274.     173.      731.     1826.

ÊúàÊ¨°Â£≤‰∏äÔºàÊúÄÂàù„ÅÆ12„É∂ÊúàÔºâ:
# A tibble: 12 √ó 4
   yearmon    monthly_total monthly_avg days_count
   &lt;date&gt;             &lt;dbl&gt;       &lt;dbl&gt;      &lt;int&gt;
 1 2019-01-01        37589.       1213.         31
 2 2019-02-01        32695.       1167.         28
 3 2019-03-01        38476.       1241.         31
 4 2019-04-01        39264.       1309.         30
 5 2019-05-01        40871.       1318.         31
 6 2019-06-01        41205.       1374.         30

Âπ¥Ê¨°ÊàêÈï∑Áéá:
# A tibble: 4 √ó 3
   year yearly_total growth_rate
  &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
1  2020      463926.      -0.349
2  2021      479542.      -3.25 
3  2022      495158.      -3.15 
4  2023      510774.      -3.06 

ÊõúÊó•Âà•Â£≤‰∏ä„Éë„Çø„Éº„É≥:
# A tibble: 7 √ó 3
  weekday avg_sales median_sales
  &lt;ord&gt;       &lt;dbl&gt;        &lt;dbl&gt;
1 Tuesday     1324.        1322.
2 Wednesday   1323.        1321.
3 Monday      1324.        1323.
4 Thursday    1323.        1322.
5 Friday      1271.        1270.
6 Saturday    1176.        1175.
7 Sunday      1176.        1175.</div>
            </div>

            <div class="ts-viz">
                <div class="viz-title">Â£≤‰∏ä„Éà„É¨„É≥„Éâ„Å®Â≠£ÁØÄÊÄß„Éë„Çø„Éº„É≥</div>
                <svg width="600" height="400" viewBox="0 0 600 400">
                    <!-- Background -->
                    <rect width="600" height="400" fill="#1a1a1a" stroke="#4dabf7" stroke-width="1"/>
                    
                    <!-- Title -->
                    <text x="300" y="25" text-anchor="middle" fill="#4dabf7" font-size="16" font-weight="bold">2019-2023Âπ¥Â£≤‰∏äÊé®Áßª</text>
                    
                    <!-- Grid lines -->
                    <g stroke="#333" stroke-width="0.5">
                        <line x1="60" y1="50" x2="60" y2="320"/>
                        <line x1="60" y1="320" x2="540" y2="320"/>
                        <!-- Horizontal grid -->
                        <line x1="60" y1="320" x2="540" y2="320"/>
                        <line x1="60" y1="270" x2="540" y2="270"/>
                        <line x1="60" y1="220" x2="540" y2="220"/>
                        <line x1="60" y1="170" x2="540" y2="170"/>
                        <line x1="60" y1="120" x2="540" y2="120"/>
                        <line x1="60" y1="70" x2="540" y2="70"/>
                    </g>
                    
                    <!-- Main trend line -->
                    <polyline points="60,280 120,270 180,260 240,250 300,240 360,230 420,220 480,210 540,200" 
                              fill="none" stroke="#4dabf7" stroke-width="3"/>
                    
                    <!-- Seasonal fluctuations -->
                    <path d="M 60 280 Q 90 290 120 270 Q 150 250 180 260 Q 210 270 240 250 Q 270 230 300 240 Q 330 250 360 230 Q 390 210 420 220 Q 450 230 480 210 Q 510 190 540 200" 
                          fill="none" stroke="#00d4ff" stroke-width="2" opacity="0.7"/>
                    
                    <!-- Special events markers -->
                    <circle cx="180" cy="240" r="4" fill="#ff6b9d"/>
                    <circle cx="300" cy="220" r="4" fill="#ff6b9d"/>
                    <circle cx="420" cy="200" r="4" fill="#ff6b9d"/>
                    
                    <!-- Year labels -->
                    <text x="90" y="340" text-anchor="middle" fill="#b3b3b3" font-size="10">2019</text>
                    <text x="180" y="340" text-anchor="middle" fill="#b3b3b3" font-size="10">2020</text>
                    <text x="270" y="340" text-anchor="middle" fill="#b3b3b3" font-size="10">2021</text>
                    <text x="360" y="340" text-anchor="middle" fill="#b3b3b3" font-size="10">2022</text>
                    <text x="450" y="340" text-anchor="middle" fill="#b3b3b3" font-size="10">2023</text>
                    
                    <!-- Y-axis labels -->
                    <text x="50" y="325" text-anchor="end" fill="#b3b3b3" font-size="10">1000</text>
                    <text x="50" y="275" text-anchor="end" fill="#b3b3b3" font-size="10">1200</text>
                    <text x="50" y="225" text-anchor="end" fill="#b3b3b3" font-size="10">1400</text>
                    <text x="50" y="175" text-anchor="end" fill="#b3b3b3" font-size="10">1600</text>
                    <text x="50" y="125" text-anchor="end" fill="#b3b3b3" font-size="10">1800</text>
                    <text x="50" y="75" text-anchor="end" fill="#b3b3b3" font-size="10">2000</text>
                    
                    <!-- Legend -->
                    <line x1="80" y1="370" x2="110" y2="370" stroke="#4dabf7" stroke-width="3"/>
                    <text x="115" y="375" fill="#b3b3b3" font-size="10">„É°„Ç§„É≥„Éà„É¨„É≥„Éâ</text>
                    <line x1="200" y1="370" x2="230" y2="370" stroke="#00d4ff" stroke-width="2"/>
                    <text x="235" y="375" fill="#b3b3b3" font-size="10">Â≠£ÁØÄÂ§âÂãï</text>
                    <circle cx="340" cy="370" r="3" fill="#ff6b9d"/>
                    <text x="350" y="375" fill="#b3b3b3" font-size="10">ÁâπÂà•„Ç§„Éô„É≥„Éà</text>
                </svg>
            </div>
        </section>

        <section class="section">
            <h2>üîÆ modeltime„Å´„Çà„Çã‰∫àÊ∏¨„É¢„Éá„É´</h2>

            <div class="code-container">
                <div class="code-header">Ë§áÊï∞„ÅÆÊôÇÁ≥ªÂàó‰∫àÊ∏¨„É¢„Éá„É´</div>
                <div class="code-content">
<span class="comment"># „Éá„Éº„Çø„ÅÆÂàÜÂâ≤ÔºàË®ìÁ∑¥Áî®„Å®„ÉÜ„Çπ„ÉàÁî®Ôºâ</span>
splits <span class="operator">&lt;-</span> sales_ts <span class="operator">%&gt;%</span>
  <span class="function">time_series_split</span>(assess <span class="operator">=</span> <span class="string">"3 months"</span>, cumulative <span class="operator">=</span> <span class="variable">TRUE</span>)

train_data <span class="operator">&lt;-</span> <span class="function">training</span>(splits)
test_data <span class="operator">&lt;-</span> <span class="function">testing</span>(splits)

<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"Ë®ìÁ∑¥ÊúüÈñì:"</span>, <span class="function">min</span>(train_data$date), <span class="string">"to"</span>, <span class="function">max</span>(train_data$date)))
<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"„ÉÜ„Çπ„ÉàÊúüÈñì:"</span>, <span class="function">min</span>(test_data$date), <span class="string">"to"</span>, <span class="function">max</span>(test_data$date)))

<span class="comment"># „É¢„Éá„É´1: ARIMA</span>
model_arima <span class="operator">&lt;-</span> <span class="function">arima_reg</span>() <span class="operator">%&gt;%</span>
  <span class="function">set_engine</span>(<span class="string">"auto_arima"</span>) <span class="operator">%&gt;%</span>
  <span class="function">fit</span>(sales ~ date, data <span class="operator">=</span> train_data)

<span class="comment"># „É¢„Éá„É´2: ÊåáÊï∞Âπ≥ÊªëÊ≥ïÔºàETSÔºâ</span>
model_ets <span class="operator">&lt;-</span> <span class="function">exp_smoothing</span>() <span class="operator">%&gt;%</span>
  <span class="function">set_engine</span>(<span class="string">"ets"</span>) <span class="operator">%&gt;%</span>
  <span class="function">fit</span>(sales ~ date, data <span class="operator">=</span> train_data)

<span class="comment"># „É¢„Éá„É´3: Á∑öÂΩ¢ÂõûÂ∏∞Ôºà„Éà„É¨„É≥„Éâ + Â≠£ÁØÄÊÄßÔºâ</span>
model_lm <span class="operator">&lt;-</span> <span class="function">linear_reg</span>() <span class="operator">%&gt;%</span>
  <span class="function">set_engine</span>(<span class="string">"lm"</span>) <span class="operator">%&gt;%</span>
  <span class="function">fit</span>(sales ~ <span class="function">as.numeric</span>(date) <span class="operator">+</span> <span class="function">wday</span>(date, label <span class="operator">=</span> <span class="variable">TRUE</span>) <span class="operator">+</span> <span class="function">month</span>(date, label <span class="operator">=</span> <span class="variable">TRUE</span>), 
      data <span class="operator">=</span> train_data)

<span class="comment"># „É¢„Éá„É´4: Prophet</span>
model_prophet <span class="operator">&lt;-</span> <span class="function">prophet_reg</span>() <span class="operator">%&gt;%</span>
  <span class="function">set_engine</span>(<span class="string">"prophet"</span>) <span class="operator">%&gt;%</span>
  <span class="function">fit</span>(sales ~ date, data <span class="operator">=</span> train_data)

<span class="comment"># „É¢„Éá„É´5: Â≠£ÁØÄÊÄß„Éä„Ç§„Éº„Éñ</span>
model_snaive <span class="operator">&lt;-</span> <span class="function">naive_reg</span>() <span class="operator">%&gt;%</span>
  <span class="function">set_engine</span>(<span class="string">"snaive"</span>) <span class="operator">%&gt;%</span>
  <span class="function">fit</span>(sales ~ date, data <span class="operator">=</span> train_data)

<span class="comment"># modeltime„ÉÜ„Éº„Éñ„É´„ÅÆ‰ΩúÊàê</span>
models_tbl <span class="operator">&lt;-</span> <span class="function">modeltime_table</span>(
  model_arima,
  model_ets,
  model_lm,
  model_prophet,
  model_snaive
)

<span class="function">print</span>(<span class="string">"„É¢„Éá„É´‰∏ÄË¶ß:"</span>)
<span class="function">print</span>(models_tbl)

<span class="comment"># ‰∫àÊ∏¨„ÅÆÂÆüË°å</span>
forecast_tbl <span class="operator">&lt;-</span> models_tbl <span class="operator">%&gt;%</span>
  <span class="function">modeltime_forecast</span>(
    new_data <span class="operator">=</span> test_data,
    actual_data <span class="operator">=</span> train_data,
    keep_data <span class="operator">=</span> <span class="variable">TRUE</span>
  )

<span class="function">print</span>(<span class="string">"‰∫àÊ∏¨ÁµêÊûúÔºà„Çµ„É≥„Éó„É´Ôºâ:"</span>)
<span class="function">print</span>(<span class="function">head</span>(forecast_tbl, <span class="number">10</span>))

<span class="comment"># Á≤æÂ∫¶Ë©ï‰æ°</span>
accuracy_tbl <span class="operator">&lt;-</span> models_tbl <span class="operator">%&gt;%</span>
  <span class="function">modeltime_accuracy</span>(test_data)

<span class="function">print</span>(<span class="string">"„É¢„Éá„É´Á≤æÂ∫¶ÊØîËºÉ:"</span>)
<span class="function">print</span>(accuracy_tbl)

<span class="comment"># ÊúÄËâØ„É¢„Éá„É´„ÅÆÈÅ∏Êäû„Å®Â∞ÜÊù•‰∫àÊ∏¨</span>
best_model_id <span class="operator">&lt;-</span> accuracy_tbl <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(mae <span class="operator">==</span> <span class="function">min</span>(mae)) <span class="operator">%&gt;%</span>
  <span class="function">pull</span>(.model_id)

<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"ÊúÄËâØ„É¢„Éá„É´ ID:"</span>, best_model_id))

<span class="comment"># Â∞ÜÊù•‰∫àÊ∏¨Ôºà3„É∂ÊúàÂÖà„Åæ„ÅßÔºâ</span>
future_forecast <span class="operator">&lt;-</span> models_tbl <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(.model_id <span class="operator">==</span> best_model_id) <span class="operator">%&gt;%</span>
  <span class="function">modeltime_refit</span>(sales_ts) <span class="operator">%&gt;%</span>
  <span class="function">modeltime_forecast</span>(h <span class="operator">=</span> <span class="string">"3 months"</span>, actual_data <span class="operator">=</span> sales_ts)

<span class="function">print</span>(<span class="string">"Â∞ÜÊù•‰∫àÊ∏¨ÁµêÊûú:"</span>)
future_summary <span class="operator">&lt;-</span> future_forecast <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(.key <span class="operator">==</span> <span class="string">"prediction"</span>) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    start_date <span class="operator">=</span> <span class="function">min</span>(.index),
    end_date <span class="operator">=</span> <span class="function">max</span>(.index),
    avg_forecast <span class="operator">=</span> <span class="function">mean</span>(.value),
    total_forecast <span class="operator">=</span> <span class="function">sum</span>(.value)
  )
<span class="function">print</span>(future_summary)

<span class="comment"># Â≠£ÁØÄÊÄßÂàÜËß£„ÅÆÂÆüË°å</span>
decomposition <span class="operator">&lt;-</span> sales_ts <span class="operator">%&gt;%</span>
  <span class="function">plot_seasonal_diagnostics</span>(.date_var <span class="operator">=</span> date, .value <span class="operator">=</span> sales, .feature_set <span class="operator">=</span> <span class="function">c</span>(<span class="string">"week"</span>, <span class="string">"month.lbl"</span>))

<span class="comment"># Â≠£ÁØÄÊÄßÁµ±Ë®à„ÅÆË®àÁÆó</span>
seasonal_stats <span class="operator">&lt;-</span> sales_ts <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    month <span class="operator">=</span> <span class="function">month</span>(date, label <span class="operator">=</span> <span class="variable">TRUE</span>),
    wday <span class="operator">=</span> <span class="function">wday</span>(date, label <span class="operator">=</span> <span class="variable">TRUE</span>)
  ) <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(month) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    seasonal_index <span class="operator">=</span> <span class="function">mean</span>(sales) / <span class="function">mean</span>(sales_ts$sales),
    avg_sales <span class="operator">=</span> <span class="function">mean</span>(sales),
    .groups <span class="operator">=</span> <span class="string">'drop'</span>
  ) <span class="operator">%&gt;%</span>
  <span class="function">arrange</span>(<span class="function">desc</span>(seasonal_index))

<span class="function">print</span>(<span class="string">"ÊúàÂà•Â≠£ÁØÄÊåáÊï∞:"</span>)
<span class="function">print</span>(seasonal_stats)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">ÊôÇÁ≥ªÂàó‰∫àÊ∏¨ÁµêÊûú</div>
                <div class="output-content">[1] "Ë®ìÁ∑¥ÊúüÈñì: 2019-01-01 to 2023-09-30"
[1] "„ÉÜ„Çπ„ÉàÊúüÈñì: 2023-10-01 to 2023-12-31"

„É¢„Éá„É´‰∏ÄË¶ß:
# Modeltime Table
# A tibble: 5 √ó 3
  .model_id .model     .model_desc             
      &lt;int&gt; &lt;list&gt;     &lt;chr&gt;                   
1         1 &lt;fit[+]&gt;   ARIMA(2,1,2)(0,1,1)[7] 
2         2 &lt;fit[+]&gt;   ETS(A,A,A)             
3         3 &lt;fit[+]&gt;   LM                      
4         4 &lt;fit[+]&gt;   PROPHET                 
5         5 &lt;fit[+]&gt;   SNAIVE(7)              

„É¢„Éá„É´Á≤æÂ∫¶ÊØîËºÉ:
# A tibble: 5 √ó 9
  .model_id .model_desc              .type    mae  mape  mase smape  rmse   rsq
      &lt;int&gt; &lt;chr&gt;                    &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1         1 ARIMA(2,1,2)(0,1,1)[7]   Test    67.8  5.29  0.85  5.32  85.2  0.89
2         2 ETS(A,A,A)               Test    73.2  5.73  0.91  5.76  92.1  0.87
3         3 LM                       Test    89.5  6.98  1.12  7.02 115.   0.79
4         4 PROPHET                  Test    78.4  6.12  0.98  6.15  98.7  0.85
5         5 SNAIVE(7)                Test   102.   7.95  1.27  7.99 128.   0.73

[1] "ÊúÄËâØ„É¢„Éá„É´ ID: 1"

Â∞ÜÊù•‰∫àÊ∏¨ÁµêÊûú:
# A tibble: 1 √ó 4
  start_date end_date   avg_forecast total_forecast
  &lt;date&gt;     &lt;date&gt;            &lt;dbl&gt;          &lt;dbl&gt;
1 2024-01-01 2024-03-31        1456.        131081.

ÊúàÂà•Â≠£ÁØÄÊåáÊï∞:
# A tibble: 12 √ó 3
   month seasonal_index avg_sales
   &lt;ord&gt;          &lt;dbl&gt;     &lt;dbl&gt;
 1 Nov             1.07     1365.
 2 Dec             1.06     1354.
 3 Jul             1.05     1339.
 4 Aug             1.04     1326.
 5 Oct             1.03     1314.
 6 Sep             1.01     1289.
 7 Jun             1.01     1287.
 8 May             1.00     1276.
 9 Apr             0.993    1266.
10 Mar             0.987    1259.
11 Feb             0.962    1227.
12 Jan             0.959    1223.</div>
            </div>

            <div class="forecast-components">
                <div class="component-box">
                    <div class="component-title">ÊúÄÂÑ™ÁßÄ„É¢„Éá„É´</div>
                    <div class="component-value">ARIMA</div>
                </div>
                <div class="component-box">
                    <div class="component-title">‰∫àÊ∏¨Á≤æÂ∫¶ (MAE)</div>
                    <div class="component-value">67.8</div>
                </div>
                <div class="component-box">
                    <div class="component-title">R¬≤„Çπ„Ç≥„Ç¢</div>
                    <div class="component-value">0.89</div>
                </div>
                <div class="component-box">
                    <div class="component-title">3„É∂Êúà‰∫àÊ∏¨Âπ≥Âùá</div>
                    <div class="component-value">1,456</div>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>üìä È´òÂ∫¶„Å™ÊôÇÁ≥ªÂàóÂàÜÊûê„ÉÜ„ÇØ„Éã„ÉÉ„ÇØ</h2>

            <div class="code-container">
                <div class="code-header">Áï∞Â∏∏ÂÄ§Ê§úÂá∫„Å®Â§ñÈÉ®Â§âÊï∞„ÅÆÁµÑ„ÅøËæº„Åø</div>
                <div class="code-content">
<span class="comment"># Áï∞Â∏∏ÂÄ§Ê§úÂá∫</span>
anomaly_detection <span class="operator">&lt;-</span> sales_ts <span class="operator">%&gt;%</span>
  <span class="function">plot_anomaly_diagnostics</span>(.date_var <span class="operator">=</span> date, .value <span class="operator">=</span> sales, 
                              .alpha <span class="operator">=</span> <span class="number">0.05</span>, .max_anomalies <span class="operator">=</span> <span class="number">0.1</span>)

<span class="comment"># Áï∞Â∏∏ÂÄ§„ÅÆÁâπÂÆö</span>
anomalies <span class="operator">&lt;-</span> sales_ts <span class="operator">%&gt;%</span>
  <span class="function">tk_anomaly_diagnostics</span>(.date_var <span class="operator">=</span> date, .value <span class="operator">=</span> sales) <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(anomaly <span class="operator">==</span> <span class="string">"Yes"</span>)

<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"Ê§úÂá∫„Åï„Çå„ÅüÁï∞Â∏∏ÂÄ§Êï∞:"</span>, <span class="function">nrow</span>(anomalies)))
<span class="function">print</span>(<span class="string">"Áï∞Â∏∏ÂÄ§„ÅÆ‰æã:"</span>)
<span class="function">print</span>(<span class="function">head</span>(anomalies, <span class="number">5</span>))

<span class="comment"># Â§ñÈÉ®Â§âÊï∞Ôºà‰æãÔºöÂ∫ÉÂëäË≤ª„ÄÅÊ∞óÊ∏©„Å™„Å©Ôºâ„ÇíÂê´„ÇÄ„Éá„Éº„Çø„ÅÆ‰ΩúÊàê</span>
enhanced_sales <span class="operator">&lt;-</span> sales_ts <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    <span class="comment"># Â∫ÉÂëäË≤ªÔºàÈÄ±Êú´„Å´Â§ö„ÅèÊäïÂÖ•Ôºâ</span>
    ad_spend <span class="operator">=</span> <span class="function">case_when</span>(
      <span class="function">wday</span>(date) <span class="operator">%in%</span> <span class="function">c</span>(<span class="number">1</span>, <span class="number">7</span>) ~ <span class="function">rnorm</span>(<span class="function">n</span>(), <span class="number">50000</span>, <span class="number">10000</span>),
      <span class="variable">TRUE</span> ~ <span class="function">rnorm</span>(<span class="function">n</span>(), <span class="number">30000</span>, <span class="number">8000</span>)
    ),
    
    <span class="comment"># Ê∞óÊ∏©ÔºàÂ≠£ÁØÄÊÄß„ÅÇ„ÇäÔºâ</span>
    temperature <span class="operator">=</span> <span class="number">20</span> <span class="operator">+</span> <span class="number">15</span> <span class="operator">*</span> <span class="function">sin</span>(<span class="number">2</span> <span class="operator">*</span> pi <span class="operator">*</span> <span class="function">yday</span>(date) / <span class="number">365</span>) <span class="operator">+</span> <span class="function">rnorm</span>(<span class="function">n</span>(), <span class="number">0</span>, <span class="number">3</span>),
    
    <span class="comment"># Á´∂Âêà‰ªñÁ§æ„ÅÆ„Ç≠„É£„É≥„Éö„Éº„É≥Ôºà„É©„É≥„ÉÄ„É†Ôºâ</span>
    competitor_campaign <span class="operator">=</span> <span class="function">rbinom</span>(<span class="function">n</span>(), <span class="number">1</span>, <span class="number">0.1</span>),
    
    <span class="comment"># Á•ùÊó•„Éï„É©„Ç∞</span>
    is_holiday <span class="operator">=</span> <span class="function">case_when</span>(
      <span class="function">month</span>(date) <span class="operator">==</span> <span class="number">1</span> <span class="operator">&amp;&amp;</span> <span class="function">day</span>(date) <span class="operator">%in%</span> <span class="function">c</span>(<span class="number">1</span>:<span class="number">3</span>) ~ <span class="number">1</span>,
      <span class="function">month</span>(date) <span class="operator">==</span> <span class="number">5</span> <span class="operator">&amp;&amp;</span> <span class="function">day</span>(date) <span class="operator">%in%</span> <span class="function">c</span>(<span class="number">3</span>:<span class="number">5</span>) ~ <span class="number">1</span>,
      <span class="function">month</span>(date) <span class="operator">==</span> <span class="number">12</span> <span class="operator">&amp;&amp;</span> <span class="function">day</span>(date) <span class="operator">%in%</span> <span class="function">c</span>(<span class="number">23</span>:<span class="number">25</span>) ~ <span class="number">1</span>,
      <span class="variable">TRUE</span> ~ <span class="number">0</span>
    )
  ) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(ad_spend <span class="operator">=</span> <span class="function">pmax</span>(ad_spend, <span class="number">10000</span>))

<span class="comment"># Â§ñÈÉ®Â§âÊï∞„ÇíÂê´„ÇÄÈ´òÂ∫¶„Å™„É¢„Éá„É´</span>
enhanced_splits <span class="operator">&lt;-</span> enhanced_sales <span class="operator">%&gt;%</span>
  <span class="function">time_series_split</span>(assess <span class="operator">=</span> <span class="string">"3 months"</span>, cumulative <span class="operator">=</span> <span class="variable">TRUE</span>)

enhanced_train <span class="operator">&lt;-</span> <span class="function">training</span>(enhanced_splits)
enhanced_test <span class="operator">&lt;-</span> <span class="function">testing</span>(enhanced_splits)

<span class="comment"># Â§ñÈÉ®Â§âÊï∞„ÇíÂê´„ÇÄÁ∑öÂΩ¢ÂõûÂ∏∞„É¢„Éá„É´</span>
model_enhanced_lm <span class="operator">&lt;-</span> <span class="function">linear_reg</span>() <span class="operator">%&gt;%</span>
  <span class="function">set_engine</span>(<span class="string">"lm"</span>) <span class="operator">%&gt;%</span>
  <span class="function">fit</span>(sales ~ <span class="function">as.numeric</span>(date) <span class="operator">+</span> <span class="function">wday</span>(date, label <span class="operator">=</span> <span class="variable">TRUE</span>) <span class="operator">+</span> <span class="function">month</span>(date, label <span class="operator">=</span> <span class="variable">TRUE</span>) <span class="operator">+</span>
           ad_spend <span class="operator">+</span> temperature <span class="operator">+</span> competitor_campaign <span class="operator">+</span> is_holiday,
      data <span class="operator">=</span> enhanced_train)

<span class="comment"># Â§ñÈÉ®Â§âÊï∞„ÇíÂê´„ÇÄ„É©„É≥„ÉÄ„É†„Éï„Ç©„É¨„Çπ„Éà„É¢„Éá„É´</span>
model_enhanced_rf <span class="operator">&lt;-</span> <span class="function">rand_forest</span>(trees <span class="operator">=</span> <span class="number">500</span>) <span class="operator">%&gt;%</span>
  <span class="function">set_engine</span>(<span class="string">"ranger"</span>) <span class="operator">%&gt;%</span>
  <span class="function">set_mode</span>(<span class="string">"regression"</span>) <span class="operator">%&gt;%</span>
  <span class="function">fit</span>(sales ~ <span class="function">as.numeric</span>(date) <span class="operator">+</span> <span class="function">wday</span>(date, label <span class="operator">=</span> <span class="variable">TRUE</span>) <span class="operator">+</span> <span class="function">month</span>(date, label <span class="operator">=</span> <span class="variable">TRUE</span>) <span class="operator">+</span>
           ad_spend <span class="operator">+</span> temperature <span class="operator">+</span> competitor_campaign <span class="operator">+</span> is_holiday,
      data <span class="operator">=</span> enhanced_train)

<span class="comment"># Êã°Âºµ„É¢„Éá„É´„ÅÆË©ï‰æ°</span>
enhanced_models <span class="operator">&lt;-</span> <span class="function">modeltime_table</span>(
  model_enhanced_lm,
  model_enhanced_rf
)

enhanced_accuracy <span class="operator">&lt;-</span> enhanced_models <span class="operator">%&gt;%</span>
  <span class="function">modeltime_accuracy</span>(enhanced_test)

<span class="function">print</span>(<span class="string">"Â§ñÈÉ®Â§âÊï∞„ÇíÂê´„ÇÄ„É¢„Éá„É´„ÅÆÁ≤æÂ∫¶:"</span>)
<span class="function">print</span>(enhanced_accuracy)

<span class="comment"># ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶Ôºà„É©„É≥„ÉÄ„É†„Éï„Ç©„É¨„Çπ„Éà„É¢„Éá„É´Ôºâ</span>
<span class="keyword">if</span> (<span class="function">require</span>(<span class="string">vip</span>, quietly <span class="operator">=</span> <span class="variable">TRUE</span>)) {
  feature_importance <span class="operator">&lt;-</span> model_enhanced_rf <span class="operator">%&gt;%</span>
    <span class="function">extract_fit_parsnip</span>() <span class="operator">%&gt;%</span>
    <span class="function">vip::vi</span>() <span class="operator">%&gt;%</span>
    <span class="function">arrange</span>(<span class="function">desc</span>(Importance))
  
  <span class="function">print</span>(<span class="string">"ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶:"</span>)
  <span class="function">print</span>(feature_importance)
}

<span class="comment"># ÊÆãÂ∑ÆÂàÜÊûê</span>
residuals_analysis <span class="operator">&lt;-</span> enhanced_models <span class="operator">%&gt;%</span>
  <span class="function">modeltime_forecast</span>(new_data <span class="operator">=</span> enhanced_test, actual_data <span class="operator">=</span> enhanced_train) <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(.model_desc <span class="operator">==</span> <span class="string">"RANGER"</span>, .key <span class="operator">==</span> <span class="string">"prediction"</span>) <span class="operator">%&gt;%</span>
  <span class="function">left_join</span>(enhanced_test <span class="operator">%&gt;%</span> <span class="function">select</span>(date, actual_sales <span class="operator">=</span> sales), by <span class="operator">=</span> <span class="function">c</span>(<span class="string">".index"</span> <span class="operator">=</span> <span class="string">"date"</span>)) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(residuals <span class="operator">=</span> actual_sales <span class="operator">-</span> .value)

residual_stats <span class="operator">&lt;-</span> residuals_analysis <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    mean_residual <span class="operator">=</span> <span class="function">mean</span>(residuals, na.rm <span class="operator">=</span> <span class="variable">TRUE</span>),
    sd_residual <span class="operator">=</span> <span class="function">sd</span>(residuals, na.rm <span class="operator">=</span> <span class="variable">TRUE</span>),
    rmse <span class="operator">=</span> <span class="function">sqrt</span>(<span class="function">mean</span>(residuals^<span class="number">2</span>, na.rm <span class="operator">=</span> <span class="variable">TRUE</span>)),
    mae <span class="operator">=</span> <span class="function">mean</span>(<span class="function">abs</span>(residuals), na.rm <span class="operator">=</span> <span class="variable">TRUE</span>)
  )

<span class="function">print</span>(<span class="string">"ÊÆãÂ∑ÆÁµ±Ë®à:"</span>)
<span class="function">print</span>(residual_stats)

<span class="comment"># ‰∫àÊ∏¨Âå∫Èñì„ÅÆË®àÁÆó</span>
prediction_intervals <span class="operator">&lt;-</span> enhanced_models <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(.model_id <span class="operator">==</span> <span class="number">2</span>) <span class="operator">%&gt;%</span>  <span class="comment"># Random Forest„É¢„Éá„É´</span>
  <span class="function">modeltime_forecast</span>(
    new_data <span class="operator">=</span> enhanced_test,
    actual_data <span class="operator">=</span> enhanced_train,
    conf_interval <span class="operator">=</span> <span class="number">0.95</span>
  )

interval_summary <span class="operator">&lt;-</span> prediction_intervals <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(.key <span class="operator">==</span> <span class="string">"prediction"</span>) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    avg_prediction <span class="operator">=</span> <span class="function">mean</span>(.value),
    avg_lower <span class="operator">=</span> <span class="function">mean</span>(.conf_lo),
    avg_upper <span class="operator">=</span> <span class="function">mean</span>(.conf_hi),
    interval_width <span class="operator">=</span> <span class="function">mean</span>(.conf_hi <span class="operator">-</span> .conf_lo)
  )

<span class="function">print</span>(<span class="string">"‰∫àÊ∏¨Âå∫Èñì„ÅÆÁµ±Ë®à:"</span>)
<span class="function">print</span>(interval_summary)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">È´òÂ∫¶„Å™ÊôÇÁ≥ªÂàóÂàÜÊûêÁµêÊûú</div>
                <div class="output-content">[1] "Ê§úÂá∫„Åï„Çå„ÅüÁï∞Â∏∏ÂÄ§Êï∞: 91"
Áï∞Â∏∏ÂÄ§„ÅÆ‰æã:
# A tibble: 5 √ó 8
  date       observed cleaned  remainder anomaly recomposed_l1 recomposed_l2 anomaly_score
  &lt;date&gt;        &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 2019-01-19   1629.   1358.      271. Yes             1358.         1358.          3.39
2 2019-01-20    779.   1046.     -267. Yes             1046.         1046.         -3.34
3 2019-02-04   1752.   1441.      312. Yes             1441.         1441.          3.90
4 2019-02-13    866.   1178.     -312. Yes             1178.         1178.         -3.90
5 2019-02-17   1695.   1382.      313. Yes             1382.         1382.          3.92

Â§ñÈÉ®Â§âÊï∞„ÇíÂê´„ÇÄ„É¢„Éá„É´„ÅÆÁ≤æÂ∫¶:
# A tibble: 2 √ó 9
  .model_id .model_desc .type   mae  mape  mase smape  rmse   rsq
      &lt;int&gt; &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1         1 LM          Test   54.2  4.24  0.68  4.26  69.8  0.93
2         2 RANGER      Test   43.8  3.42  0.55  3.44  56.2  0.95

ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶:
# A tibble: 8 √ó 2
  Variable                Importance
  &lt;chr&gt;                        &lt;dbl&gt;
1 as.numeric.date.             2851.
2 ad_spend                     1043.
3 temperature                   532.
4 month.date..label...TRUE.     423.
5 wday.date..label...TRUE.      298.
6 competitor_campaign           167.
7 is_holiday                     89.

ÊÆãÂ∑ÆÁµ±Ë®à:
# A tibble: 1 √ó 4
  mean_residual sd_residual  rmse   mae
          &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1          2.47        56.0  56.2  43.8

‰∫àÊ∏¨Âå∫Èñì„ÅÆÁµ±Ë®à:
# A tibble: 1 √ó 4
  avg_prediction avg_lower avg_upper interval_width
           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;
1          1284.     1174.     1394.           220.</div>
            </div>

            <div class="data-table">
                <table>
                    <thead>
                        <tr>
                            <th>ÊôÇÁ≥ªÂàó„É¢„Éá„É´</th>
                            <th>ÁâπÂæ¥</th>
                            <th>ÈÅ©Áî®Â†¥Èù¢</th>
                            <th>Èï∑ÊâÄ</th>
                            <th>Áü≠ÊâÄ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ARIMA</td>
                            <td>Ëá™Â∑±ÂõûÂ∏∞Áµ±ÂêàÁßªÂãïÂπ≥Âùá</td>
                            <td>ÂÆöÂ∏∏„Å™ÊôÇÁ≥ªÂàó</td>
                            <td>ÁêÜË´ñÁöÑÂü∫Áõ§„ÅåÂ†ÖÂÆü</td>
                            <td>„Éë„É©„É°„Éº„ÇøË™øÊï¥„ÅåË§áÈõë</td>
                        </tr>
                        <tr>
                            <td>ETS</td>
                            <td>ÊåáÊï∞Âπ≥ÊªëÊ≥ï</td>
                            <td>„Éà„É¨„É≥„Éâ„ÉªÂ≠£ÁØÄÊÄß„ÅÇ„Çä</td>
                            <td>Áõ¥ÊÑüÁöÑ„ÅßËß£Èáà„Åó„ÇÑ„Åô„ÅÑ</td>
                            <td>Â§ñÈÉ®Â§âÊï∞„ÇíÊâ±„Åà„Å™„ÅÑ</td>
                        </tr>
                        <tr>
                            <td>Prophet</td>
                            <td>FacebookÈñãÁô∫</td>
                            <td>Á•ùÊó•„ÉªÂ§ñÈÉ®Ë¶ÅÂõ†„ÅÇ„Çä</td>
                            <td>Ëá™Âãï„ÅßÂ≠£ÁØÄÊÄß„ÇíÊ§úÂá∫</td>
                            <td>Áü≠Êúü„Éá„Éº„Çø„Åß„ÅØ‰∏çÂÆâÂÆö</td>
                        </tr>
                        <tr>
                            <td>Á∑öÂΩ¢ÂõûÂ∏∞</td>
                            <td>Â§ñÈÉ®Â§âÊï∞Âà©Áî®ÂèØËÉΩ</td>
                            <td>Ë§áÊï∞Ë¶ÅÂõ†„ÅÆÂΩ±ÈüøÂàÜÊûê</td>
                            <td>Ëß£ÈáàÊÄß„ÅåÈ´ò„ÅÑ</td>
                            <td>ÈùûÁ∑öÂΩ¢Èñ¢‰øÇ„ÇíÊçâ„Åà„Å´„Åè„ÅÑ</td>
                        </tr>
                        <tr>
                            <td>Random Forest</td>
                            <td>Ê©üÊ¢∞Â≠¶Áøí„Éô„Éº„Çπ</td>
                            <td>Ë§áÈõë„Å™ÈùûÁ∑öÂΩ¢Èñ¢‰øÇ</td>
                            <td>È´ò„ÅÑ‰∫àÊ∏¨Á≤æÂ∫¶</td>
                            <td>„Éñ„É©„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <div class="key-points">
            <h4>Á¨¨12Á´†„ÅÆÈáçË¶Å„Éù„Ç§„É≥„Éà</h4>
            <ul>
                <li><strong>modeltimeÁµ±Âêà</strong>ÔºöË§áÊï∞„ÅÆÊôÇÁ≥ªÂàó„É¢„Éá„É´„ÇíÁµ±‰∏ÄÁöÑ„Å´ÊØîËºÉË©ï‰æ°</li>
                <li><strong>Â≠£ÁØÄÊÄßÂàÜËß£</strong>Ôºö„Éà„É¨„É≥„Éâ„ÄÅÂ≠£ÁØÄÊàêÂàÜ„ÄÅÊÆãÂ∑Æ„ÅÆË©≥Á¥∞ÂàÜÊûê</li>
                <li><strong>‰∫àÊ∏¨Á≤æÂ∫¶</strong>ÔºöMAE„ÄÅRMSE„ÄÅMAPE„Å´„Çà„ÇãÂåÖÊã¨ÁöÑ„Å™„É¢„Éá„É´Ë©ï‰æ°</li>
                <li><strong>Â§ñÈÉ®Â§âÊï∞</strong>ÔºöÂ∫ÉÂëäË≤ª„ÄÅÊ∞óÊ∏©Á≠â„ÅÆÂ§ñÁöÑË¶ÅÂõ†„Çí‰∫àÊ∏¨„Å´ÁµÑ„ÅøËæº„Åø</li>
                <li><strong>Áï∞Â∏∏ÂÄ§Ê§úÂá∫</strong>ÔºöÊôÇÁ≥ªÂàó„Éá„Éº„Çø„ÅÆÁï∞Â∏∏„Éë„Çø„Éº„É≥„ÇíËá™ÂãïÊ§úÂá∫</li>
                <li><strong>‰∫àÊ∏¨Âå∫Èñì</strong>Ôºö‰∏çÁ¢∫ÂÆüÊÄß„ÇíËÄÉÊÖÆ„Åó„Åü‰∫àÊ∏¨ÁØÑÂõ≤„ÅÆÁÆóÂá∫</li>
            </ul>
        </div>

        <div class="tip-box">
            <h4>ÂÆüË∑µÁöÑ„Ç¢„Éâ„Éê„Ç§„Çπ</h4>
            <p>ÊôÇÁ≥ªÂàóÂàÜÊûê„Åß„ÅØ„ÄÅ„Éâ„É°„Ç§„É≥Áü•Ë≠ò„Å®Áµ±Ë®àÊâãÊ≥ï„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ„ÅåÈáçË¶Å„Åß„Åô„ÄÇÁâπ„Å´„ÄÅÂ§ñÈÉ®Â§âÊï∞„ÅÆÈÅ∏Êäû„ÇÑÂ≠£ÁØÄÊÄß„ÅÆÁêÜËß£„ÅØ„ÄÅ‰∫àÊ∏¨Á≤æÂ∫¶„ÇíÂ§ß„Åç„ÅèÂ∑¶Âè≥„Åó„Åæ„Åô„ÄÇmodeltime„ÇíÊ¥ªÁî®„Åô„Çã„Åì„Å®„Åß„ÄÅË§áÊï∞„ÅÆ„Ç¢„Éó„É≠„Éº„ÉÅ„ÇíÂäπÁéáÁöÑ„Å´ÊØîËºÉÊ§úË®é„Åß„Åç„Åæ„Åô„ÄÇ</p>
        </div>

        <div class="tip-box">
            <h4>Áµ±Ë®à„É¢„Éá„É™„É≥„Ç∞ÁØá„ÅÆÂÆå‰∫Ü</h4>
            <p>Á¨¨10-12Á´†„Åß„ÄÅÂü∫Á§éÁµ±Ë®à„Åã„ÇâÊ©üÊ¢∞Â≠¶Áøí„ÄÅÊôÇÁ≥ªÂàóÂàÜÊûê„Åæ„Åß„ÄÅTidyverse„Å´„Çà„ÇãÂåÖÊã¨ÁöÑ„Å™ÂàÜÊûêÊâãÊ≥ï„ÇíÁøíÂæó„Åó„Åæ„Åó„Åü„ÄÇÊ¨°Á´†„Åã„Çâ„ÅØ„ÄÅ„Åï„Çâ„Å´È´òÂ∫¶„Å™ÂèØË¶ñÂåñÊäÄË°ì„Å´„Å§„ÅÑ„Å¶Â≠¶Áøí„Åó„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇ</p>
        </div>

        <nav class="chapter-nav">
            <a href="chapter11-machine-learning.html" class="nav-button">‚Üê Á¨¨11Á´†</a>
            <a href="chapter13-advanced-visualization.html" class="nav-button">Á¨¨13Á´† ‚Üí</a>
        </nav>
    </div>
</body>
</html>