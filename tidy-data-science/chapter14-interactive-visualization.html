<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á¨¨14Á´†: „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÂèØË¶ñÂåñ„Å®plotly | TidyverseÂÆåÂÖ®„Éû„Çπ„Çø„Éº</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --accent-neon: #00ff88;
            --accent-cyan: #00d4ff;
            --accent-purple: #9d4edd;
            --accent-violet: #8b5cf6;
            --accent-indigo: #6366f1;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --border-neon: #00ff88;
            --shadow-neon: 0 0 20px #00ff8840;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: linear-gradient(45deg, var(--bg-secondary), var(--bg-tertiary));
            border-radius: 20px;
            border: 2px solid var(--accent-violet);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.4);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.1), transparent);
            animation: scan 3s infinite;
        }

        @keyframes scan {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        h1 {
            font-size: 3rem;
            font-weight: 700;
            color: var(--accent-violet);
            margin-bottom: 10px;
            text-shadow: 0 0 20px var(--accent-violet);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.4rem;
            color: var(--accent-cyan);
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .chapter-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            position: relative;
            z-index: 1;
        }

        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: 3px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .progress-dot {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            border: 1px solid var(--text-secondary);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--accent-violet);
            border-color: var(--accent-violet);
            box-shadow: 0 0 5px var(--accent-violet);
        }

        .progress-dot.completed {
            background: var(--accent-cyan);
            border-color: var(--accent-cyan);
        }

        /* Navigation Widget */
        .chapter-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 3px;
            margin: 30px 0;
            padding: 6px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--accent-violet);
            width: fit-content;
            max-width: 90vw;
            margin-left: auto;
            margin-right: auto;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 1px 5px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            text-decoration: none;
            border-radius: 2px;
            border: 1px solid var(--accent-cyan);
            transition: all 0.3s ease;
            font-size: 0.65rem;
            white-space: nowrap;
        }

        .nav-button:hover {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            box-shadow: 0 0 6px var(--accent-cyan);
        }

        .nav-button.current {
            background: var(--accent-violet);
            color: var(--bg-primary);
            box-shadow: 0 0 6px var(--accent-violet);
        }

        /* Content Sections */
        .section {
            background: var(--bg-secondary);
            margin: 30px 0;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid var(--accent-purple);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-violet), var(--accent-cyan), var(--accent-purple));
            border-radius: 15px 15px 0 0;
        }

        h2 {
            color: var(--accent-violet);
            font-size: 2rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--accent-violet);
        }

        h3 {
            color: var(--accent-cyan);
            font-size: 1.5rem;
            margin: 25px 0 15px 0;
            text-shadow: 0 0 8px var(--accent-cyan);
        }

        h4 {
            color: var(--accent-purple);
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
        }

        /* Code Blocks */
        .code-container {
            margin: 20px 0;
            background: #1a1a1a;
            border-radius: 10px;
            border: 1px solid var(--accent-violet);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.1);
        }

        .code-header {
            background: var(--accent-violet);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-header::before {
            content: 'üéÆ';
            font-size: 1.1rem;
        }

        .code-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            background: #0d1117;
            color: #c9d1d9;
            overflow-x: auto;
        }

        /* Syntax highlighting */
        .keyword { color: #ff7b72; }
        .function { color: #d2a8ff; }
        .string { color: #a5d6ff; }
        .comment { color: #8b949e; font-style: italic; }
        .operator { color: #f85149; }
        .number { color: #79c0ff; }
        .variable { color: #ffa657; }

        /* Output Display */
        .output-container {
            margin: 20px 0;
            background: #0a0e1a;
            border-radius: 10px;
            border: 1px solid var(--accent-cyan);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.1);
        }

        .output-header {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .output-header::before {
            content: '‚ö°';
        }

        .output-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--accent-cyan);
        }

        /* Interactive Features */
        .interactive-demo {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--accent-indigo);
        }

        .demo-title {
            color: var(--accent-indigo);
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .demo-content {
            background: var(--bg-primary);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--accent-indigo);
            position: relative;
            overflow: hidden;
        }

        .demo-placeholder {
            color: var(--accent-indigo);
            font-style: italic;
            font-size: 1rem;
        }

        /* Interactive Controls */
        .control-panel {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border: 1px solid var(--accent-violet);
        }

        .control-title {
            color: var(--accent-violet);
            font-size: 1rem;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .control-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .control-button {
            padding: 5px 10px;
            background: var(--accent-indigo);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .control-button:hover {
            background: var(--accent-violet);
            transform: translateY(-1px);
        }

        .control-slider {
            flex: 1;
            min-width: 100px;
        }

        /* plotly Features */
        .plotly-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid var(--accent-purple);
        }

        .feature-title {
            color: var(--accent-purple);
            font-size: 1.1rem;
            margin-bottom: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feature-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .feature-example {
            background: var(--bg-primary);
            padding: 10px;
            border-radius: 5px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: var(--accent-cyan);
            border: 1px solid var(--accent-purple);
        }

        /* Data Tables */
        .data-table {
            margin: 20px 0;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-tertiary);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid var(--accent-violet);
        }

        th {
            background: var(--accent-violet);
            color: var(--bg-primary);
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--bg-secondary);
            color: var(--text-primary);
        }

        tr:nth-child(even) {
            background: rgba(139, 92, 246, 0.05);
        }

        tr:hover {
            background: rgba(139, 92, 246, 0.1);
        }

        /* Key Points */
        .key-points {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(0, 212, 255, 0.1) 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-violet);
        }

        .key-points h4 {
            color: var(--accent-violet);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .key-points h4::before {
            content: 'üí°';
        }

        .key-points ul {
            list-style: none;
            padding-left: 0;
        }

        .key-points li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .key-points li::before {
            content: '‚ñ∂';
            color: var(--accent-cyan);
            position: absolute;
            left: 0;
        }

        /* Warning/Tip boxes */
        .tip-box {
            background: rgba(157, 78, 221, 0.1);
            border: 1px solid var(--accent-purple);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-purple);
        }

        .tip-box h4 {
            color: var(--accent-purple);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tip-box h4::before {
            content: '‚ö†Ô∏è';
        }

        /* Animation for interactive elements */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .interactive-element {
            animation: pulse 2s infinite;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }

            .chapter-meta {
                flex-direction: column;
                gap: 10px;
            }

            .chapter-nav {
                gap: 2px;
                padding: 4px;
            }

            .nav-button {
                padding: 1px 3px;
                font-size: 0.6rem;
            }

            .section {
                padding: 20px;
                margin: 20px 0;
            }

            h2 {
                font-size: 1.5rem;
            }

            .plotly-features {
                grid-template-columns: 1fr;
            }

            .code-content, .output-content {
                font-size: 0.85rem;
                padding: 15px;
            }

            .control-group {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Á¨¨14Á´†: „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÂèØË¶ñÂåñ</h1>
            <p class="subtitle">plotly„Å®Shiny„Å´„Çà„ÇãÂãïÁöÑ„Éá„Éº„ÇøÊé¢Á¥¢</p>
            <div class="chapter-meta">
                <span>üéÆ „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ</span>
                <span>üìä plotlyÈÄ£Êê∫</span>
                <span>‚ö° „É™„Ç¢„É´„Çø„Ç§„É†</span>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>
        </header>

        <nav class="chapter-nav">
            <a href="chapter1-tidyverse-overview.html" class="nav-button">1</a>
            <a href="chapter2-dplyr-data-manipulation.html" class="nav-button">2</a>
            <a href="chapter3-ggplot2-visualization.html" class="nav-button">3</a>
            <a href="chapter4-tidyr-data-reshaping.html" class="nav-button">4</a>
            <a href="chapter5-stringr-text-processing.html" class="nav-button">5</a>
            <a href="chapter6-forcats-purrr-advanced.html" class="nav-button">6</a>
            <a href="chapter7-lubridate-datetime.html" class="nav-button">7</a>
            <a href="chapter8-readr-data-import.html" class="nav-button">8</a>
            <a href="chapter9-tibble-modern-dataframe.html" class="nav-button">9</a>
            <a href="chapter10-statistics-modeling.html" class="nav-button">10</a>
            <a href="chapter11-machine-learning.html" class="nav-button">11</a>
            <a href="chapter12-time-series.html" class="nav-button">12</a>
            <a href="chapter13-advanced-ggplot2.html" class="nav-button">13</a>
            <a href="#" class="nav-button current">14</a>
            <a href="chapter15-advanced-data-viz.html" class="nav-button">15</a>
        </nav>

        <section class="section">
            <h2>üéÆ plotly„Å´„Çà„Çã„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÂèØË¶ñÂåñ</h2>
            
            <p>plotly„ÅØ„ÄÅggplot2„Åß‰ΩúÊàê„Åó„Åü„Ç∞„É©„Éï„ÇíÁ∞°Âçò„Å´„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Å´Â§âÊèõ„Åß„Åç„ÇãÂº∑Âäõ„Å™„Éë„ÉÉ„Ç±„Éº„Ç∏„Åß„Åô„ÄÇ„Ç∫„Éº„É†„ÄÅ„Éë„É≥„ÄÅ„ÉÑ„Éº„É´„ÉÅ„ÉÉ„Éó„ÄÅ„Éï„Ç£„É´„Çø„É™„É≥„Ç∞„Å™„Å©„ÅÆÊ©üËÉΩ„ÇíËøΩÂä†„Åß„Åç„Åæ„Åô„ÄÇ</p>

            <h3>ggplot2„Åã„Çâplotly„Å∏„ÅÆÂ§âÊèõ</h3>

            <div class="code-container">
                <div class="code-header">Âü∫Êú¨ÁöÑ„Å™plotlyÂ§âÊèõ</div>
                <div class="code-content">
<span class="keyword">library</span>(<span class="string">plotly</span>)
<span class="keyword">library</span>(<span class="string">ggplot2</span>)
<span class="keyword">library</span>(<span class="string">dplyr</span>)
<span class="keyword">library</span>(<span class="string">htmlwidgets</span>)

<span class="comment"># „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÂàÜÊûêÁî®„Éá„Éº„Çø„ÅÆ‰ΩúÊàê</span>
<span class="function">set.seed</span>(<span class="number">123</span>)
interactive_data <span class="operator">&lt;-</span> <span class="function">tibble</span>(
  company_id <span class="operator">=</span> <span class="number">1</span>:<span class="number">200</span>,
  company_name <span class="operator">=</span> <span class="function">paste0</span>(<span class="string">"‰ºÅÊ•≠"</span>, <span class="function">sprintf</span>(<span class="string">"%03d"</span>, <span class="number">1</span>:<span class="number">200</span>)),
  industry <span class="operator">=</span> <span class="function">sample</span>(<span class="function">c</span>(<span class="string">"IT"</span>, <span class="string">"Ë£ΩÈÄ†Ê•≠"</span>, <span class="string">"ÈáëËûç"</span>, <span class="string">"Â∞èÂ£≤"</span>, <span class="string">"„Çµ„Éº„Éì„Çπ"</span>), <span class="number">200</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>),
  revenue <span class="operator">=</span> <span class="function">round</span>(<span class="function">rlnorm</span>(<span class="number">200</span>, <span class="function">log</span>(<span class="number">1000</span>), <span class="number">1</span>)),
  employees <span class="operator">=</span> <span class="function">round</span>(<span class="function">rlnorm</span>(<span class="number">200</span>, <span class="function">log</span>(<span class="number">100</span>), <span class="number">0.8</span>)),
  profit_margin <span class="operator">=</span> <span class="function">round</span>(<span class="function">rnorm</span>(<span class="number">200</span>, <span class="number">15</span>, <span class="number">8</span>), <span class="number">1</span>),
  satisfaction <span class="operator">=</span> <span class="function">round</span>(<span class="function">rnorm</span>(<span class="number">200</span>, <span class="number">4.0</span>, <span class="number">0.8</span>), <span class="number">1</span>),
  founded_year <span class="operator">=</span> <span class="function">sample</span>(<span class="number">1980</span>:<span class="number">2020</span>, <span class="number">200</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>)
) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    revenue_per_employee <span class="operator">=</span> <span class="function">round</span>(revenue / employees <span class="operator">*</span> <span class="number">10</span>, <span class="number">1</span>),
    company_age <span class="operator">=</span> <span class="number">2023</span> <span class="operator">-</span> founded_year,
    size_category <span class="operator">=</span> <span class="function">case_when</span>(
      employees <span class="operator">&lt;</span> <span class="number">50</span> ~ <span class="string">"Â∞è‰ºÅÊ•≠"</span>,
      employees <span class="operator">&lt;</span> <span class="number">200</span> ~ <span class="string">"‰∏≠‰ºÅÊ•≠"</span>,
      <span class="variable">TRUE</span> ~ <span class="string">"Â§ß‰ºÅÊ•≠"</span>
    ),
    <span class="comment"># „Ç´„Çπ„Çø„É†„ÉÑ„Éº„É´„ÉÅ„ÉÉ„ÉóÁî®„ÅÆ„ÉÜ„Ç≠„Çπ„Éà</span>
    tooltip_text <span class="operator">=</span> <span class="function">paste0</span>(
      <span class="string">"‰ºöÁ§æÂêç: "</span>, company_name, <span class="string">"&lt;br&gt;"</span>,
      <span class="string">"Ê•≠Áïå: "</span>, industry, <span class="string">"&lt;br&gt;"</span>,
      <span class="string">"Â£≤‰∏ä: ¬•"</span>, <span class="function">format</span>(revenue, big.mark <span class="operator">=</span> <span class="string">","</span>), <span class="string">"M&lt;br&gt;"</span>,
      <span class="string">"ÂæìÊ•≠Âì°Êï∞: "</span>, <span class="function">format</span>(employees, big.mark <span class="operator">=</span> <span class="string">","</span>), <span class="string">"‰∫∫&lt;br&gt;"</span>,
      <span class="string">"Âà©ÁõäÁéá: "</span>, profit_margin, <span class="string">"%&lt;br&gt;"</span>,
      <span class="string">"Ë®≠Á´ãÂπ¥: "</span>, founded_year, <span class="string">"Âπ¥"</span>
    )
  )

<span class="comment"># 1. Âü∫Êú¨ÁöÑ„Å™ggplot2„Åã„Çâplotly„Å∏„ÅÆÂ§âÊèõ</span>
basic_ggplot <span class="operator">&lt;-</span> interactive_data <span class="operator">%&gt;%</span>
  <span class="function">ggplot</span>(<span class="function">aes</span>(x <span class="operator">=</span> revenue, y <span class="operator">=</span> profit_margin, color <span class="operator">=</span> industry,
             size <span class="operator">=</span> employees, text <span class="operator">=</span> tooltip_text)) <span class="operator">+</span>
  <span class="function">geom_point</span>(alpha <span class="operator">=</span> <span class="number">0.7</span>) <span class="operator">+</span>
  <span class="function">scale_x_log10</span>(labels <span class="operator">=</span> <span class="function">scales::label_currency</span>(prefix <span class="operator">=</span> <span class="string">"¬•"</span>, suffix <span class="operator">=</span> <span class="string">"M"</span>)) <span class="operator">+</span>
  <span class="function">scale_size_continuous</span>(range <span class="operator">=</span> <span class="function">c</span>(<span class="number">3</span>, <span class="number">15</span>), guide <span class="operator">=</span> <span class="string">"none"</span>) <span class="operator">+</span>
  <span class="function">labs</span>(
    title <span class="operator">=</span> <span class="string">"‰ºÅÊ•≠ÂàÜÊûê: Â£≤‰∏ä vs Âà©ÁõäÁéá"</span>,
    subtitle <span class="operator">=</span> <span class="string">"Ê•≠ÁïåÂà•„ÉªË¶èÊ®°Âà•„ÅÆ‰ºÅÊ•≠„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊØîËºÉ"</span>,
    x <span class="operator">=</span> <span class="string">"Â£≤‰∏äÈ´òÔºàÁôæ‰∏áÂÜÜÔºâ"</span>,
    y <span class="operator">=</span> <span class="string">"Âà©ÁõäÁéáÔºà%Ôºâ"</span>,
    color <span class="operator">=</span> <span class="string">"Ê•≠Áïå"</span>
  ) <span class="operator">+</span>
  <span class="function">theme_minimal</span>() <span class="operator">+</span>
  <span class="function">theme</span>(
    plot.title <span class="operator">=</span> <span class="function">element_text</span>(size <span class="operator">=</span> <span class="number">16</span>, face <span class="operator">=</span> <span class="string">"bold"</span>),
    plot.subtitle <span class="operator">=</span> <span class="function">element_text</span>(size <span class="operator">=</span> <span class="number">12</span>),
    legend.position <span class="operator">=</span> <span class="string">"bottom"</span>
  )

<span class="comment"># plotly„Å´Â§âÊèõ</span>
interactive_plot <span class="operator">&lt;-</span> <span class="function">ggplotly</span>(
  basic_ggplot,
  tooltip <span class="operator">=</span> <span class="string">"text"</span>,  <span class="comment"># „Ç´„Çπ„Çø„É†„ÉÑ„Éº„É´„ÉÅ„ÉÉ„Éó„Çí‰ΩøÁî®</span>
  width <span class="operator">=</span> <span class="number">800</span>,
  height <span class="operator">=</span> <span class="number">600</span>
) <span class="operator">%&gt;%</span>
  <span class="function">layout</span>(
    title <span class="operator">=</span> <span class="function">list</span>(
      text <span class="operator">=</span> <span class="string">"‰ºÅÊ•≠ÂàÜÊûê: Â£≤‰∏ä vs Âà©ÁõäÁéá&lt;br&gt;&lt;sub&gt;„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÁâà - „ÇØ„É™„ÉÉ„ÇØ„Éª„Éâ„É©„ÉÉ„Ç∞„ÅßÊìç‰ΩúÂèØËÉΩ&lt;/sub&gt;"</span>,
      font <span class="operator">=</span> <span class="function">list</span>(size <span class="operator">=</span> <span class="number">16</span>)
    ),
    hovermode <span class="operator">=</span> <span class="string">"closest"</span>,
    showlegend <span class="operator">=</span> <span class="variable">TRUE</span>
  ) <span class="operator">%&gt;%</span>
  <span class="function">config</span>(
    displayModeBar <span class="operator">=</span> <span class="variable">TRUE</span>,
    modeBarButtonsToRemove <span class="operator">=</span> <span class="function">c</span>(<span class="string">"lasso2d"</span>, <span class="string">"select2d"</span>),
    displaylogo <span class="operator">=</span> <span class="variable">FALSE</span>,
    toImageButtonOptions <span class="operator">=</span> <span class="function">list</span>(
      format <span class="operator">=</span> <span class="string">"png"</span>,
      filename <span class="operator">=</span> <span class="string">"‰ºÅÊ•≠ÂàÜÊûê„ÉÅ„É£„Éº„Éà"</span>,
      width <span class="operator">=</span> <span class="number">1200</span>,
      height <span class="operator">=</span> <span class="number">800</span>
    )
  )

<span class="function">print</span>(<span class="string">"Âü∫Êú¨ÁöÑ„Å™„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Éó„É≠„ÉÉ„Éà„Åå‰ΩúÊàê„Åï„Çå„Åæ„Åó„Åü"</span>)

<span class="comment"># 2. È´òÂ∫¶„Å™„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÊ©üËÉΩ</span>
<span class="comment"># Ë§áÊï∞„ÅÆ„Çµ„Éñ„Éó„É≠„ÉÉ„Éà„ÇíÊåÅ„Å§„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</span>
subplot_data <span class="operator">&lt;-</span> interactive_data <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(industry, size_category) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    avg_revenue <span class="operator">=</span> <span class="function">mean</span>(revenue),
    avg_profit_margin <span class="operator">=</span> <span class="function">mean</span>(profit_margin),
    count <span class="operator">=</span> <span class="function">n</span>(),
    .groups <span class="operator">=</span> <span class="string">'drop'</span>
  )

<span class="comment"># „Çµ„Éñ„Éó„É≠„ÉÉ„Éà1: Ê•≠ÁïåÂà•Âπ≥ÂùáÂ£≤‰∏ä</span>
p1 <span class="operator">&lt;-</span> subplot_data <span class="operator">%&gt;%</span>
  <span class="function">plot_ly</span>(
    x <span class="operator">=</span> ~industry,
    y <span class="operator">=</span> ~avg_revenue,
    color <span class="operator">=</span> ~size_category,
    type <span class="operator">=</span> <span class="string">"bar"</span>,
    text <span class="operator">=</span> ~<span class="function">paste0</span>(<span class="string">"¬•"</span>, <span class="function">round</span>(avg_revenue), <span class="string">"M"</span>),
    textposition <span class="operator">=</span> <span class="string">"outside"</span>,
    hovertemplate <span class="operator">=</span> <span class="string">"&lt;b&gt;%{x}&lt;/b&gt;&lt;br&gt;‰ºÅÊ•≠Ë¶èÊ®°: %{fullData.name}&lt;br&gt;Âπ≥ÂùáÂ£≤‰∏ä: ¬•%{y:.0f}M&lt;extra&gt;&lt;/extra&gt;"</span>
  ) <span class="operator">%&gt;%</span>
  <span class="function">layout</span>(
    title <span class="operator">=</span> <span class="string">"Ê•≠Áïå„ÉªË¶èÊ®°Âà•Âπ≥ÂùáÂ£≤‰∏ä"</span>,
    xaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"Ê•≠Áïå"</span>),
    yaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"Âπ≥ÂùáÂ£≤‰∏äÔºàÁôæ‰∏áÂÜÜÔºâ"</span>)
  )

<span class="comment"># „Çµ„Éñ„Éó„É≠„ÉÉ„Éà2: Ë¶èÊ®°Âà•Âà©ÁõäÁéáÂàÜÂ∏É</span>
p2 <span class="operator">&lt;-</span> interactive_data <span class="operator">%&gt;%</span>
  <span class="function">plot_ly</span>(
    y <span class="operator">=</span> ~profit_margin,
    color <span class="operator">=</span> ~size_category,
    type <span class="operator">=</span> <span class="string">"box"</span>,
    boxpoints <span class="operator">=</span> <span class="string">"outliers"</span>
  ) <span class="operator">%&gt;%</span>
  <span class="function">layout</span>(
    title <span class="operator">=</span> <span class="string">"‰ºÅÊ•≠Ë¶èÊ®°Âà•Âà©ÁõäÁéáÂàÜÂ∏É"</span>,
    xaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"‰ºÅÊ•≠Ë¶èÊ®°"</span>),
    yaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"Âà©ÁõäÁéáÔºà%Ôºâ"</span>)
  )

<span class="comment"># „Çµ„Éñ„Éó„É≠„ÉÉ„Éà3: ÊôÇÁ≥ªÂàó„Éà„É¨„É≥„Éâ</span>
trend_data <span class="operator">&lt;-</span> interactive_data <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(founded_year, industry) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(new_companies <span class="operator">=</span> <span class="function">n</span>(), .groups <span class="operator">=</span> <span class="string">'drop'</span>) <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(founded_year <span class="operator">&gt;=</span> <span class="number">2000</span>)

p3 <span class="operator">&lt;-</span> trend_data <span class="operator">%&gt;%</span>
  <span class="function">plot_ly</span>(
    x <span class="operator">=</span> ~founded_year,
    y <span class="operator">=</span> ~new_companies,
    color <span class="operator">=</span> ~industry,
    type <span class="operator">=</span> <span class="string">"scatter"</span>,
    mode <span class="operator">=</span> <span class="string">"lines+markers"</span>,
    line <span class="operator">=</span> <span class="function">list</span>(width <span class="operator">=</span> <span class="number">3</span>),
    marker <span class="operator">=</span> <span class="function">list</span>(size <span class="operator">=</span> <span class="number">8</span>)
  ) <span class="operator">%&gt;%</span>
  <span class="function">layout</span>(
    title <span class="operator">=</span> <span class="string">"Ê•≠ÁïåÂà•‰ºÅÊ•≠Ë®≠Á´ã„Éà„É¨„É≥„ÉâÔºà2000Âπ¥‰ª•ÈôçÔºâ"</span>,
    xaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"Ë®≠Á´ãÂπ¥"</span>),
    yaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"Êñ∞Ë®≠‰ºÅÊ•≠Êï∞"</span>)
  )

<span class="comment"># „Çµ„Éñ„Éó„É≠„ÉÉ„Éà„ÇíÁµÑ„ÅøÂêà„Çè„Åõ</span>
combined_dashboard <span class="operator">&lt;-</span> <span class="function">subplot</span>(
  p1, p2, p3,
  nrows <span class="operator">=</span> <span class="number">3</span>,
  heights <span class="operator">=</span> <span class="function">c</span>(<span class="number">0.35</span>, <span class="number">0.3</span>, <span class="number">0.35</span>),
  titleY <span class="operator">=</span> <span class="variable">TRUE</span>,
  titleX <span class="operator">=</span> <span class="variable">TRUE</span>
) <span class="operator">%&gt;%</span>
  <span class="function">layout</span>(
    title <span class="operator">=</span> <span class="string">"‰ºÅÊ•≠ÂàÜÊûêÁµ±Âêà„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ"</span>,
    showlegend <span class="operator">=</span> <span class="variable">TRUE</span>,
    height <span class="operator">=</span> <span class="number">900</span>
  )

<span class="function">print</span>(<span class="string">"Áµ±Âêà„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Åå‰ΩúÊàê„Åï„Çå„Åæ„Åó„Åü"</span>)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">plotly„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÂåñÁµêÊûú</div>
                <div class="output-content">[1] "Âü∫Êú¨ÁöÑ„Å™„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Éó„É≠„ÉÉ„Éà„Åå‰ΩúÊàê„Åï„Çå„Åæ„Åó„Åü"
[1] "Áµ±Âêà„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Åå‰ΩúÊàê„Åï„Çå„Åæ„Åó„Åü"

# plotly„ÅÆ‰∏ªË¶ÅÊ©üËÉΩ:
- „Éõ„Éê„Éº„ÉÑ„Éº„É´„ÉÅ„ÉÉ„Éó: Ë©≥Á¥∞ÊÉÖÂ†±„ÅÆË°®Á§∫
- „Ç∫„Éº„É†„Éª„Éë„É≥: Ëá™Áî±„Å™ÁØÑÂõ≤ÈÅ∏Êäû„Å®ÁßªÂãï
- „É¨„Ç∏„Çß„É≥„ÉâÊìç‰Ωú: „Éá„Éº„ÇøÁ≥ªÂàó„ÅÆË°®Á§∫/ÈùûË°®Á§∫
- „Éá„Éº„Çø„Éù„Ç§„É≥„ÉàÈÅ∏Êäû: „ÇØ„É™„ÉÉ„ÇØ„Å´„Çà„ÇãÂÄãÂà•ÈÅ∏Êäû
- ÁîªÂÉè„Ç®„ÇØ„Çπ„Éù„Éº„Éà: PNG/SVGÂΩ¢Âºè„Åß„ÅÆ‰øùÂ≠ò

# „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„ÉâÊßãÊàê:
- Ë§áÊï∞„ÉÅ„É£„Éº„Éà„ÅÆÁµ±ÂêàË°®Á§∫
- Áµ±‰∏Ä„Åï„Çå„Åü„Ç´„É©„Éº„Éë„É¨„ÉÉ„Éà
- „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Å™Âá°‰æãÈÄ£Âãï
- „É¨„Çπ„Éù„É≥„Ç∑„Éñ„É¨„Ç§„Ç¢„Ç¶„Éà</div>
            </div>

            <div class="interactive-demo">
                <div class="demo-title">plotly„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÊ©üËÉΩ„Éá„É¢</div>
                <div class="demo-content">
                    <div class="interactive-element">
                        <p class="demo-placeholder">üéÆ „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Ç∞„É©„Éï„Ç®„É™„Ç¢</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">
                            „Åì„Åì„Å´ÂÆüÈöõ„ÅÆplotly„Ç∞„É©„Éï„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô<br>
                            ‚Ä¢ „Éû„Ç¶„Çπ„Éõ„Éê„Éº„ÅßË©≥Á¥∞ÊÉÖÂ†±<br>
                            ‚Ä¢ „Éâ„É©„ÉÉ„Ç∞„Åß„Ç∫„Éº„É†„Éª„Éë„É≥<br>
                            ‚Ä¢ „ÉÄ„Éñ„É´„ÇØ„É™„ÉÉ„ÇØ„Åß„É™„Çª„ÉÉ„Éà<br>
                            ‚Ä¢ Âá°‰æã„ÇØ„É™„ÉÉ„ÇØ„ÅßÁ≥ªÂàóÂàá„ÇäÊõø„Åà
                        </p>
                    </div>
                </div>
                <div class="control-panel">
                    <div class="control-title">„Ç≥„É≥„Éà„É≠„Éº„É´„Éë„Éç„É´</div>
                    <div class="control-group">
                        <button class="control-button" onclick="alert('„Éá„Éº„Çø„Éï„Ç£„É´„ÇøÊ©üËÉΩ')">„Éï„Ç£„É´„Çø</button>
                        <button class="control-button" onclick="alert('„Éá„Éº„Çø„ÇΩ„Éº„ÉàÊ©üËÉΩ')">„ÇΩ„Éº„Éà</button>
                        <button class="control-button" onclick="alert('„ÉÅ„É£„Éº„ÉàÂàá„ÇäÊõø„Åà')">„ÉÅ„É£„Éº„ÉàÁ®ÆÂà•</button>
                        <input type="range" class="control-slider" min="1" max="100" value="50">
                        <span style="color: var(--text-secondary); font-size: 0.8rem;">ÈÄèÊòéÂ∫¶Ë™øÊï¥</span>
                    </div>
                </div>
            </div>

            <h3>„Ç´„Çπ„Çø„É†„Ç§„É≥„Çø„É©„ÇØ„Ç∑„Éß„É≥</h3>

            <div class="code-container">
                <div class="code-header">È´òÂ∫¶„Å™„Ç´„Çπ„Çø„É†„Ç§„É≥„Çø„É©„ÇØ„Ç∑„Éß„É≥</div>
                <div class="code-content">
<span class="comment"># „Ç´„Çπ„Çø„É†„Éú„Çø„É≥„Å®„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥„ÇíÂê´„ÇÄ„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„ÉÅ„É£„Éº„Éà</span>
create_advanced_interactive <span class="operator">&lt;-</span> <span class="keyword">function</span>(data) {
  
  <span class="comment"># „Éá„Éº„ÇøÂ§âÊèõ„Éú„Çø„É≥„ÅÆË®≠ÂÆö</span>
  transform_buttons <span class="operator">&lt;-</span> <span class="function">list</span>(
    <span class="function">list</span>(
      method <span class="operator">=</span> <span class="string">"restyle"</span>,
      args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"transforms[0].value"</span>, <span class="string">"linear"</span>),
      label <span class="operator">=</span> <span class="string">"Á∑öÂΩ¢„Çπ„Ç±„Éº„É´"</span>
    ),
    <span class="function">list</span>(
      method <span class="operator">=</span> <span class="string">"relayout"</span>,
      args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"xaxis.type"</span>, <span class="string">"log"</span>),
      label <span class="operator">=</span> <span class="string">"ÂØæÊï∞„Çπ„Ç±„Éº„É´"</span>
    )
  )
  
  <span class="comment"># „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Áî®„ÅÆÂπ¥Â∫¶Âà•„Éá„Éº„Çø</span>
  animation_data <span class="operator">&lt;-</span> data <span class="operator">%&gt;%</span>
    <span class="function">mutate</span>(frame <span class="operator">=</span> <span class="function">cut</span>(founded_year, breaks <span class="operator">=</span> <span class="number">5</span>, labels <span class="operator">=</span> <span class="function">c</span>(<span class="string">"1980-1988"</span>, <span class="string">"1989-1996"</span>, <span class="string">"1997-2004"</span>, <span class="string">"2005-2012"</span>, <span class="string">"2013-2020"</span>)))
  
  <span class="comment"># „É°„Ç§„É≥„Éó„É≠„ÉÉ„Éà</span>
  p <span class="operator">&lt;-</span> animation_data <span class="operator">%&gt;%</span>
    <span class="function">plot_ly</span>(
      x <span class="operator">=</span> ~revenue,
      y <span class="operator">=</span> ~employees,
      size <span class="operator">=</span> ~profit_margin,
      color <span class="operator">=</span> ~industry,
      frame <span class="operator">=</span> ~frame,
      ids <span class="operator">=</span> ~company_id,
      text <span class="operator">=</span> ~company_name,
      type <span class="operator">=</span> <span class="string">"scatter"</span>,
      mode <span class="operator">=</span> <span class="string">"markers"</span>,
      marker <span class="operator">=</span> <span class="function">list</span>(
        sizemode <span class="operator">=</span> <span class="string">"diameter"</span>,
        sizeref <span class="operator">=</span> <span class="number">2</span>,
        sizemin <span class="operator">=</span> <span class="number">4</span>,
        line <span class="operator">=</span> <span class="function">list</span>(width <span class="operator">=</span> <span class="number">2</span>, color <span class="operator">=</span> <span class="string">"white"</span>)
      ),
      hovertemplate <span class="operator">=</span> <span class="string">"&lt;b&gt;%{text}&lt;/b&gt;&lt;br&gt;Â£≤‰∏ä: ¬•%{x:,.0f}M&lt;br&gt;ÂæìÊ•≠Âì°: %{y:,.0f}‰∫∫&lt;br&gt;Âà©ÁõäÁéá: %{marker.size:.1f}%&lt;extra&gt;&lt;/extra&gt;"</span>
    ) <span class="operator">%&gt;%</span>
    
    <span class="comment"># „É¨„Ç§„Ç¢„Ç¶„ÉàË®≠ÂÆö</span>
    <span class="function">layout</span>(
      title <span class="operator">=</span> <span class="function">list</span>(
        text <span class="operator">=</span> <span class="string">"‰ºÅÊ•≠„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÂàÜÊûêÔºàÊôÇ‰ª£Âà•„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Ôºâ"</span>,
        x <span class="operator">=</span> <span class="number">0.5</span>
      ),
      xaxis <span class="operator">=</span> <span class="function">list</span>(
        title <span class="operator">=</span> <span class="string">"Â£≤‰∏äÈ´òÔºàÁôæ‰∏áÂÜÜÔºâ"</span>,
        type <span class="operator">=</span> <span class="string">"linear"</span>,
        range <span class="operator">=</span> <span class="function">c</span>(<span class="number">0</span>, <span class="function">max</span>(data$revenue) <span class="operator">*</span> <span class="number">1.1</span>)
      ),
      yaxis <span class="operator">=</span> <span class="function">list</span>(
        title <span class="operator">=</span> <span class="string">"ÂæìÊ•≠Âì°Êï∞Ôºà‰∫∫Ôºâ"</span>,
        range <span class="operator">=</span> <span class="function">c</span>(<span class="number">0</span>, <span class="function">max</span>(data$employees) <span class="operator">*</span> <span class="number">1.1</span>)
      ),
      
      <span class="comment"># „Ç´„Çπ„Çø„É†„Éú„Çø„É≥„É°„Éã„É•„Éº</span>
      updatemenus <span class="operator">=</span> <span class="function">list</span>(
        <span class="function">list</span>(
          type <span class="operator">=</span> <span class="string">"buttons"</span>,
          direction <span class="operator">=</span> <span class="string">"left"</span>,
          x <span class="operator">=</span> <span class="number">0.1</span>,
          y <span class="operator">=</span> <span class="number">1.15</span>,
          buttons <span class="operator">=</span> <span class="function">list</span>(
            <span class="function">list</span>(
              method <span class="operator">=</span> <span class="string">"relayout"</span>,
              args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"xaxis.type"</span>, <span class="string">"linear"</span>),
              label <span class="operator">=</span> <span class="string">"Á∑öÂΩ¢"</span>
            ),
            <span class="function">list</span>(
              method <span class="operator">=</span> <span class="string">"relayout"</span>,
              args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"xaxis.type"</span>, <span class="string">"log"</span>),
              label <span class="operator">=</span> <span class="string">"ÂØæÊï∞"</span>
            )
          )
        ),
        
        <span class="comment"># Ê•≠Áïå„Éï„Ç£„É´„Çø</span>
        <span class="function">list</span>(
          type <span class="operator">=</span> <span class="string">"dropdown"</span>,
          x <span class="operator">=</span> <span class="number">0.5</span>,
          y <span class="operator">=</span> <span class="number">1.15</span>,
          buttons <span class="operator">=</span> <span class="function">c</span>(
            <span class="function">list</span>(<span class="function">list</span>(method <span class="operator">=</span> <span class="string">"restyle"</span>, args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"visible"</span>, <span class="variable">TRUE</span>), label <span class="operator">=</span> <span class="string">"„Åô„Åπ„Å¶Ë°®Á§∫"</span>)),
            <span class="function">lapply</span>(<span class="function">unique</span>(data$industry), <span class="keyword">function</span>(ind) {
              visible <span class="operator">&lt;-</span> data$industry <span class="operator">==</span> ind
              <span class="function">list</span>(method <span class="operator">=</span> <span class="string">"restyle"</span>, args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"visible"</span>, visible), label <span class="operator">=</span> ind)
            })
          )
        )
      ),
      
      <span class="comment"># „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Ë®≠ÂÆö</span>
      sliders <span class="operator">=</span> <span class="function">list</span>(
        <span class="function">list</span>(
          active <span class="operator">=</span> <span class="number">0</span>,
          currentvalue <span class="operator">=</span> <span class="function">list</span>(prefix <span class="operator">=</span> <span class="string">"ÊôÇ‰ª£: "</span>),
          steps <span class="operator">=</span> <span class="function">lapply</span>(<span class="function">unique</span>(animation_data$frame), <span class="keyword">function</span>(f) {
            <span class="function">list</span>(
              args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"frame"</span>, <span class="function">list</span>(duration <span class="operator">=</span> <span class="number">300</span>, redraw <span class="operator">=</span> <span class="variable">TRUE</span>)),
              label <span class="operator">=</span> f,
              method <span class="operator">=</span> <span class="string">"animate"</span>,
              value <span class="operator">=</span> f
            )
          })
        )
      )
    ) <span class="operator">%&gt;%</span>
    
    <span class="comment"># „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Ë®≠ÂÆö</span>
    <span class="function">animation_opts</span>(
      frame <span class="operator">=</span> <span class="number">1000</span>,
      transition <span class="operator">=</span> <span class="number">300</span>,
      redraw <span class="operator">=</span> <span class="variable">TRUE</span>
    ) <span class="operator">%&gt;%</span>
    
    <span class="comment"># Ë®≠ÂÆö</span>
    <span class="function">config</span>(
      displayModeBar <span class="operator">=</span> <span class="variable">TRUE</span>,
      modeBarButtonsToAdd <span class="operator">=</span> <span class="function">c</span>(<span class="string">"drawline"</span>, <span class="string">"drawopenpath"</span>, <span class="string">"drawclosedpath"</span>, <span class="string">"eraseshape"</span>),
      displaylogo <span class="operator">=</span> <span class="variable">FALSE</span>
    )
  
  <span class="keyword">return</span>(p)
}

<span class="comment"># È´òÂ∫¶„Å™„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Éó„É≠„ÉÉ„Éà„ÅÆ‰ΩúÊàê</span>
advanced_plot <span class="operator">&lt;-</span> <span class="function">create_advanced_interactive</span>(interactive_data)

<span class="function">print</span>(<span class="string">"È´òÂ∫¶„Å™„Ç´„Çπ„Çø„É†„Ç§„É≥„Çø„É©„ÇØ„Ç∑„Éß„É≥„ÅåËøΩÂä†„Åï„Çå„Åæ„Åó„Åü"</span>)

<span class="comment"># „ÇØ„É≠„Çπ„Éï„Ç£„É´„Çø„É™„É≥„Ç∞Áî®„ÅÆ„Éá„Éº„ÇøÊ∫ñÂÇô</span>
crossfilter_data <span class="operator">&lt;-</span> interactive_data <span class="operator">%&gt;%</span>
  <span class="function">select</span>(company_name, industry, revenue, employees, profit_margin, satisfaction)

<span class="comment"># HTML„Ç¶„Ç£„Ç∏„Çß„ÉÉ„Éà„Å®„Åó„Å¶„ÅÆ‰øùÂ≠òË®≠ÂÆö</span>
widget_options <span class="operator">&lt;-</span> <span class="function">list</span>(
  width <span class="operator">=</span> <span class="string">"100%"</span>,
  height <span class="operator">=</span> <span class="string">"600px"</span>,
  elementId <span class="operator">=</span> <span class="string">"interactive-business-chart"</span>
)

<span class="function">print</span>(<span class="string">"„Ç¶„Ç£„Ç∏„Çß„ÉÉ„ÉàË®≠ÂÆö„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü"</span>)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">È´òÂ∫¶„Å™„Ç§„É≥„Çø„É©„ÇØ„Ç∑„Éß„É≥ÁµêÊûú</div>
                <div class="output-content">[1] "È´òÂ∫¶„Å™„Ç´„Çπ„Çø„É†„Ç§„É≥„Çø„É©„ÇØ„Ç∑„Éß„É≥„ÅåËøΩÂä†„Åï„Çå„Åæ„Åó„Åü"
[1] "„Ç¶„Ç£„Ç∏„Çß„ÉÉ„ÉàË®≠ÂÆö„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü"

# È´òÂ∫¶„Å™„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÊ©üËÉΩ:
- „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥: ÊôÇÁ≥ªÂàó„Åß„ÅÆÂ§âÂåñË°®Á§∫
- „Ç´„Çπ„Çø„É†„Éú„Çø„É≥: „Çπ„Ç±„Éº„É´Âàá„ÇäÊõø„Åà„ÄÅ„Éï„Ç£„É´„Çø
- „Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥„É°„Éã„É•„Éº: ÂãïÁöÑ„Éá„Éº„ÇøÈÅ∏Êäû
- „Çπ„É©„Ç§„ÉÄ„Éº: „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Âà∂Âæ°
- ÊèèÁîª„ÉÑ„Éº„É´: Ê≥®Èáà„Éª„Éû„Éº„Ç≠„É≥„Ç∞Ê©üËÉΩ

# ‰ºÅÊ•≠ÂàÜÊûêÁâπÂåñÊ©üËÉΩ:
- Ê•≠ÁïåÂà•„Éï„Ç£„É´„Çø„É™„É≥„Ç∞
- ‰ºÅÊ•≠Ë¶èÊ®°„Å´„Çà„ÇãËâ≤ÂàÜ„Åë
- Â§öÊ¨°ÂÖÉ„Éá„Éº„Çø„ÅÆÂêåÊôÇË°®Á§∫
- „Ç´„Çπ„Çø„É†„ÉÑ„Éº„É´„ÉÅ„ÉÉ„ÉóÊÉÖÂ†±</div>
            </div>

            <div class="plotly-features">
                <div class="feature-card">
                    <div class="feature-title">üéØ „Éõ„Éê„Éº„ÉÑ„Éº„É´„ÉÅ„ÉÉ„Éó</div>
                    <div class="feature-description">„Éû„Ç¶„Çπ„Ç™„Éº„Éê„Éº„ÅßË©≥Á¥∞ÊÉÖÂ†±„ÇíË°®Á§∫„ÄÇHTML„Éï„Ç©„Éº„Éû„ÉÉ„ÉàÂØæÂøú„Åß„É™„ÉÉ„ÉÅ„Å™ÊÉÖÂ†±ÊèêÁ§∫„ÅåÂèØËÉΩ„ÄÇ</div>
                    <div class="feature-example">hovertemplate = "&lt;b&gt;%{text}&lt;/b&gt;&lt;br&gt;ÂÄ§: %{y:.2f}&lt;extra&gt;&lt;/extra&gt;"</div>
                </div>
                <div class="feature-card">
                    <div class="feature-title">üîç „Ç∫„Éº„É†„Éª„Éë„É≥</div>
                    <div class="feature-description">„Éû„Ç¶„Çπ„Éâ„É©„ÉÉ„Ç∞„Åß„ÅÆ„Ç∫„Éº„É†„ÄÅ„Éë„É≥Êìç‰Ωú„ÄÇÁâπÂÆöÁØÑÂõ≤„ÅÆË©≥Á¥∞ÂàÜÊûê„Å´ÊúÄÈÅ©„ÄÇ</div>
                    <div class="feature-example">config(scrollZoom = TRUE, doubleClick = 'reset')</div>
                </div>
                <div class="feature-card">
                    <div class="feature-title">üéÆ „Ç´„Çπ„Çø„É†„Éú„Çø„É≥</div>
                    <div class="feature-description">„Éá„Éº„ÇøÂ§âÊèõ„ÄÅ„Éï„Ç£„É´„Çø„É™„É≥„Ç∞„ÄÅË°®Á§∫Âàá„ÇäÊõø„Åà„ÅÆ„Åü„ÇÅ„ÅÆ„Ç´„Çπ„Çø„É†UIË¶ÅÁ¥†„ÄÇ</div>
                    <div class="feature-example">updatemenus = list(type = "buttons", buttons = [...])</div>
                </div>
                <div class="feature-card">
                    <div class="feature-title">üé¨ „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥</div>
                    <div class="feature-description">ÊôÇÁ≥ªÂàó„Éá„Éº„Çø„ÅÆÂãïÁöÑË°®Á§∫„ÄÇ„Éá„Éº„Çø„ÅÆÂ§âÂåñ„Éë„Çø„Éº„É≥„ÇíÂäπÊûúÁöÑ„Å´Ë°®Áèæ„ÄÇ</div>
                    <div class="feature-example">animation_opts(frame = 1000, transition = 300)</div>
                </div>
                <div class="feature-card">
                    <div class="feature-title">üìä „Çµ„Éñ„Éó„É≠„ÉÉ„Éà</div>
                    <div class="feature-description">Ë§áÊï∞„ÅÆ„ÉÅ„É£„Éº„Éà„ÇíÁµ±Âêà„Åó„Åü„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„ÉâË°®Á§∫„ÄÇÂåÖÊã¨ÁöÑ„Å™ÂàÜÊûêË¶ñÁÇπ„ÇíÊèê‰æõ„ÄÇ</div>
                    <div class="feature-example">subplot(p1, p2, nrows = 2, shareX = TRUE)</div>
                </div>
                <div class="feature-card">
                    <div class="feature-title">üíæ „Ç®„ÇØ„Çπ„Éù„Éº„Éà</div>
                    <div class="feature-description">PNG„ÄÅSVG„ÄÅPDFÂΩ¢Âºè„Åß„ÅÆÁîªÂÉè‰øùÂ≠ò„ÄÇ„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥Ë≥áÊñô„Å´ÊúÄÈÅ©„ÄÇ</div>
                    <div class="feature-example">toImageButtonOptions = list(format = "png", filename = "chart")</div>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>‚ö° Shiny„Å´„Çà„Çã„É™„Ç¢„É´„Çø„Ç§„É†„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</h2>

            <h3>Âü∫Êú¨ÁöÑ„Å™Shiny„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥</h3>

            <div class="code-container">
                <div class="code-header">Shiny + plotly„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</div>
                <div class="code-content">
<span class="keyword">library</span>(<span class="string">shiny</span>)
<span class="keyword">library</span>(<span class="string">shinydashboard</span>)
<span class="keyword">library</span>(<span class="string">DT</span>)

<span class="comment"># Shiny UI„ÅÆÂÆöÁæ©</span>
dashboard_ui <span class="operator">&lt;-</span> <span class="function">dashboardPage</span>(
  
  <span class="comment"># „Éò„ÉÉ„ÉÄ„Éº</span>
  <span class="function">dashboardHeader</span>(title <span class="operator">=</span> <span class="string">"‰ºÅÊ•≠ÂàÜÊûê„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ"</span>),
  
  <span class="comment"># „Çµ„Ç§„Éâ„Éê„Éº</span>
  <span class="function">dashboardSidebar</span>(
    <span class="function">sidebarMenu</span>(
      <span class="function">menuItem</span>(<span class="string">"Ê¶ÇË¶Å"</span>, tabName <span class="operator">=</span> <span class="string">"overview"</span>, icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"dashboard"</span>)),
      <span class="function">menuItem</span>(<span class="string">"Ë©≥Á¥∞ÂàÜÊûê"</span>, tabName <span class="operator">=</span> <span class="string">"analysis"</span>, icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"chart-line"</span>)),
      <span class="function">menuItem</span>(<span class="string">"„Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´"</span>, tabName <span class="operator">=</span> <span class="string">"data"</span>, icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"table"</span>))
    ),
    
    <span class="comment"># „Éï„Ç£„É´„Çø„Ç≥„É≥„Éà„É≠„Éº„É´</span>
    <span class="function">div</span>(style <span class="operator">=</span> <span class="string">"padding: 20px;"</span>,
      <span class="function">h4</span>(<span class="string">"„Éï„Ç£„É´„ÇøË®≠ÂÆö"</span>),
      
      <span class="function">selectInput</span>(
        inputId <span class="operator">=</span> <span class="string">"industry_filter"</span>,
        label <span class="operator">=</span> <span class="string">"Ê•≠ÁïåÈÅ∏Êäû:"</span>,
        choices <span class="operator">=</span> <span class="function">c</span>(<span class="string">"„Åô„Åπ„Å¶"</span> <span class="operator">=</span> <span class="string">"all"</span>, <span class="string">"IT"</span>, <span class="string">"Ë£ΩÈÄ†Ê•≠"</span>, <span class="string">"ÈáëËûç"</span>, <span class="string">"Â∞èÂ£≤"</span>, <span class="string">"„Çµ„Éº„Éì„Çπ"</span>),
        selected <span class="operator">=</span> <span class="string">"all"</span>,
        multiple <span class="operator">=</span> <span class="variable">TRUE</span>
      ),
      
      <span class="function">sliderInput</span>(
        inputId <span class="operator">=</span> <span class="string">"revenue_range"</span>,
        label <span class="operator">=</span> <span class="string">"Â£≤‰∏äÁØÑÂõ≤ÔºàÁôæ‰∏áÂÜÜÔºâ:"</span>,
        min <span class="operator">=</span> <span class="number">0</span>,
        max <span class="operator">=</span> <span class="number">5000</span>,
        value <span class="operator">=</span> <span class="function">c</span>(<span class="number">0</span>, <span class="number">5000</span>),
        step <span class="operator">=</span> <span class="number">100</span>
      ),
      
      <span class="function">sliderInput</span>(
        inputId <span class="operator">=</span> <span class="string">"employee_range"</span>,
        label <span class="operator">=</span> <span class="string">"ÂæìÊ•≠Âì°Êï∞ÁØÑÂõ≤:"</span>,
        min <span class="operator">=</span> <span class="number">1</span>,
        max <span class="operator">=</span> <span class="number">1000</span>,
        value <span class="operator">=</span> <span class="function">c</span>(<span class="number">1</span>, <span class="number">1000</span>),
        step <span class="operator">=</span> <span class="number">10</span>
      ),
      
      <span class="function">checkboxInput</span>(
        inputId <span class="operator">=</span> <span class="string">"show_trend"</span>,
        label <span class="operator">=</span> <span class="string">"„Éà„É¨„É≥„Éâ„É©„Ç§„É≥Ë°®Á§∫"</span>,
        value <span class="operator">=</span> <span class="variable">TRUE</span>
      ),
      
      <span class="function">actionButton</span>(
        inputId <span class="operator">=</span> <span class="string">"refresh_data"</span>,
        label <span class="operator">=</span> <span class="string">"„Éá„Éº„ÇøÊõ¥Êñ∞"</span>,
        icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"refresh"</span>),
        class <span class="operator">=</span> <span class="string">"btn-primary"</span>
      )
    )
  ),
  
  <span class="comment"># „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ</span>
  <span class="function">dashboardBody</span>(
    <span class="function">tags$head</span>(
      <span class="function">tags$style</span>(<span class="function">HTML</span>(<span class="string">"
        .content-wrapper, .right-side {
          background-color: #f4f4f4;
        }
        .main-header .logo {
          background-color: #3c8dbc !important;
        }
        .skin-blue .main-header .navbar {
          background-color: #3c8dbc !important;
        }
      "</span>))
    ),
    
    <span class="function">tabItems</span>(
      <span class="comment"># Ê¶ÇË¶Å„Çø„Éñ</span>
      <span class="function">tabItem</span>(
        tabName <span class="operator">=</span> <span class="string">"overview"</span>,
        
        <span class="function">fluidRow</span>(
          <span class="comment"># KPI„Éú„ÉÉ„ÇØ„Çπ</span>
          <span class="function">valueBoxOutput</span>(<span class="string">"total_companies"</span>, width <span class="operator">=</span> <span class="number">3</span>),
          <span class="function">valueBoxOutput</span>(<span class="string">"avg_revenue"</span>, width <span class="operator">=</span> <span class="number">3</span>),
          <span class="function">valueBoxOutput</span>(<span class="string">"avg_employees"</span>, width <span class="operator">=</span> <span class="number">3</span>),
          <span class="function">valueBoxOutput</span>(<span class="string">"avg_profit"</span>, width <span class="operator">=</span> <span class="number">3</span>)
        ),
        
        <span class="function">fluidRow</span>(
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"Ê•≠ÁïåÂà•Â£≤‰∏äÂàÜÂ∏É"</span>,
            status <span class="operator">=</span> <span class="string">"primary"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">8</span>,
            <span class="function">plotlyOutput</span>(<span class="string">"industry_plot"</span>, height <span class="operator">=</span> <span class="string">"400px"</span>)
          ),
          
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"‰ºÅÊ•≠Ë¶èÊ®°ÂàÜÂ∏É"</span>,
            status <span class="operator">=</span> <span class="string">"success"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">4</span>,
            <span class="function">plotlyOutput</span>(<span class="string">"size_plot"</span>, height <span class="operator">=</span> <span class="string">"400px"</span>)
          )
        )
      ),
      
      <span class="comment"># Ë©≥Á¥∞ÂàÜÊûê„Çø„Éñ</span>
      <span class="function">tabItem</span>(
        tabName <span class="operator">=</span> <span class="string">"analysis"</span>,
        
        <span class="function">fluidRow</span>(
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"‰ºÅÊ•≠„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊï£Â∏ÉÂõ≥"</span>,
            status <span class="operator">=</span> <span class="string">"primary"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">12</span>,
            <span class="function">plotlyOutput</span>(<span class="string">"scatter_plot"</span>, height <span class="operator">=</span> <span class="string">"500px"</span>)
          )
        ),
        
        <span class="function">fluidRow</span>(
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"ÊôÇÁ≥ªÂàó„Éà„É¨„É≥„Éâ"</span>,
            status <span class="operator">=</span> <span class="string">"info"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">6</span>,
            <span class="function">plotlyOutput</span>(<span class="string">"trend_plot"</span>, height <span class="operator">=</span> <span class="string">"350px"</span>)
          ),
          
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"Áõ∏Èñ¢ÂàÜÊûê"</span>,
            status <span class="operator">=</span> <span class="string">"warning"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">6</span>,
            <span class="function">plotlyOutput</span>(<span class="string">"correlation_plot"</span>, height <span class="operator">=</span> <span class="string">"350px"</span>)
          )
        )
      ),
      
      <span class="comment"># „Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´„Çø„Éñ</span>
      <span class="function">tabItem</span>(
        tabName <span class="operator">=</span> <span class="string">"data"</span>,
        
        <span class="function">fluidRow</span>(
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"‰ºÅÊ•≠„Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´"</span>,
            status <span class="operator">=</span> <span class="string">"primary"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">12</span>,
            
            <span class="function">div</span>(style <span class="operator">=</span> <span class="string">"margin-bottom: 20px;"</span>,
              <span class="function">downloadButton</span>(<span class="string">"download_data"</span>, <span class="string">"CSV„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ"</span>, class <span class="operator">=</span> <span class="string">"btn-success"</span>)
            ),
            
            <span class="function">DT::dataTableOutput</span>(<span class="string">"data_table"</span>)
          )
        )
      )
    )
  )
)

<span class="comment"># Shiny„Çµ„Éº„Éê„Éº„É≠„Ç∏„ÉÉ„ÇØ</span>
dashboard_server <span class="operator">&lt;-</span> <span class="keyword">function</span>(input, output, session) {
  
  <span class="comment"># „É™„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Éá„Éº„Çø„Éï„Ç£„É´„Çø„É™„É≥„Ç∞</span>
  filtered_data <span class="operator">&lt;-</span> <span class="function">reactive</span>({
    data <span class="operator">&lt;-</span> interactive_data
    
    <span class="comment"># Ê•≠Áïå„Éï„Ç£„É´„Çø</span>
    <span class="keyword">if</span> (!<span class="function">is.null</span>(input$industry_filter) <span class="operator">&amp;&amp;</span> !<span class="string">"all"</span> <span class="operator">%in%</span> input$industry_filter) {
      data <span class="operator">&lt;-</span> data <span class="operator">%&gt;%</span> <span class="function">filter</span>(industry <span class="operator">%in%</span> input$industry_filter)
    }
    
    <span class="comment"># Â£≤‰∏äÁØÑÂõ≤„Éï„Ç£„É´„Çø</span>
    data <span class="operator">&lt;-</span> data <span class="operator">%&gt;%</span>
      <span class="function">filter</span>(
        revenue <span class="operator">&gt;=</span> input$revenue_range[<span class="number">1</span>],
        revenue <span class="operator">&lt;=</span> input$revenue_range[<span class="number">2</span>],
        employees <span class="operator">&gt;=</span> input$employee_range[<span class="number">1</span>],
        employees <span class="operator">&lt;=</span> input$employee_range[<span class="number">2</span>]
      )
    
    <span class="keyword">return</span>(data)
  })
  
  <span class="comment"># KPI„Éú„ÉÉ„ÇØ„Çπ</span>
  output$total_companies <span class="operator">&lt;-</span> <span class="function">renderValueBox</span>({
    <span class="function">valueBox</span>(
      value <span class="operator">=</span> <span class="function">nrow</span>(<span class="function">filtered_data</span>()),
      subtitle <span class="operator">=</span> <span class="string">"Á∑è‰ºÅÊ•≠Êï∞"</span>,
      icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"building"</span>),
      color <span class="operator">=</span> <span class="string">"blue"</span>
    )
  })
  
  output$avg_revenue <span class="operator">&lt;-</span> <span class="function">renderValueBox</span>({
    <span class="function">valueBox</span>(
      value <span class="operator">=</span> <span class="function">paste0</span>(<span class="string">"¬•"</span>, <span class="function">round</span>(<span class="function">mean</span>(<span class="function">filtered_data</span>()$revenue)), <span class="string">"M"</span>),
      subtitle <span class="operator">=</span> <span class="string">"Âπ≥ÂùáÂ£≤‰∏ä"</span>,
      icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"yen-sign"</span>),
      color <span class="operator">=</span> <span class="string">"green"</span>
    )
  })
  
  output$avg_employees <span class="operator">&lt;-</span> <span class="function">renderValueBox</span>({
    <span class="function">valueBox</span>(
      value <span class="operator">=</span> <span class="function">round</span>(<span class="function">mean</span>(<span class="function">filtered_data</span>()$employees)),
      subtitle <span class="operator">=</span> <span class="string">"Âπ≥ÂùáÂæìÊ•≠Âì°Êï∞"</span>,
      icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"users"</span>),
      color <span class="operator">=</span> <span class="string">"yellow"</span>
    )
  })
  
  output$avg_profit <span class="operator">&lt;-</span> <span class="function">renderValueBox</span>({
    <span class="function">valueBox</span>(
      value <span class="operator">=</span> <span class="function">paste0</span>(<span class="function">round</span>(<span class="function">mean</span>(<span class="function">filtered_data</span>()$profit_margin), <span class="number">1</span>), <span class="string">"%"</span>),
      subtitle <span class="operator">=</span> <span class="string">"Âπ≥ÂùáÂà©ÁõäÁéá"</span>,
      icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"chart-line"</span>),
      color <span class="operator">=</span> <span class="string">"red"</span>
    )
  })
  
  <span class="comment"># „Éó„É≠„ÉÉ„ÉàÁîüÊàê</span>
  output$scatter_plot <span class="operator">&lt;-</span> <span class="function">renderPlotly</span>({
    p <span class="operator">&lt;-</span> <span class="function">filtered_data</span>() <span class="operator">%&gt;%</span>
      <span class="function">plot_ly</span>(
        x <span class="operator">=</span> ~revenue,
        y <span class="operator">=</span> ~profit_margin,
        color <span class="operator">=</span> ~industry,
        size <span class="operator">=</span> ~employees,
        text <span class="operator">=</span> ~company_name,
        type <span class="operator">=</span> <span class="string">"scatter"</span>,
        mode <span class="operator">=</span> <span class="string">"markers"</span>,
        hovertemplate <span class="operator">=</span> <span class="string">"&lt;b&gt;%{text}&lt;/b&gt;&lt;br&gt;Â£≤‰∏ä: ¬•%{x:,.0f}M&lt;br&gt;Âà©ÁõäÁéá: %{y:.1f}%&lt;extra&gt;&lt;/extra&gt;"</span>
      ) <span class="operator">%&gt;%</span>
      <span class="function">layout</span>(
        title <span class="operator">=</span> <span class="string">"Â£≤‰∏ä vs Âà©ÁõäÁéá"</span>,
        xaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"Â£≤‰∏äÈ´òÔºàÁôæ‰∏áÂÜÜÔºâ"</span>),
        yaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"Âà©ÁõäÁéáÔºà%Ôºâ"</span>)
      )
    
    <span class="keyword">if</span> (input$show_trend) {
      p <span class="operator">&lt;-</span> p <span class="operator">%&gt;%</span> <span class="function">add_lines</span>(
        x <span class="operator">=</span> ~revenue,
        y <span class="operator">=</span> <span class="function">fitted</span>(<span class="function">lm</span>(profit_margin ~ revenue, data <span class="operator">=</span> <span class="function">filtered_data</span>())),
        line <span class="operator">=</span> <span class="function">list</span>(color <span class="operator">=</span> <span class="string">"red"</span>, width <span class="operator">=</span> <span class="number">2</span>),
        name <span class="operator">=</span> <span class="string">"„Éà„É¨„É≥„Éâ„É©„Ç§„É≥"</span>,
        hoverinfo <span class="operator">=</span> <span class="string">"skip"</span>
      )
    }
    
    p
  })
  
  <span class="comment"># „Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´</span>
  output$data_table <span class="operator">&lt;-</span> <span class="function">DT::renderDataTable</span>({
    <span class="function">filtered_data</span>() <span class="operator">%&gt;%</span>
      <span class="function">select</span>(company_name, industry, revenue, employees, profit_margin, satisfaction) <span class="operator">%&gt;%</span>
      <span class="function">DT::datatable</span>(
        options <span class="operator">=</span> <span class="function">list</span>(
          pageLength <span class="operator">=</span> <span class="number">15</span>,
          scrollX <span class="operator">=</span> <span class="variable">TRUE</span>,
          searching <span class="operator">=</span> <span class="variable">TRUE</span>
        ),
        colnames <span class="operator">=</span> <span class="function">c</span>(<span class="string">"‰ºÅÊ•≠Âêç"</span>, <span class="string">"Ê•≠Áïå"</span>, <span class="string">"Â£≤‰∏ä(M¬•)"</span>, <span class="string">"ÂæìÊ•≠Âì°Êï∞"</span>, <span class="string">"Âà©ÁõäÁéá(%)"</span>, <span class="string">"Ê∫ÄË∂≥Â∫¶"</span>)
      ) <span class="operator">%&gt;%</span>
      <span class="function">DT::formatCurrency</span>(<span class="string">"revenue"</span>, currency <span class="operator">=</span> <span class="string">"¬•"</span>, mark <span class="operator">=</span> <span class="string">","</span>) <span class="operator">%&gt;%</span>
      <span class="function">DT::formatPercentage</span>(<span class="string">"profit_margin"</span>, digits <span class="operator">=</span> <span class="number">1</span>)
  })
  
  <span class="comment"># „Éá„Éº„Çø„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</span>
  output$download_data <span class="operator">&lt;-</span> <span class="function">downloadHandler</span>(
    filename <span class="operator">=</span> <span class="keyword">function</span>() {
      <span class="function">paste</span>(<span class="string">"‰ºÅÊ•≠„Éá„Éº„Çø_"</span>, <span class="function">Sys.Date</span>(), <span class="string">".csv"</span>, sep <span class="operator">=</span> <span class="string">""</span>)
    },
    content <span class="operator">=</span> <span class="keyword">function</span>(file) {
      <span class="function">write.csv</span>(<span class="function">filtered_data</span>(), file, row.names <span class="operator">=</span> <span class="variable">FALSE</span>)
    }
  )
}

<span class="comment"># „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆÂÆüË°åË®≠ÂÆö</span>
app_config <span class="operator">&lt;-</span> <span class="function">list</span>(
  ui <span class="operator">=</span> dashboard_ui,
  server <span class="operator">=</span> dashboard_server,
  options <span class="operator">=</span> <span class="function">list</span>(port <span class="operator">=</span> <span class="number">3838</span>)
)

<span class="function">print</span>(<span class="string">"Shiny„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅåË®≠ÂÆö„Åï„Çå„Åæ„Åó„Åü"</span>)
<span class="function">print</span>(<span class="string">"ÂÆüË°å„Ç≥„Éû„É≥„Éâ: shinyApp(ui = dashboard_ui, server = dashboard_server)"</span>)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">Shiny„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„ÉâË®≠ÂÆöÁµêÊûú</div>
                <div class="output-content">[1] "Shiny„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅåË®≠ÂÆö„Åï„Çå„Åæ„Åó„Åü"
[1] "ÂÆüË°å„Ç≥„Éû„É≥„Éâ: shinyApp(ui = dashboard_ui, server = dashboard_server)"

# Shiny„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÅÆ‰∏ªË¶ÅÊ©üËÉΩ:
- „É™„Ç¢„É´„Çø„Ç§„É†„Éï„Ç£„É´„Çø„É™„É≥„Ç∞: ÂãïÁöÑ„Éá„Éº„ÇøÁµû„ÇäËæº„Åø
- KPIË°®Á§∫: ÈáçË¶ÅÊåáÊ®ô„ÅÆË¶ñË¶öÁöÑË°®Á§∫
- „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Éó„É≠„ÉÉ„Éà: plotlyÁµ±Âêà
- „Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´: Ê§úÁ¥¢„Éª„ÇΩ„Éº„ÉàÊ©üËÉΩ
- CSV„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ: „Éï„Ç£„É´„ÇøÊ∏à„Åø„Éá„Éº„Çø„ÅÆÂá∫Âäõ

# „É¶„Éº„Ç∂„Éº„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ:
- Ê•≠ÁïåÂà•„Éï„Ç£„É´„Çø
- Â£≤‰∏ä„ÉªÂæìÊ•≠Âì°Êï∞„Çπ„É©„Ç§„ÉÄ„Éº
- „Éà„É¨„É≥„Éâ„É©„Ç§„É≥Ë°®Á§∫Âàá„ÇäÊõø„Åà
- „Çø„Éñ„Éô„Éº„Çπ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥
- „É¨„Çπ„Éù„É≥„Ç∑„Éñ„Éá„Ç∂„Ç§„É≥</div>
            </div>

            <div class="interactive-demo">
                <div class="demo-title">Shiny„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ „Éó„É¨„Éì„É•„Éº</div>
                <div class="demo-content">
                    <div style="display: grid; grid-template-columns: 200px 1fr; gap: 10px; width: 100%; height: 100%;">
                        <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
                        <div style="background: #222d32; padding: 15px; border-radius: 5px;">
                            <div style="color: white; font-size: 0.9rem; margin-bottom: 10px;">
                                <strong>üìä ‰ºÅÊ•≠ÂàÜÊûê</strong>
                            </div>
                            <div style="color: #b3b3b3; font-size: 0.7rem; line-height: 1.4;">
                                ‚Ä¢ Ê¶ÇË¶Å<br>
                                ‚Ä¢ Ë©≥Á¥∞ÂàÜÊûê<br>
                                ‚Ä¢ „Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´<br><br>
                                <strong>„Éï„Ç£„É´„Çø:</strong><br>
                                Ê•≠Áïå: [ÂÖ®„Å¶‚ñº]<br>
                                Â£≤‰∏ä: [0‚îÅ‚îÅ‚îÅ5000]<br>
                                ÂæìÊ•≠Âì°: [1‚îÅ‚îÅ1000]
                            </div>
                        </div>
                        <!-- „É°„Ç§„É≥„Ç®„É™„Ç¢ -->
                        <div style="background: #f4f4f4; padding: 15px; border-radius: 5px;">
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 10px;">
                                <div style="background: #3c8dbc; color: white; padding: 8px; border-radius: 3px; text-align: center; font-size: 0.7rem;">
                                    <div>üìà 200</div>
                                    <div>‰ºÅÊ•≠Êï∞</div>
                                </div>
                                <div style="background: #00a65a; color: white; padding: 8px; border-radius: 3px; text-align: center; font-size: 0.7rem;">
                                    <div>¬•1.2M</div>
                                    <div>Âπ≥ÂùáÂ£≤‰∏ä</div>
                                </div>
                                <div style="background: #f39c12; color: white; padding: 8px; border-radius: 3px; text-align: center; font-size: 0.7rem;">
                                    <div>150‰∫∫</div>
                                    <div>ÂæìÊ•≠Âì°Êï∞</div>
                                </div>
                                <div style="background: #dd4b39; color: white; padding: 8px; border-radius: 3px; text-align: center; font-size: 0.7rem;">
                                    <div>15.2%</div>
                                    <div>Âà©ÁõäÁéá</div>
                                </div>
                            </div>
                            <div style="background: white; padding: 10px; border-radius: 5px; text-align: center; border: 1px solid #ddd;">
                                <div style="color: #3c8dbc; font-weight: bold; margin-bottom: 5px; font-size: 0.8rem;">‰ºÅÊ•≠„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊï£Â∏ÉÂõ≥</div>
                                <div style="color: #999; font-size: 0.7rem;">üìä „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„ÉÅ„É£„Éº„Éà„Ç®„É™„Ç¢</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="data-table">
            <table>
                <thead>
                    <tr>
                        <th>„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÊäÄË°ì</th>
                        <th>ÈÅ©Áî®È†òÂüü</th>
                        <th>‰∏ªË¶ÅÊ©üËÉΩ</th>
                        <th>ÂÆüË£ÖÈõ£ÊòìÂ∫¶</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>plotlyÂ§âÊèõ</td>
                        <td>ÈùôÁöÑ„Ç∞„É©„ÉïÊã°Âºµ</td>
                        <td>„Éõ„Éê„Éº„ÄÅ„Ç∫„Éº„É†„ÄÅ„Éï„Ç£„É´„Çø</td>
                        <td>‰Ωé</td>
                    </tr>
                    <tr>
                        <td>„Ç´„Çπ„Çø„É†„Éú„Çø„É≥</td>
                        <td>„Éá„Éº„ÇøÊìç‰ΩúUI</td>
                        <td>„Çπ„Ç±„Éº„É´Âàá„ÇäÊõø„Åà„ÄÅË°®Á§∫Âà∂Âæ°</td>
                        <td>‰∏≠</td>
                    </tr>
                    <tr>
                        <td>„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥</td>
                        <td>ÊôÇÁ≥ªÂàóË°®Áèæ</td>
                        <td>„Éá„Éº„ÇøÂ§âÂåñ„ÅÆÂãïÁöÑË°®Á§∫</td>
                        <td>‰∏≠</td>
                    </tr>
                    <tr>
                        <td>Shiny„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</td>
                        <td>Web„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥</td>
                        <td>„É™„Ç¢„É´„Çø„Ç§„É†ÂàÜÊûêÁí∞Â¢É</td>
                        <td>È´ò</td>
                    </tr>
                    <tr>
                        <td>„ÇØ„É≠„Çπ„Éï„Ç£„É´„Çø</td>
                        <td>Ë§áÊï∞„ÉÅ„É£„Éº„ÉàÈÄ£Âãï</td>
                        <td>Áµ±ÂêàÁöÑ„Éá„Éº„ÇøÊé¢Á¥¢</td>
                        <td>È´ò</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="key-points">
            <h4>Á¨¨14Á´†„ÅÆÈáçË¶Å„Éù„Ç§„É≥„Éà</h4>
            <ul>
                <li><strong>ggplotlyÂ§âÊèõ</strong>ÔºöÈùôÁöÑ„Ç∞„É©„Éï„ÅÆÁ∞°Âçò„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÂåñ</li>
                <li><strong>„Ç´„Çπ„Çø„É†Ê©üËÉΩ</strong>Ôºö„Éú„Çø„É≥„ÄÅ„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥„ÄÅ„Çπ„É©„Ç§„ÉÄ„Éº„ÅÆËøΩÂä†</li>
                <li><strong>„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥</strong>ÔºöÊôÇÁ≥ªÂàó„Éá„Éº„Çø„ÅÆÂãïÁöÑÂèØË¶ñÂåñ</li>
                <li><strong>ShinyÁµ±Âêà</strong>ÔºöWeb„Éô„Éº„Çπ„ÅÆ„É™„Ç¢„É´„Çø„Ç§„É†„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</li>
                <li><strong>„É¶„Éº„Ç∂„Éì„É™„ÉÜ„Ç£</strong>ÔºöÁõ¥ÊÑüÁöÑÊìç‰Ωú„Å´„Çà„ÇãÊé¢Á¥¢ÁöÑ„Éá„Éº„ÇøÂàÜÊûê</li>
                <li><strong>„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ</strong>ÔºöÂ§ßÂÆπÈáè„Éá„Éº„Çø„ÅÆÂäπÁéáÁöÑ„É¨„É≥„ÉÄ„É™„É≥„Ç∞</li>
            </ul>
        </div>

        <div class="tip-box">
            <h4>ÂÆüË∑µÁöÑ„Ç¢„Éâ„Éê„Ç§„Çπ</h4>
            <p>„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÂèØË¶ñÂåñ„ÅØ„ÄÅ„É¶„Éº„Ç∂„Éº„Åå„Éá„Éº„Çø„Å®ÂØæË©±„Åô„Çã„Åì„Å®„ÅßÊñ∞„Åü„Å™Ê¥ûÂØü„ÇíÁô∫Ë¶ã„Åß„Åç„ÇãÂº∑Âäõ„Å™ÊâãÊ≥ï„Åß„Åô„ÄÇplotly„ÅØÊó¢Â≠ò„ÅÆggplot2„Ç≥„Éº„Éâ„ÇíÊ¥ªÁî®„Åó„Å™„Åå„ÇâÊÆµÈöéÁöÑ„Å´„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñË¶ÅÁ¥†„ÇíËøΩÂä†„Åß„Åç„Çã„Åü„ÇÅ„ÄÅÂ≠¶Áøí„Ç≥„Çπ„Éà„ÇíÊäë„Åà„Å¶È´òÂ∫¶„Å™Ê©üËÉΩ„ÇíÂÆüÁèæ„Åß„Åç„Åæ„Åô„ÄÇShiny„Å®„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ„Å´„Çà„Çä„ÄÅ„Ç®„É≥„Éâ„É¶„Éº„Ç∂„ÉºÂêë„Åë„ÅÆÊú¨Ê†ºÁöÑ„Å™ÂàÜÊûê„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇÇÊßãÁØâÂèØËÉΩ„Åß„Åô„ÄÇ</p>
        </div>

        <nav class="chapter-nav">
            <a href="chapter13-advanced-ggplot2.html" class="nav-button">‚Üê Á¨¨13Á´†</a>
            <a href="chapter15-advanced-data-viz.html" class="nav-button">Á¨¨15Á´† ‚Üí</a>
        </nav>
    </div>
</body>
</html>