<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬14ç« : ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¯è¦–åŒ–ã¨plotly | Tidyverseå®Œå…¨ãƒã‚¹ã‚¿ãƒ¼</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --accent-neon: #00ff88;
            --accent-cyan: #00d4ff;
            --accent-purple: #9d4edd;
            --accent-violet: #8b5cf6;
            --accent-indigo: #6366f1;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --border-neon: #00ff88;
            --shadow-neon: 0 0 20px #00ff8840;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: linear-gradient(45deg, var(--bg-secondary), var(--bg-tertiary));
            border-radius: 20px;
            border: 2px solid var(--accent-violet);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.4);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.1), transparent);
            animation: scan 3s infinite;
        }

        @keyframes scan {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        h1 {
            font-size: 3rem;
            font-weight: 700;
            color: var(--accent-violet);
            margin-bottom: 10px;
            text-shadow: 0 0 20px var(--accent-violet);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.4rem;
            color: var(--accent-cyan);
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .chapter-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            position: relative;
            z-index: 1;
        }

        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: 3px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .progress-dot {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            border: 1px solid var(--text-secondary);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--accent-violet);
            border-color: var(--accent-violet);
            box-shadow: 0 0 5px var(--accent-violet);
        }

        .progress-dot.completed {
            background: var(--accent-cyan);
            border-color: var(--accent-cyan);
        }

        /* Navigation Widget */
        .chapter-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 3px;
            margin: 30px 0;
            padding: 6px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--accent-violet);
            width: fit-content;
            max-width: 90vw;
            margin-left: auto;
            margin-right: auto;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 1px 5px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            text-decoration: none;
            border-radius: 2px;
            border: 1px solid var(--accent-cyan);
            transition: all 0.3s ease;
            font-size: 0.65rem;
            white-space: nowrap;
        }

        .nav-button:hover {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            box-shadow: 0 0 6px var(--accent-cyan);
        }

        .nav-button.current {
            background: var(--accent-violet);
            color: var(--bg-primary);
            box-shadow: 0 0 6px var(--accent-violet);
        }

        /* Content Sections */
        .section {
            background: var(--bg-secondary);
            margin: 30px 0;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid var(--accent-purple);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-violet), var(--accent-cyan), var(--accent-purple));
            border-radius: 15px 15px 0 0;
        }

        h2 {
            color: var(--accent-violet);
            font-size: 2rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--accent-violet);
        }

        h3 {
            color: var(--accent-cyan);
            font-size: 1.5rem;
            margin: 25px 0 15px 0;
            text-shadow: 0 0 8px var(--accent-cyan);
        }

        h4 {
            color: var(--accent-purple);
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
        }

        /* Code Blocks */
        .code-container {
            margin: 20px 0;
            background: #1a1a1a;
            border-radius: 10px;
            border: 1px solid var(--accent-violet);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.1);
        }

        .code-header {
            background: var(--accent-violet);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-header::before {
            content: 'ğŸ®';
            font-size: 1.1rem;
        }

        .code-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            background: #0d1117;
            color: #c9d1d9;
            overflow-x: auto;
        }

        /* Syntax highlighting */
        .keyword { color: #ff7b72; }
        .function { color: #d2a8ff; }
        .string { color: #a5d6ff; }
        .comment { color: #8b949e; font-style: italic; }
        .operator { color: #f85149; }
        .number { color: #79c0ff; }
        .variable { color: #ffa657; }

        /* Output Display */
        .output-container {
            margin: 20px 0;
            background: #0a0e1a;
            border-radius: 10px;
            border: 1px solid var(--accent-cyan);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.1);
        }

        .output-header {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .output-header::before {
            content: 'âš¡';
        }

        .output-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--accent-cyan);
        }

        /* Interactive Features */
        .interactive-demo {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--accent-indigo);
        }

        .demo-title {
            color: var(--accent-indigo);
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .demo-content {
            background: var(--bg-primary);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--accent-indigo);
            position: relative;
            overflow: hidden;
        }

        .demo-placeholder {
            color: var(--accent-indigo);
            font-style: italic;
            font-size: 1rem;
        }

        /* Interactive Controls */
        .control-panel {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border: 1px solid var(--accent-violet);
        }

        .control-title {
            color: var(--accent-violet);
            font-size: 1rem;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .control-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .control-button {
            padding: 5px 10px;
            background: var(--accent-indigo);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .control-button:hover {
            background: var(--accent-violet);
            transform: translateY(-1px);
        }

        .control-slider {
            flex: 1;
            min-width: 100px;
        }

        /* plotly Features */
        .plotly-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid var(--accent-purple);
        }

        .feature-title {
            color: var(--accent-purple);
            font-size: 1.1rem;
            margin-bottom: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feature-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .feature-example {
            background: var(--bg-primary);
            padding: 10px;
            border-radius: 5px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: var(--accent-cyan);
            border: 1px solid var(--accent-purple);
        }

        /* Data Tables */
        .data-table {
            margin: 20px 0;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-tertiary);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid var(--accent-violet);
        }

        th {
            background: var(--accent-violet);
            color: var(--bg-primary);
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--bg-secondary);
            color: var(--text-primary);
        }

        tr:nth-child(even) {
            background: rgba(139, 92, 246, 0.05);
        }

        tr:hover {
            background: rgba(139, 92, 246, 0.1);
        }

        /* Key Points */
        .key-points {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(0, 212, 255, 0.1) 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-violet);
        }

        .key-points h4 {
            color: var(--accent-violet);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .key-points h4::before {
            content: 'ğŸ’¡';
        }

        .key-points ul {
            list-style: none;
            padding-left: 0;
        }

        .key-points li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .key-points li::before {
            content: 'â–¶';
            color: var(--accent-cyan);
            position: absolute;
            left: 0;
        }

        /* Warning/Tip boxes */
        .tip-box {
            background: rgba(157, 78, 221, 0.1);
            border: 1px solid var(--accent-purple);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-purple);
        }

        .tip-box h4 {
            color: var(--accent-purple);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tip-box h4::before {
            content: 'âš ï¸';
        }

        /* Animation for interactive elements */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .interactive-element {
            animation: pulse 2s infinite;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }

            .chapter-meta {
                flex-direction: column;
                gap: 10px;
            }

            .chapter-nav {
                gap: 2px;
                padding: 4px;
            }

            .nav-button {
                padding: 1px 3px;
                font-size: 0.6rem;
            }

            .section {
                padding: 20px;
                margin: 20px 0;
            }

            h2 {
                font-size: 1.5rem;
            }

            .plotly-features {
                grid-template-columns: 1fr;
            }

            .code-content, .output-content {
                font-size: 0.85rem;
                padding: 15px;
            }

            .control-group {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ç¬¬14ç« : ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¯è¦–åŒ–</h1>
            <p class="subtitle">plotlyã¨Shinyã«ã‚ˆã‚‹å‹•çš„ãƒ‡ãƒ¼ã‚¿æ¢ç´¢</p>
            <div class="chapter-meta">
                <span>ğŸ® ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–</span>
                <span>ğŸ“Š plotlyé€£æº</span>
                <span>âš¡ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ </span>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>
        </header>

        <nav class="chapter-nav">
            <a href="chapter1-tidyverse-overview.html" class="nav-button">1</a>
            <a href="chapter2-dplyr-data-manipulation.html" class="nav-button">2</a>
            <a href="chapter3-ggplot2-visualization.html" class="nav-button">3</a>
            <a href="chapter4-tidyr-data-reshaping.html" class="nav-button">4</a>
            <a href="chapter5-stringr-text-processing.html" class="nav-button">5</a>
            <a href="chapter6-forcats-purrr-advanced.html" class="nav-button">6</a>
            <a href="chapter7-lubridate-datetime.html" class="nav-button">7</a>
            <a href="chapter8-readr-data-import.html" class="nav-button">8</a>
            <a href="chapter9-tibble-modern-dataframe.html" class="nav-button">9</a>
            <a href="chapter10-statistics-modeling.html" class="nav-button">10</a>
            <a href="chapter11-machine-learning.html" class="nav-button">11</a>
            <a href="chapter12-time-series.html" class="nav-button">12</a>
            <a href="chapter13-advanced-ggplot2.html" class="nav-button">13</a>
            <a href="#" class="nav-button current">14</a>
            <a href="chapter15-advanced-data-viz.html" class="nav-button">15</a>
        </nav>

        <section class="section">
            <h2>ğŸ® plotlyã«ã‚ˆã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¯è¦–åŒ–</h2>
            
            <p>plotlyã¯ã€ggplot2ã§ä½œæˆã—ãŸã‚°ãƒ©ãƒ•ã‚’ç°¡å˜ã«ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«å¤‰æ›ã§ãã‚‹å¼·åŠ›ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã™ã€‚ã‚ºãƒ¼ãƒ ã€ãƒ‘ãƒ³ã€ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãªã©ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã§ãã¾ã™ã€‚</p>

            <h3>ggplot2ã‹ã‚‰plotlyã¸ã®å¤‰æ›</h3>

            <div class="code-container">
                <div class="code-header">åŸºæœ¬çš„ãªplotlyå¤‰æ›</div>
                <div class="code-content">
<span class="keyword">library</span>(<span class="string">plotly</span>)
<span class="keyword">library</span>(<span class="string">ggplot2</span>)
<span class="keyword">library</span>(<span class="string">dplyr</span>)
<span class="keyword">library</span>(<span class="string">htmlwidgets</span>)

<span class="comment"># ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–åˆ†æç”¨ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ</span>
<span class="function">set.seed</span>(<span class="number">123</span>)
interactive_data <span class="operator">&lt;-</span> <span class="function">tibble</span>(
  company_id <span class="operator">=</span> <span class="number">1</span>:<span class="number">200</span>,
  company_name <span class="operator">=</span> <span class="function">paste0</span>(<span class="string">"ä¼æ¥­"</span>, <span class="function">sprintf</span>(<span class="string">"%03d"</span>, <span class="number">1</span>:<span class="number">200</span>)),
  industry <span class="operator">=</span> <span class="function">sample</span>(<span class="function">c</span>(<span class="string">"IT"</span>, <span class="string">"è£½é€ æ¥­"</span>, <span class="string">"é‡‘è"</span>, <span class="string">"å°å£²"</span>, <span class="string">"ã‚µãƒ¼ãƒ“ã‚¹"</span>), <span class="number">200</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>),
  revenue <span class="operator">=</span> <span class="function">round</span>(<span class="function">rlnorm</span>(<span class="number">200</span>, <span class="function">log</span>(<span class="number">1000</span>), <span class="number">1</span>)),
  employees <span class="operator">=</span> <span class="function">round</span>(<span class="function">rlnorm</span>(<span class="number">200</span>, <span class="function">log</span>(<span class="number">100</span>), <span class="number">0.8</span>)),
  profit_margin <span class="operator">=</span> <span class="function">round</span>(<span class="function">rnorm</span>(<span class="number">200</span>, <span class="number">15</span>, <span class="number">8</span>), <span class="number">1</span>),
  satisfaction <span class="operator">=</span> <span class="function">round</span>(<span class="function">rnorm</span>(<span class="number">200</span>, <span class="number">4.0</span>, <span class="number">0.8</span>), <span class="number">1</span>),
  founded_year <span class="operator">=</span> <span class="function">sample</span>(<span class="number">1980</span>:<span class="number">2020</span>, <span class="number">200</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>)
) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    revenue_per_employee <span class="operator">=</span> <span class="function">round</span>(revenue / employees <span class="operator">*</span> <span class="number">10</span>, <span class="number">1</span>),
    company_age <span class="operator">=</span> <span class="number">2023</span> <span class="operator">-</span> founded_year,
    size_category <span class="operator">=</span> <span class="function">case_when</span>(
      employees <span class="operator">&lt;</span> <span class="number">50</span> ~ <span class="string">"å°ä¼æ¥­"</span>,
      employees <span class="operator">&lt;</span> <span class="number">200</span> ~ <span class="string">"ä¸­ä¼æ¥­"</span>,
      <span class="variable">TRUE</span> ~ <span class="string">"å¤§ä¼æ¥­"</span>
    ),
    <span class="comment"># ã‚«ã‚¹ã‚¿ãƒ ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ç”¨ã®ãƒ†ã‚­ã‚¹ãƒˆ</span>
    tooltip_text <span class="operator">=</span> <span class="function">paste0</span>(
      <span class="string">"ä¼šç¤¾å: "</span>, company_name, <span class="string">"&lt;br&gt;"</span>,
      <span class="string">"æ¥­ç•Œ: "</span>, industry, <span class="string">"&lt;br&gt;"</span>,
      <span class="string">"å£²ä¸Š: Â¥"</span>, <span class="function">format</span>(revenue, big.mark <span class="operator">=</span> <span class="string">","</span>), <span class="string">"M&lt;br&gt;"</span>,
      <span class="string">"å¾“æ¥­å“¡æ•°: "</span>, <span class="function">format</span>(employees, big.mark <span class="operator">=</span> <span class="string">","</span>), <span class="string">"äºº&lt;br&gt;"</span>,
      <span class="string">"åˆ©ç›Šç‡: "</span>, profit_margin, <span class="string">"%&lt;br&gt;"</span>,
      <span class="string">"è¨­ç«‹å¹´: "</span>, founded_year, <span class="string">"å¹´"</span>
    )
  )

<span class="comment"># 1. åŸºæœ¬çš„ãªggplot2ã‹ã‚‰plotlyã¸ã®å¤‰æ›</span>
basic_ggplot <span class="operator">&lt;-</span> interactive_data <span class="operator">%&gt;%</span>
  <span class="function">ggplot</span>(<span class="function">aes</span>(x <span class="operator">=</span> revenue, y <span class="operator">=</span> profit_margin, color <span class="operator">=</span> industry,
             size <span class="operator">=</span> employees, text <span class="operator">=</span> tooltip_text)) <span class="operator">+</span>
  <span class="function">geom_point</span>(alpha <span class="operator">=</span> <span class="number">0.7</span>) <span class="operator">+</span>
  <span class="function">scale_x_log10</span>(labels <span class="operator">=</span> <span class="function">scales::label_currency</span>(prefix <span class="operator">=</span> <span class="string">"Â¥"</span>, suffix <span class="operator">=</span> <span class="string">"M"</span>)) <span class="operator">+</span>
  <span class="function">scale_size_continuous</span>(range <span class="operator">=</span> <span class="function">c</span>(<span class="number">3</span>, <span class="number">15</span>), guide <span class="operator">=</span> <span class="string">"none"</span>) <span class="operator">+</span>
  <span class="function">labs</span>(
    title <span class="operator">=</span> <span class="string">"ä¼æ¥­åˆ†æ: å£²ä¸Š vs åˆ©ç›Šç‡"</span>,
    subtitle <span class="operator">=</span> <span class="string">"æ¥­ç•Œåˆ¥ãƒ»è¦æ¨¡åˆ¥ã®ä¼æ¥­ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒ"</span>,
    x <span class="operator">=</span> <span class="string">"å£²ä¸Šé«˜ï¼ˆç™¾ä¸‡å††ï¼‰"</span>,
    y <span class="operator">=</span> <span class="string">"åˆ©ç›Šç‡ï¼ˆ%ï¼‰"</span>,
    color <span class="operator">=</span> <span class="string">"æ¥­ç•Œ"</span>
  ) <span class="operator">+</span>
  <span class="function">theme_minimal</span>() <span class="operator">+</span>
  <span class="function">theme</span>(
    plot.title <span class="operator">=</span> <span class="function">element_text</span>(size <span class="operator">=</span> <span class="number">16</span>, face <span class="operator">=</span> <span class="string">"bold"</span>),
    plot.subtitle <span class="operator">=</span> <span class="function">element_text</span>(size <span class="operator">=</span> <span class="number">12</span>),
    legend.position <span class="operator">=</span> <span class="string">"bottom"</span>
  )

<span class="comment"># plotlyã«å¤‰æ›</span>
interactive_plot <span class="operator">&lt;-</span> <span class="function">ggplotly</span>(
  basic_ggplot,
  tooltip <span class="operator">=</span> <span class="string">"text"</span>,  <span class="comment"># ã‚«ã‚¹ã‚¿ãƒ ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã‚’ä½¿ç”¨</span>
  width <span class="operator">=</span> <span class="number">800</span>,
  height <span class="operator">=</span> <span class="number">600</span>
) <span class="operator">%&gt;%</span>
  <span class="function">layout</span>(
    title <span class="operator">=</span> <span class="function">list</span>(
      text <span class="operator">=</span> <span class="string">"ä¼æ¥­åˆ†æ: å£²ä¸Š vs åˆ©ç›Šç‡&lt;br&gt;&lt;sub&gt;ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ - ã‚¯ãƒªãƒƒã‚¯ãƒ»ãƒ‰ãƒ©ãƒƒã‚°ã§æ“ä½œå¯èƒ½&lt;/sub&gt;"</span>,
      font <span class="operator">=</span> <span class="function">list</span>(size <span class="operator">=</span> <span class="number">16</span>)
    ),
    hovermode <span class="operator">=</span> <span class="string">"closest"</span>,
    showlegend <span class="operator">=</span> <span class="variable">TRUE</span>
  ) <span class="operator">%&gt;%</span>
  <span class="function">config</span>(
    displayModeBar <span class="operator">=</span> <span class="variable">TRUE</span>,
    modeBarButtonsToRemove <span class="operator">=</span> <span class="function">c</span>(<span class="string">"lasso2d"</span>, <span class="string">"select2d"</span>),
    displaylogo <span class="operator">=</span> <span class="variable">FALSE</span>,
    toImageButtonOptions <span class="operator">=</span> <span class="function">list</span>(
      format <span class="operator">=</span> <span class="string">"png"</span>,
      filename <span class="operator">=</span> <span class="string">"ä¼æ¥­åˆ†æãƒãƒ£ãƒ¼ãƒˆ"</span>,
      width <span class="operator">=</span> <span class="number">1200</span>,
      height <span class="operator">=</span> <span class="number">800</span>
    )
  )

<span class="function">print</span>(<span class="string">"åŸºæœ¬çš„ãªã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒƒãƒˆãŒä½œæˆã•ã‚Œã¾ã—ãŸ"</span>)

<span class="comment"># 2. é«˜åº¦ãªã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ©Ÿèƒ½</span>
<span class="comment"># è¤‡æ•°ã®ã‚µãƒ–ãƒ—ãƒ­ãƒƒãƒˆã‚’æŒã¤ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</span>
subplot_data <span class="operator">&lt;-</span> interactive_data <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(industry, size_category) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    avg_revenue <span class="operator">=</span> <span class="function">mean</span>(revenue),
    avg_profit_margin <span class="operator">=</span> <span class="function">mean</span>(profit_margin),
    count <span class="operator">=</span> <span class="function">n</span>(),
    .groups <span class="operator">=</span> <span class="string">'drop'</span>
  )

<span class="comment"># ã‚µãƒ–ãƒ—ãƒ­ãƒƒãƒˆ1: æ¥­ç•Œåˆ¥å¹³å‡å£²ä¸Š</span>
p1 <span class="operator">&lt;-</span> subplot_data <span class="operator">%&gt;%</span>
  <span class="function">plot_ly</span>(
    x <span class="operator">=</span> ~industry,
    y <span class="operator">=</span> ~avg_revenue,
    color <span class="operator">=</span> ~size_category,
    type <span class="operator">=</span> <span class="string">"bar"</span>,
    text <span class="operator">=</span> ~<span class="function">paste0</span>(<span class="string">"Â¥"</span>, <span class="function">round</span>(avg_revenue), <span class="string">"M"</span>),
    textposition <span class="operator">=</span> <span class="string">"outside"</span>,
    hovertemplate <span class="operator">=</span> <span class="string">"&lt;b&gt;%{x}&lt;/b&gt;&lt;br&gt;ä¼æ¥­è¦æ¨¡: %{fullData.name}&lt;br&gt;å¹³å‡å£²ä¸Š: Â¥%{y:.0f}M&lt;extra&gt;&lt;/extra&gt;"</span>
  ) <span class="operator">%&gt;%</span>
  <span class="function">layout</span>(
    title <span class="operator">=</span> <span class="string">"æ¥­ç•Œãƒ»è¦æ¨¡åˆ¥å¹³å‡å£²ä¸Š"</span>,
    xaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"æ¥­ç•Œ"</span>),
    yaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"å¹³å‡å£²ä¸Šï¼ˆç™¾ä¸‡å††ï¼‰"</span>)
  )

<span class="comment"># ã‚µãƒ–ãƒ—ãƒ­ãƒƒãƒˆ2: è¦æ¨¡åˆ¥åˆ©ç›Šç‡åˆ†å¸ƒ</span>
p2 <span class="operator">&lt;-</span> interactive_data <span class="operator">%&gt;%</span>
  <span class="function">plot_ly</span>(
    y <span class="operator">=</span> ~profit_margin,
    color <span class="operator">=</span> ~size_category,
    type <span class="operator">=</span> <span class="string">"box"</span>,
    boxpoints <span class="operator">=</span> <span class="string">"outliers"</span>
  ) <span class="operator">%&gt;%</span>
  <span class="function">layout</span>(
    title <span class="operator">=</span> <span class="string">"ä¼æ¥­è¦æ¨¡åˆ¥åˆ©ç›Šç‡åˆ†å¸ƒ"</span>,
    xaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"ä¼æ¥­è¦æ¨¡"</span>),
    yaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"åˆ©ç›Šç‡ï¼ˆ%ï¼‰"</span>)
  )

<span class="comment"># ã‚µãƒ–ãƒ—ãƒ­ãƒƒãƒˆ3: æ™‚ç³»åˆ—ãƒˆãƒ¬ãƒ³ãƒ‰</span>
trend_data <span class="operator">&lt;-</span> interactive_data <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(founded_year, industry) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(new_companies <span class="operator">=</span> <span class="function">n</span>(), .groups <span class="operator">=</span> <span class="string">'drop'</span>) <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(founded_year <span class="operator">&gt;=</span> <span class="number">2000</span>)

p3 <span class="operator">&lt;-</span> trend_data <span class="operator">%&gt;%</span>
  <span class="function">plot_ly</span>(
    x <span class="operator">=</span> ~founded_year,
    y <span class="operator">=</span> ~new_companies,
    color <span class="operator">=</span> ~industry,
    type <span class="operator">=</span> <span class="string">"scatter"</span>,
    mode <span class="operator">=</span> <span class="string">"lines+markers"</span>,
    line <span class="operator">=</span> <span class="function">list</span>(width <span class="operator">=</span> <span class="number">3</span>),
    marker <span class="operator">=</span> <span class="function">list</span>(size <span class="operator">=</span> <span class="number">8</span>)
  ) <span class="operator">%&gt;%</span>
  <span class="function">layout</span>(
    title <span class="operator">=</span> <span class="string">"æ¥­ç•Œåˆ¥ä¼æ¥­è¨­ç«‹ãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆ2000å¹´ä»¥é™ï¼‰"</span>,
    xaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"è¨­ç«‹å¹´"</span>),
    yaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"æ–°è¨­ä¼æ¥­æ•°"</span>)
  )

<span class="comment"># ã‚µãƒ–ãƒ—ãƒ­ãƒƒãƒˆã‚’çµ„ã¿åˆã‚ã›</span>
combined_dashboard <span class="operator">&lt;-</span> <span class="function">subplot</span>(
  p1, p2, p3,
  nrows <span class="operator">=</span> <span class="number">3</span>,
  heights <span class="operator">=</span> <span class="function">c</span>(<span class="number">0.35</span>, <span class="number">0.3</span>, <span class="number">0.35</span>),
  titleY <span class="operator">=</span> <span class="variable">TRUE</span>,
  titleX <span class="operator">=</span> <span class="variable">TRUE</span>
) <span class="operator">%&gt;%</span>
  <span class="function">layout</span>(
    title <span class="operator">=</span> <span class="string">"ä¼æ¥­åˆ†æçµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰"</span>,
    showlegend <span class="operator">=</span> <span class="variable">TRUE</span>,
    height <span class="operator">=</span> <span class="number">900</span>
  )

<span class="function">print</span>(<span class="string">"çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãŒä½œæˆã•ã‚Œã¾ã—ãŸ"</span>)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">plotlyã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–åŒ–çµæœ</div>
                <div class="output-content">[1] "åŸºæœ¬çš„ãªã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒƒãƒˆãŒä½œæˆã•ã‚Œã¾ã—ãŸ"
[1] "çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãŒä½œæˆã•ã‚Œã¾ã—ãŸ"

# plotlyã®ä¸»è¦æ©Ÿèƒ½:
- ãƒ›ãƒãƒ¼ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—: è©³ç´°æƒ…å ±ã®è¡¨ç¤º
- ã‚ºãƒ¼ãƒ ãƒ»ãƒ‘ãƒ³: è‡ªç”±ãªç¯„å›²é¸æŠã¨ç§»å‹•
- ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰æ“ä½œ: ãƒ‡ãƒ¼ã‚¿ç³»åˆ—ã®è¡¨ç¤º/éè¡¨ç¤º
- ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆé¸æŠ: ã‚¯ãƒªãƒƒã‚¯ã«ã‚ˆã‚‹å€‹åˆ¥é¸æŠ
- ç”»åƒã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ: PNG/SVGå½¢å¼ã§ã®ä¿å­˜

# ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ§‹æˆ:
- è¤‡æ•°ãƒãƒ£ãƒ¼ãƒˆã®çµ±åˆè¡¨ç¤º
- çµ±ä¸€ã•ã‚ŒãŸã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
- ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªå‡¡ä¾‹é€£å‹•
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</div>
            </div>

            <div class="interactive-demo">
                <div class="demo-title">plotlyã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ©Ÿèƒ½ãƒ‡ãƒ¢</div>
                <div class="demo-content">
                    <div class="interactive-element">
                        <p class="demo-placeholder">ğŸ® ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚°ãƒ©ãƒ•ã‚¨ãƒªã‚¢</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">
                            ã“ã“ã«å®Ÿéš›ã®plotlyã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã¾ã™<br>
                            â€¢ ãƒã‚¦ã‚¹ãƒ›ãƒãƒ¼ã§è©³ç´°æƒ…å ±<br>
                            â€¢ ãƒ‰ãƒ©ãƒƒã‚°ã§ã‚ºãƒ¼ãƒ ãƒ»ãƒ‘ãƒ³<br>
                            â€¢ ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§ãƒªã‚»ãƒƒãƒˆ<br>
                            â€¢ å‡¡ä¾‹ã‚¯ãƒªãƒƒã‚¯ã§ç³»åˆ—åˆ‡ã‚Šæ›¿ãˆ
                        </p>
                    </div>
                </div>
                <div class="control-panel">
                    <div class="control-title">ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«</div>
                    <div class="control-group">
                        <button class="control-button" onclick="alert('ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½')">ãƒ•ã‚£ãƒ«ã‚¿</button>
                        <button class="control-button" onclick="alert('ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½')">ã‚½ãƒ¼ãƒˆ</button>
                        <button class="control-button" onclick="alert('ãƒãƒ£ãƒ¼ãƒˆåˆ‡ã‚Šæ›¿ãˆ')">ãƒãƒ£ãƒ¼ãƒˆç¨®åˆ¥</button>
                        <input type="range" class="control-slider" min="1" max="100" value="50">
                        <span style="color: var(--text-secondary); font-size: 0.8rem;">é€æ˜åº¦èª¿æ•´</span>
                    </div>
                </div>
            </div>

            <h3>ã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³</h3>

            <div class="code-container">
                <div class="code-header">é«˜åº¦ãªã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³</div>
                <div class="code-content">
<span class="comment"># ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¿ãƒ³ã¨ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚’å«ã‚€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒ£ãƒ¼ãƒˆ</span>
create_advanced_interactive <span class="operator">&lt;-</span> <span class="keyword">function</span>(data) {
  
  <span class="comment"># ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒœã‚¿ãƒ³ã®è¨­å®š</span>
  transform_buttons <span class="operator">&lt;-</span> <span class="function">list</span>(
    <span class="function">list</span>(
      method <span class="operator">=</span> <span class="string">"restyle"</span>,
      args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"transforms[0].value"</span>, <span class="string">"linear"</span>),
      label <span class="operator">=</span> <span class="string">"ç·šå½¢ã‚¹ã‚±ãƒ¼ãƒ«"</span>
    ),
    <span class="function">list</span>(
      method <span class="operator">=</span> <span class="string">"relayout"</span>,
      args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"xaxis.type"</span>, <span class="string">"log"</span>),
      label <span class="operator">=</span> <span class="string">"å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«"</span>
    )
  )
  
  <span class="comment"># ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®å¹´åº¦åˆ¥ãƒ‡ãƒ¼ã‚¿</span>
  animation_data <span class="operator">&lt;-</span> data <span class="operator">%&gt;%</span>
    <span class="function">mutate</span>(frame <span class="operator">=</span> <span class="function">cut</span>(founded_year, breaks <span class="operator">=</span> <span class="number">5</span>, labels <span class="operator">=</span> <span class="function">c</span>(<span class="string">"1980-1988"</span>, <span class="string">"1989-1996"</span>, <span class="string">"1997-2004"</span>, <span class="string">"2005-2012"</span>, <span class="string">"2013-2020"</span>)))
  
  <span class="comment"># ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ãƒƒãƒˆ</span>
  p <span class="operator">&lt;-</span> animation_data <span class="operator">%&gt;%</span>
    <span class="function">plot_ly</span>(
      x <span class="operator">=</span> ~revenue,
      y <span class="operator">=</span> ~employees,
      size <span class="operator">=</span> ~profit_margin,
      color <span class="operator">=</span> ~industry,
      frame <span class="operator">=</span> ~frame,
      ids <span class="operator">=</span> ~company_id,
      text <span class="operator">=</span> ~company_name,
      type <span class="operator">=</span> <span class="string">"scatter"</span>,
      mode <span class="operator">=</span> <span class="string">"markers"</span>,
      marker <span class="operator">=</span> <span class="function">list</span>(
        sizemode <span class="operator">=</span> <span class="string">"diameter"</span>,
        sizeref <span class="operator">=</span> <span class="number">2</span>,
        sizemin <span class="operator">=</span> <span class="number">4</span>,
        line <span class="operator">=</span> <span class="function">list</span>(width <span class="operator">=</span> <span class="number">2</span>, color <span class="operator">=</span> <span class="string">"white"</span>)
      ),
      hovertemplate <span class="operator">=</span> <span class="string">"&lt;b&gt;%{text}&lt;/b&gt;&lt;br&gt;å£²ä¸Š: Â¥%{x:,.0f}M&lt;br&gt;å¾“æ¥­å“¡: %{y:,.0f}äºº&lt;br&gt;åˆ©ç›Šç‡: %{marker.size:.1f}%&lt;extra&gt;&lt;/extra&gt;"</span>
    ) <span class="operator">%&gt;%</span>
    
    <span class="comment"># ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®š</span>
    <span class="function">layout</span>(
      title <span class="operator">=</span> <span class="function">list</span>(
        text <span class="operator">=</span> <span class="string">"ä¼æ¥­ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æï¼ˆæ™‚ä»£åˆ¥ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰"</span>,
        x <span class="operator">=</span> <span class="number">0.5</span>
      ),
      xaxis <span class="operator">=</span> <span class="function">list</span>(
        title <span class="operator">=</span> <span class="string">"å£²ä¸Šé«˜ï¼ˆç™¾ä¸‡å††ï¼‰"</span>,
        type <span class="operator">=</span> <span class="string">"linear"</span>,
        range <span class="operator">=</span> <span class="function">c</span>(<span class="number">0</span>, <span class="function">max</span>(data$revenue) <span class="operator">*</span> <span class="number">1.1</span>)
      ),
      yaxis <span class="operator">=</span> <span class="function">list</span>(
        title <span class="operator">=</span> <span class="string">"å¾“æ¥­å“¡æ•°ï¼ˆäººï¼‰"</span>,
        range <span class="operator">=</span> <span class="function">c</span>(<span class="number">0</span>, <span class="function">max</span>(data$employees) <span class="operator">*</span> <span class="number">1.1</span>)
      ),
      
      <span class="comment"># ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¿ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼</span>
      updatemenus <span class="operator">=</span> <span class="function">list</span>(
        <span class="function">list</span>(
          type <span class="operator">=</span> <span class="string">"buttons"</span>,
          direction <span class="operator">=</span> <span class="string">"left"</span>,
          x <span class="operator">=</span> <span class="number">0.1</span>,
          y <span class="operator">=</span> <span class="number">1.15</span>,
          buttons <span class="operator">=</span> <span class="function">list</span>(
            <span class="function">list</span>(
              method <span class="operator">=</span> <span class="string">"relayout"</span>,
              args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"xaxis.type"</span>, <span class="string">"linear"</span>),
              label <span class="operator">=</span> <span class="string">"ç·šå½¢"</span>
            ),
            <span class="function">list</span>(
              method <span class="operator">=</span> <span class="string">"relayout"</span>,
              args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"xaxis.type"</span>, <span class="string">"log"</span>),
              label <span class="operator">=</span> <span class="string">"å¯¾æ•°"</span>
            )
          )
        ),
        
        <span class="comment"># æ¥­ç•Œãƒ•ã‚£ãƒ«ã‚¿</span>
        <span class="function">list</span>(
          type <span class="operator">=</span> <span class="string">"dropdown"</span>,
          x <span class="operator">=</span> <span class="number">0.5</span>,
          y <span class="operator">=</span> <span class="number">1.15</span>,
          buttons <span class="operator">=</span> <span class="function">c</span>(
            <span class="function">list</span>(<span class="function">list</span>(method <span class="operator">=</span> <span class="string">"restyle"</span>, args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"visible"</span>, <span class="variable">TRUE</span>), label <span class="operator">=</span> <span class="string">"ã™ã¹ã¦è¡¨ç¤º"</span>)),
            <span class="function">lapply</span>(<span class="function">unique</span>(data$industry), <span class="keyword">function</span>(ind) {
              visible <span class="operator">&lt;-</span> data$industry <span class="operator">==</span> ind
              <span class="function">list</span>(method <span class="operator">=</span> <span class="string">"restyle"</span>, args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"visible"</span>, visible), label <span class="operator">=</span> ind)
            })
          )
        )
      ),
      
      <span class="comment"># ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š</span>
      sliders <span class="operator">=</span> <span class="function">list</span>(
        <span class="function">list</span>(
          active <span class="operator">=</span> <span class="number">0</span>,
          currentvalue <span class="operator">=</span> <span class="function">list</span>(prefix <span class="operator">=</span> <span class="string">"æ™‚ä»£: "</span>),
          steps <span class="operator">=</span> <span class="function">lapply</span>(<span class="function">unique</span>(animation_data$frame), <span class="keyword">function</span>(f) {
            <span class="function">list</span>(
              args <span class="operator">=</span> <span class="function">list</span>(<span class="string">"frame"</span>, <span class="function">list</span>(duration <span class="operator">=</span> <span class="number">300</span>, redraw <span class="operator">=</span> <span class="variable">TRUE</span>)),
              label <span class="operator">=</span> f,
              method <span class="operator">=</span> <span class="string">"animate"</span>,
              value <span class="operator">=</span> f
            )
          })
        )
      )
    ) <span class="operator">%&gt;%</span>
    
    <span class="comment"># ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š</span>
    <span class="function">animation_opts</span>(
      frame <span class="operator">=</span> <span class="number">1000</span>,
      transition <span class="operator">=</span> <span class="number">300</span>,
      redraw <span class="operator">=</span> <span class="variable">TRUE</span>
    ) <span class="operator">%&gt;%</span>
    
    <span class="comment"># è¨­å®š</span>
    <span class="function">config</span>(
      displayModeBar <span class="operator">=</span> <span class="variable">TRUE</span>,
      modeBarButtonsToAdd <span class="operator">=</span> <span class="function">c</span>(<span class="string">"drawline"</span>, <span class="string">"drawopenpath"</span>, <span class="string">"drawclosedpath"</span>, <span class="string">"eraseshape"</span>),
      displaylogo <span class="operator">=</span> <span class="variable">FALSE</span>
    )
  
  <span class="keyword">return</span>(p)
}

<span class="comment"># é«˜åº¦ãªã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒƒãƒˆã®ä½œæˆ</span>
advanced_plot <span class="operator">&lt;-</span> <span class="function">create_advanced_interactive</span>(interactive_data)

<span class="function">print</span>(<span class="string">"é«˜åº¦ãªã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸ"</span>)

<span class="comment"># ã‚¯ãƒ­ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ç”¨ã®ãƒ‡ãƒ¼ã‚¿æº–å‚™</span>
crossfilter_data <span class="operator">&lt;-</span> interactive_data <span class="operator">%&gt;%</span>
  <span class="function">select</span>(company_name, industry, revenue, employees, profit_margin, satisfaction)

<span class="comment"># HTMLã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã¨ã—ã¦ã®ä¿å­˜è¨­å®š</span>
widget_options <span class="operator">&lt;-</span> <span class="function">list</span>(
  width <span class="operator">=</span> <span class="string">"100%"</span>,
  height <span class="operator">=</span> <span class="string">"600px"</span>,
  elementId <span class="operator">=</span> <span class="string">"interactive-business-chart"</span>
)

<span class="function">print</span>(<span class="string">"ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆè¨­å®šãŒå®Œäº†ã—ã¾ã—ãŸ"</span>)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">é«˜åº¦ãªã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³çµæœ</div>
                <div class="output-content">[1] "é«˜åº¦ãªã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸ"
[1] "ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆè¨­å®šãŒå®Œäº†ã—ã¾ã—ãŸ"

# é«˜åº¦ãªã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ©Ÿèƒ½:
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³: æ™‚ç³»åˆ—ã§ã®å¤‰åŒ–è¡¨ç¤º
- ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¿ãƒ³: ã‚¹ã‚±ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆã€ãƒ•ã‚£ãƒ«ã‚¿
- ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼: å‹•çš„ãƒ‡ãƒ¼ã‚¿é¸æŠ
- ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼: ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡
- æç”»ãƒ„ãƒ¼ãƒ«: æ³¨é‡ˆãƒ»ãƒãƒ¼ã‚­ãƒ³ã‚°æ©Ÿèƒ½

# ä¼æ¥­åˆ†æç‰¹åŒ–æ©Ÿèƒ½:
- æ¥­ç•Œåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- ä¼æ¥­è¦æ¨¡ã«ã‚ˆã‚‹è‰²åˆ†ã‘
- å¤šæ¬¡å…ƒãƒ‡ãƒ¼ã‚¿ã®åŒæ™‚è¡¨ç¤º
- ã‚«ã‚¹ã‚¿ãƒ ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—æƒ…å ±</div>
            </div>

            <div class="plotly-features">
                <div class="feature-card">
                    <div class="feature-title">ğŸ¯ ãƒ›ãƒãƒ¼ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—</div>
                    <div class="feature-description">ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼ã§è©³ç´°æƒ…å ±ã‚’è¡¨ç¤ºã€‚HTMLãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¯¾å¿œã§ãƒªãƒƒãƒãªæƒ…å ±æç¤ºãŒå¯èƒ½ã€‚</div>
                    <div class="feature-example">hovertemplate = "&lt;b&gt;%{text}&lt;/b&gt;&lt;br&gt;å€¤: %{y:.2f}&lt;extra&gt;&lt;/extra&gt;"</div>
                </div>
                <div class="feature-card">
                    <div class="feature-title">ğŸ” ã‚ºãƒ¼ãƒ ãƒ»ãƒ‘ãƒ³</div>
                    <div class="feature-description">ãƒã‚¦ã‚¹ãƒ‰ãƒ©ãƒƒã‚°ã§ã®ã‚ºãƒ¼ãƒ ã€ãƒ‘ãƒ³æ“ä½œã€‚ç‰¹å®šç¯„å›²ã®è©³ç´°åˆ†æã«æœ€é©ã€‚</div>
                    <div class="feature-example">config(scrollZoom = TRUE, doubleClick = 'reset')</div>
                </div>
                <div class="feature-card">
                    <div class="feature-title">ğŸ® ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¿ãƒ³</div>
                    <div class="feature-description">ãƒ‡ãƒ¼ã‚¿å¤‰æ›ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆã®ãŸã‚ã®ã‚«ã‚¹ã‚¿ãƒ UIè¦ç´ ã€‚</div>
                    <div class="feature-example">updatemenus = list(type = "buttons", buttons = [...])</div>
                </div>
                <div class="feature-card">
                    <div class="feature-title">ğŸ¬ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</div>
                    <div class="feature-description">æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®å‹•çš„è¡¨ç¤ºã€‚ãƒ‡ãƒ¼ã‚¿ã®å¤‰åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åŠ¹æœçš„ã«è¡¨ç¾ã€‚</div>
                    <div class="feature-example">animation_opts(frame = 1000, transition = 300)</div>
                </div>
                <div class="feature-card">
                    <div class="feature-title">ğŸ“Š ã‚µãƒ–ãƒ—ãƒ­ãƒƒãƒˆ</div>
                    <div class="feature-description">è¤‡æ•°ã®ãƒãƒ£ãƒ¼ãƒˆã‚’çµ±åˆã—ãŸãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºã€‚åŒ…æ‹¬çš„ãªåˆ†æè¦–ç‚¹ã‚’æä¾›ã€‚</div>
                    <div class="feature-example">subplot(p1, p2, nrows = 2, shareX = TRUE)</div>
                </div>
                <div class="feature-card">
                    <div class="feature-title">ğŸ’¾ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</div>
                    <div class="feature-description">PNGã€SVGã€PDFå½¢å¼ã§ã®ç”»åƒä¿å­˜ã€‚ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è³‡æ–™ã«æœ€é©ã€‚</div>
                    <div class="feature-example">toImageButtonOptions = list(format = "png", filename = "chart")</div>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>âš¡ Shinyã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>

            <h3>åŸºæœ¬çš„ãªShinyã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</h3>

            <div class="code-container">
                <div class="code-header">Shiny + plotlyãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</div>
                <div class="code-content">
<span class="keyword">library</span>(<span class="string">shiny</span>)
<span class="keyword">library</span>(<span class="string">shinydashboard</span>)
<span class="keyword">library</span>(<span class="string">DT</span>)

<span class="comment"># Shiny UIã®å®šç¾©</span>
dashboard_ui <span class="operator">&lt;-</span> <span class="function">dashboardPage</span>(
  
  <span class="comment"># ãƒ˜ãƒƒãƒ€ãƒ¼</span>
  <span class="function">dashboardHeader</span>(title <span class="operator">=</span> <span class="string">"ä¼æ¥­åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰"</span>),
  
  <span class="comment"># ã‚µã‚¤ãƒ‰ãƒãƒ¼</span>
  <span class="function">dashboardSidebar</span>(
    <span class="function">sidebarMenu</span>(
      <span class="function">menuItem</span>(<span class="string">"æ¦‚è¦"</span>, tabName <span class="operator">=</span> <span class="string">"overview"</span>, icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"dashboard"</span>)),
      <span class="function">menuItem</span>(<span class="string">"è©³ç´°åˆ†æ"</span>, tabName <span class="operator">=</span> <span class="string">"analysis"</span>, icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"chart-line"</span>)),
      <span class="function">menuItem</span>(<span class="string">"ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«"</span>, tabName <span class="operator">=</span> <span class="string">"data"</span>, icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"table"</span>))
    ),
    
    <span class="comment"># ãƒ•ã‚£ãƒ«ã‚¿ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</span>
    <span class="function">div</span>(style <span class="operator">=</span> <span class="string">"padding: 20px;"</span>,
      <span class="function">h4</span>(<span class="string">"ãƒ•ã‚£ãƒ«ã‚¿è¨­å®š"</span>),
      
      <span class="function">selectInput</span>(
        inputId <span class="operator">=</span> <span class="string">"industry_filter"</span>,
        label <span class="operator">=</span> <span class="string">"æ¥­ç•Œé¸æŠ:"</span>,
        choices <span class="operator">=</span> <span class="function">c</span>(<span class="string">"ã™ã¹ã¦"</span> <span class="operator">=</span> <span class="string">"all"</span>, <span class="string">"IT"</span>, <span class="string">"è£½é€ æ¥­"</span>, <span class="string">"é‡‘è"</span>, <span class="string">"å°å£²"</span>, <span class="string">"ã‚µãƒ¼ãƒ“ã‚¹"</span>),
        selected <span class="operator">=</span> <span class="string">"all"</span>,
        multiple <span class="operator">=</span> <span class="variable">TRUE</span>
      ),
      
      <span class="function">sliderInput</span>(
        inputId <span class="operator">=</span> <span class="string">"revenue_range"</span>,
        label <span class="operator">=</span> <span class="string">"å£²ä¸Šç¯„å›²ï¼ˆç™¾ä¸‡å††ï¼‰:"</span>,
        min <span class="operator">=</span> <span class="number">0</span>,
        max <span class="operator">=</span> <span class="number">5000</span>,
        value <span class="operator">=</span> <span class="function">c</span>(<span class="number">0</span>, <span class="number">5000</span>),
        step <span class="operator">=</span> <span class="number">100</span>
      ),
      
      <span class="function">sliderInput</span>(
        inputId <span class="operator">=</span> <span class="string">"employee_range"</span>,
        label <span class="operator">=</span> <span class="string">"å¾“æ¥­å“¡æ•°ç¯„å›²:"</span>,
        min <span class="operator">=</span> <span class="number">1</span>,
        max <span class="operator">=</span> <span class="number">1000</span>,
        value <span class="operator">=</span> <span class="function">c</span>(<span class="number">1</span>, <span class="number">1000</span>),
        step <span class="operator">=</span> <span class="number">10</span>
      ),
      
      <span class="function">checkboxInput</span>(
        inputId <span class="operator">=</span> <span class="string">"show_trend"</span>,
        label <span class="operator">=</span> <span class="string">"ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³è¡¨ç¤º"</span>,
        value <span class="operator">=</span> <span class="variable">TRUE</span>
      ),
      
      <span class="function">actionButton</span>(
        inputId <span class="operator">=</span> <span class="string">"refresh_data"</span>,
        label <span class="operator">=</span> <span class="string">"ãƒ‡ãƒ¼ã‚¿æ›´æ–°"</span>,
        icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"refresh"</span>),
        class <span class="operator">=</span> <span class="string">"btn-primary"</span>
      )
    )
  ),
  
  <span class="comment"># ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</span>
  <span class="function">dashboardBody</span>(
    <span class="function">tags$head</span>(
      <span class="function">tags$style</span>(<span class="function">HTML</span>(<span class="string">"
        .content-wrapper, .right-side {
          background-color: #f4f4f4;
        }
        .main-header .logo {
          background-color: #3c8dbc !important;
        }
        .skin-blue .main-header .navbar {
          background-color: #3c8dbc !important;
        }
      "</span>))
    ),
    
    <span class="function">tabItems</span>(
      <span class="comment"># æ¦‚è¦ã‚¿ãƒ–</span>
      <span class="function">tabItem</span>(
        tabName <span class="operator">=</span> <span class="string">"overview"</span>,
        
        <span class="function">fluidRow</span>(
          <span class="comment"># KPIãƒœãƒƒã‚¯ã‚¹</span>
          <span class="function">valueBoxOutput</span>(<span class="string">"total_companies"</span>, width <span class="operator">=</span> <span class="number">3</span>),
          <span class="function">valueBoxOutput</span>(<span class="string">"avg_revenue"</span>, width <span class="operator">=</span> <span class="number">3</span>),
          <span class="function">valueBoxOutput</span>(<span class="string">"avg_employees"</span>, width <span class="operator">=</span> <span class="number">3</span>),
          <span class="function">valueBoxOutput</span>(<span class="string">"avg_profit"</span>, width <span class="operator">=</span> <span class="number">3</span>)
        ),
        
        <span class="function">fluidRow</span>(
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"æ¥­ç•Œåˆ¥å£²ä¸Šåˆ†å¸ƒ"</span>,
            status <span class="operator">=</span> <span class="string">"primary"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">8</span>,
            <span class="function">plotlyOutput</span>(<span class="string">"industry_plot"</span>, height <span class="operator">=</span> <span class="string">"400px"</span>)
          ),
          
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"ä¼æ¥­è¦æ¨¡åˆ†å¸ƒ"</span>,
            status <span class="operator">=</span> <span class="string">"success"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">4</span>,
            <span class="function">plotlyOutput</span>(<span class="string">"size_plot"</span>, height <span class="operator">=</span> <span class="string">"400px"</span>)
          )
        )
      ),
      
      <span class="comment"># è©³ç´°åˆ†æã‚¿ãƒ–</span>
      <span class="function">tabItem</span>(
        tabName <span class="operator">=</span> <span class="string">"analysis"</span>,
        
        <span class="function">fluidRow</span>(
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"ä¼æ¥­ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ•£å¸ƒå›³"</span>,
            status <span class="operator">=</span> <span class="string">"primary"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">12</span>,
            <span class="function">plotlyOutput</span>(<span class="string">"scatter_plot"</span>, height <span class="operator">=</span> <span class="string">"500px"</span>)
          )
        ),
        
        <span class="function">fluidRow</span>(
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"æ™‚ç³»åˆ—ãƒˆãƒ¬ãƒ³ãƒ‰"</span>,
            status <span class="operator">=</span> <span class="string">"info"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">6</span>,
            <span class="function">plotlyOutput</span>(<span class="string">"trend_plot"</span>, height <span class="operator">=</span> <span class="string">"350px"</span>)
          ),
          
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"ç›¸é–¢åˆ†æ"</span>,
            status <span class="operator">=</span> <span class="string">"warning"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">6</span>,
            <span class="function">plotlyOutput</span>(<span class="string">"correlation_plot"</span>, height <span class="operator">=</span> <span class="string">"350px"</span>)
          )
        )
      ),
      
      <span class="comment"># ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¿ãƒ–</span>
      <span class="function">tabItem</span>(
        tabName <span class="operator">=</span> <span class="string">"data"</span>,
        
        <span class="function">fluidRow</span>(
          <span class="function">box</span>(
            title <span class="operator">=</span> <span class="string">"ä¼æ¥­ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«"</span>,
            status <span class="operator">=</span> <span class="string">"primary"</span>,
            solidHeader <span class="operator">=</span> <span class="variable">TRUE</span>,
            width <span class="operator">=</span> <span class="number">12</span>,
            
            <span class="function">div</span>(style <span class="operator">=</span> <span class="string">"margin-bottom: 20px;"</span>,
              <span class="function">downloadButton</span>(<span class="string">"download_data"</span>, <span class="string">"CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰"</span>, class <span class="operator">=</span> <span class="string">"btn-success"</span>)
            ),
            
            <span class="function">DT::dataTableOutput</span>(<span class="string">"data_table"</span>)
          )
        )
      )
    )
  )
)

<span class="comment"># Shinyã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚¸ãƒƒã‚¯</span>
dashboard_server <span class="operator">&lt;-</span> <span class="keyword">function</span>(input, output, session) {
  
  <span class="comment"># ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</span>
  filtered_data <span class="operator">&lt;-</span> <span class="function">reactive</span>({
    data <span class="operator">&lt;-</span> interactive_data
    
    <span class="comment"># æ¥­ç•Œãƒ•ã‚£ãƒ«ã‚¿</span>
    <span class="keyword">if</span> (!<span class="function">is.null</span>(input$industry_filter) <span class="operator">&amp;&amp;</span> !<span class="string">"all"</span> <span class="operator">%in%</span> input$industry_filter) {
      data <span class="operator">&lt;-</span> data <span class="operator">%&gt;%</span> <span class="function">filter</span>(industry <span class="operator">%in%</span> input$industry_filter)
    }
    
    <span class="comment"># å£²ä¸Šç¯„å›²ãƒ•ã‚£ãƒ«ã‚¿</span>
    data <span class="operator">&lt;-</span> data <span class="operator">%&gt;%</span>
      <span class="function">filter</span>(
        revenue <span class="operator">&gt;=</span> input$revenue_range[<span class="number">1</span>],
        revenue <span class="operator">&lt;=</span> input$revenue_range[<span class="number">2</span>],
        employees <span class="operator">&gt;=</span> input$employee_range[<span class="number">1</span>],
        employees <span class="operator">&lt;=</span> input$employee_range[<span class="number">2</span>]
      )
    
    <span class="keyword">return</span>(data)
  })
  
  <span class="comment"># KPIãƒœãƒƒã‚¯ã‚¹</span>
  output$total_companies <span class="operator">&lt;-</span> <span class="function">renderValueBox</span>({
    <span class="function">valueBox</span>(
      value <span class="operator">=</span> <span class="function">nrow</span>(<span class="function">filtered_data</span>()),
      subtitle <span class="operator">=</span> <span class="string">"ç·ä¼æ¥­æ•°"</span>,
      icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"building"</span>),
      color <span class="operator">=</span> <span class="string">"blue"</span>
    )
  })
  
  output$avg_revenue <span class="operator">&lt;-</span> <span class="function">renderValueBox</span>({
    <span class="function">valueBox</span>(
      value <span class="operator">=</span> <span class="function">paste0</span>(<span class="string">"Â¥"</span>, <span class="function">round</span>(<span class="function">mean</span>(<span class="function">filtered_data</span>()$revenue)), <span class="string">"M"</span>),
      subtitle <span class="operator">=</span> <span class="string">"å¹³å‡å£²ä¸Š"</span>,
      icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"yen-sign"</span>),
      color <span class="operator">=</span> <span class="string">"green"</span>
    )
  })
  
  output$avg_employees <span class="operator">&lt;-</span> <span class="function">renderValueBox</span>({
    <span class="function">valueBox</span>(
      value <span class="operator">=</span> <span class="function">round</span>(<span class="function">mean</span>(<span class="function">filtered_data</span>()$employees)),
      subtitle <span class="operator">=</span> <span class="string">"å¹³å‡å¾“æ¥­å“¡æ•°"</span>,
      icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"users"</span>),
      color <span class="operator">=</span> <span class="string">"yellow"</span>
    )
  })
  
  output$avg_profit <span class="operator">&lt;-</span> <span class="function">renderValueBox</span>({
    <span class="function">valueBox</span>(
      value <span class="operator">=</span> <span class="function">paste0</span>(<span class="function">round</span>(<span class="function">mean</span>(<span class="function">filtered_data</span>()$profit_margin), <span class="number">1</span>), <span class="string">"%"</span>),
      subtitle <span class="operator">=</span> <span class="string">"å¹³å‡åˆ©ç›Šç‡"</span>,
      icon <span class="operator">=</span> <span class="function">icon</span>(<span class="string">"chart-line"</span>),
      color <span class="operator">=</span> <span class="string">"red"</span>
    )
  })
  
  <span class="comment"># ãƒ—ãƒ­ãƒƒãƒˆç”Ÿæˆ</span>
  output$scatter_plot <span class="operator">&lt;-</span> <span class="function">renderPlotly</span>({
    p <span class="operator">&lt;-</span> <span class="function">filtered_data</span>() <span class="operator">%&gt;%</span>
      <span class="function">plot_ly</span>(
        x <span class="operator">=</span> ~revenue,
        y <span class="operator">=</span> ~profit_margin,
        color <span class="operator">=</span> ~industry,
        size <span class="operator">=</span> ~employees,
        text <span class="operator">=</span> ~company_name,
        type <span class="operator">=</span> <span class="string">"scatter"</span>,
        mode <span class="operator">=</span> <span class="string">"markers"</span>,
        hovertemplate <span class="operator">=</span> <span class="string">"&lt;b&gt;%{text}&lt;/b&gt;&lt;br&gt;å£²ä¸Š: Â¥%{x:,.0f}M&lt;br&gt;åˆ©ç›Šç‡: %{y:.1f}%&lt;extra&gt;&lt;/extra&gt;"</span>
      ) <span class="operator">%&gt;%</span>
      <span class="function">layout</span>(
        title <span class="operator">=</span> <span class="string">"å£²ä¸Š vs åˆ©ç›Šç‡"</span>,
        xaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"å£²ä¸Šé«˜ï¼ˆç™¾ä¸‡å††ï¼‰"</span>),
        yaxis <span class="operator">=</span> <span class="function">list</span>(title <span class="operator">=</span> <span class="string">"åˆ©ç›Šç‡ï¼ˆ%ï¼‰"</span>)
      )
    
    <span class="keyword">if</span> (input$show_trend) {
      p <span class="operator">&lt;-</span> p <span class="operator">%&gt;%</span> <span class="function">add_lines</span>(
        x <span class="operator">=</span> ~revenue,
        y <span class="operator">=</span> <span class="function">fitted</span>(<span class="function">lm</span>(profit_margin ~ revenue, data <span class="operator">=</span> <span class="function">filtered_data</span>())),
        line <span class="operator">=</span> <span class="function">list</span>(color <span class="operator">=</span> <span class="string">"red"</span>, width <span class="operator">=</span> <span class="number">2</span>),
        name <span class="operator">=</span> <span class="string">"ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³"</span>,
        hoverinfo <span class="operator">=</span> <span class="string">"skip"</span>
      )
    }
    
    p
  })
  
  <span class="comment"># ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«</span>
  output$data_table <span class="operator">&lt;-</span> <span class="function">DT::renderDataTable</span>({
    <span class="function">filtered_data</span>() <span class="operator">%&gt;%</span>
      <span class="function">select</span>(company_name, industry, revenue, employees, profit_margin, satisfaction) <span class="operator">%&gt;%</span>
      <span class="function">DT::datatable</span>(
        options <span class="operator">=</span> <span class="function">list</span>(
          pageLength <span class="operator">=</span> <span class="number">15</span>,
          scrollX <span class="operator">=</span> <span class="variable">TRUE</span>,
          searching <span class="operator">=</span> <span class="variable">TRUE</span>
        ),
        colnames <span class="operator">=</span> <span class="function">c</span>(<span class="string">"ä¼æ¥­å"</span>, <span class="string">"æ¥­ç•Œ"</span>, <span class="string">"å£²ä¸Š(MÂ¥)"</span>, <span class="string">"å¾“æ¥­å“¡æ•°"</span>, <span class="string">"åˆ©ç›Šç‡(%)"</span>, <span class="string">"æº€è¶³åº¦"</span>)
      ) <span class="operator">%&gt;%</span>
      <span class="function">DT::formatCurrency</span>(<span class="string">"revenue"</span>, currency <span class="operator">=</span> <span class="string">"Â¥"</span>, mark <span class="operator">=</span> <span class="string">","</span>) <span class="operator">%&gt;%</span>
      <span class="function">DT::formatPercentage</span>(<span class="string">"profit_margin"</span>, digits <span class="operator">=</span> <span class="number">1</span>)
  })
  
  <span class="comment"># ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</span>
  output$download_data <span class="operator">&lt;-</span> <span class="function">downloadHandler</span>(
    filename <span class="operator">=</span> <span class="keyword">function</span>() {
      <span class="function">paste</span>(<span class="string">"ä¼æ¥­ãƒ‡ãƒ¼ã‚¿_"</span>, <span class="function">Sys.Date</span>(), <span class="string">".csv"</span>, sep <span class="operator">=</span> <span class="string">""</span>)
    },
    content <span class="operator">=</span> <span class="keyword">function</span>(file) {
      <span class="function">write.csv</span>(<span class="function">filtered_data</span>(), file, row.names <span class="operator">=</span> <span class="variable">FALSE</span>)
    }
  )
}

<span class="comment"># ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œè¨­å®š</span>
app_config <span class="operator">&lt;-</span> <span class="function">list</span>(
  ui <span class="operator">=</span> dashboard_ui,
  server <span class="operator">=</span> dashboard_server,
  options <span class="operator">=</span> <span class="function">list</span>(port <span class="operator">=</span> <span class="number">3838</span>)
)

<span class="function">print</span>(<span class="string">"Shinyãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¨­å®šã•ã‚Œã¾ã—ãŸ"</span>)
<span class="function">print</span>(<span class="string">"å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰: shinyApp(ui = dashboard_ui, server = dashboard_server)"</span>)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">Shinyãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¨­å®šçµæœ</div>
                <div class="output-content">[1] "Shinyãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¨­å®šã•ã‚Œã¾ã—ãŸ"
[1] "å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰: shinyApp(ui = dashboard_ui, server = dashboard_server)"

# Shinyãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ä¸»è¦æ©Ÿèƒ½:
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°: å‹•çš„ãƒ‡ãƒ¼ã‚¿çµã‚Šè¾¼ã¿
- KPIè¡¨ç¤º: é‡è¦æŒ‡æ¨™ã®è¦–è¦šçš„è¡¨ç¤º
- ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒƒãƒˆ: plotlyçµ±åˆ
- ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«: æ¤œç´¢ãƒ»ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½
- CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰: ãƒ•ã‚£ãƒ«ã‚¿æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›

# ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹:
- æ¥­ç•Œåˆ¥ãƒ•ã‚£ãƒ«ã‚¿
- å£²ä¸Šãƒ»å¾“æ¥­å“¡æ•°ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
- ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
- ã‚¿ãƒ–ãƒ™ãƒ¼ã‚¹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³</div>
            </div>

            <div class="interactive-demo">
                <div class="demo-title">Shinyãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>
                <div class="demo-content">
                    <div style="display: grid; grid-template-columns: 200px 1fr; gap: 10px; width: 100%; height: 100%;">
                        <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
                        <div style="background: #222d32; padding: 15px; border-radius: 5px;">
                            <div style="color: white; font-size: 0.9rem; margin-bottom: 10px;">
                                <strong>ğŸ“Š ä¼æ¥­åˆ†æ</strong>
                            </div>
                            <div style="color: #b3b3b3; font-size: 0.7rem; line-height: 1.4;">
                                â€¢ æ¦‚è¦<br>
                                â€¢ è©³ç´°åˆ†æ<br>
                                â€¢ ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«<br><br>
                                <strong>ãƒ•ã‚£ãƒ«ã‚¿:</strong><br>
                                æ¥­ç•Œ: [å…¨ã¦â–¼]<br>
                                å£²ä¸Š: [0â”â”â”5000]<br>
                                å¾“æ¥­å“¡: [1â”â”1000]
                            </div>
                        </div>
                        <!-- ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ -->
                        <div style="background: #f4f4f4; padding: 15px; border-radius: 5px;">
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 10px;">
                                <div style="background: #3c8dbc; color: white; padding: 8px; border-radius: 3px; text-align: center; font-size: 0.7rem;">
                                    <div>ğŸ“ˆ 200</div>
                                    <div>ä¼æ¥­æ•°</div>
                                </div>
                                <div style="background: #00a65a; color: white; padding: 8px; border-radius: 3px; text-align: center; font-size: 0.7rem;">
                                    <div>Â¥1.2M</div>
                                    <div>å¹³å‡å£²ä¸Š</div>
                                </div>
                                <div style="background: #f39c12; color: white; padding: 8px; border-radius: 3px; text-align: center; font-size: 0.7rem;">
                                    <div>150äºº</div>
                                    <div>å¾“æ¥­å“¡æ•°</div>
                                </div>
                                <div style="background: #dd4b39; color: white; padding: 8px; border-radius: 3px; text-align: center; font-size: 0.7rem;">
                                    <div>15.2%</div>
                                    <div>åˆ©ç›Šç‡</div>
                                </div>
                            </div>
                            <div style="background: white; padding: 10px; border-radius: 5px; text-align: center; border: 1px solid #ddd;">
                                <div style="color: #3c8dbc; font-weight: bold; margin-bottom: 5px; font-size: 0.8rem;">ä¼æ¥­ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ•£å¸ƒå›³</div>
                                <div style="color: #999; font-size: 0.7rem;">ğŸ“Š ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒ£ãƒ¼ãƒˆã‚¨ãƒªã‚¢</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="data-table">
            <table>
                <thead>
                    <tr>
                        <th>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æŠ€è¡“</th>
                        <th>é©ç”¨é ˜åŸŸ</th>
                        <th>ä¸»è¦æ©Ÿèƒ½</th>
                        <th>å®Ÿè£…é›£æ˜“åº¦</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>plotlyå¤‰æ›</td>
                        <td>é™çš„ã‚°ãƒ©ãƒ•æ‹¡å¼µ</td>
                        <td>ãƒ›ãƒãƒ¼ã€ã‚ºãƒ¼ãƒ ã€ãƒ•ã‚£ãƒ«ã‚¿</td>
                        <td>ä½</td>
                    </tr>
                    <tr>
                        <td>ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¿ãƒ³</td>
                        <td>ãƒ‡ãƒ¼ã‚¿æ“ä½œUI</td>
                        <td>ã‚¹ã‚±ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆã€è¡¨ç¤ºåˆ¶å¾¡</td>
                        <td>ä¸­</td>
                    </tr>
                    <tr>
                        <td>ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</td>
                        <td>æ™‚ç³»åˆ—è¡¨ç¾</td>
                        <td>ãƒ‡ãƒ¼ã‚¿å¤‰åŒ–ã®å‹•çš„è¡¨ç¤º</td>
                        <td>ä¸­</td>
                    </tr>
                    <tr>
                        <td>Shinyãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</td>
                        <td>Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</td>
                        <td>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ†æç’°å¢ƒ</td>
                        <td>é«˜</td>
                    </tr>
                    <tr>
                        <td>ã‚¯ãƒ­ã‚¹ãƒ•ã‚£ãƒ«ã‚¿</td>
                        <td>è¤‡æ•°ãƒãƒ£ãƒ¼ãƒˆé€£å‹•</td>
                        <td>çµ±åˆçš„ãƒ‡ãƒ¼ã‚¿æ¢ç´¢</td>
                        <td>é«˜</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="key-points">
            <h4>ç¬¬14ç« ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆ</h4>
            <ul>
                <li><strong>ggplotlyå¤‰æ›</strong>ï¼šé™çš„ã‚°ãƒ©ãƒ•ã®ç°¡å˜ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–åŒ–</li>
                <li><strong>ã‚«ã‚¹ã‚¿ãƒ æ©Ÿèƒ½</strong>ï¼šãƒœã‚¿ãƒ³ã€ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã€ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®è¿½åŠ </li>
                <li><strong>ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</strong>ï¼šæ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®å‹•çš„å¯è¦–åŒ–</li>
                <li><strong>Shinyçµ±åˆ</strong>ï¼šWebãƒ™ãƒ¼ã‚¹ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</li>
                <li><strong>ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£</strong>ï¼šç›´æ„Ÿçš„æ“ä½œã«ã‚ˆã‚‹æ¢ç´¢çš„ãƒ‡ãƒ¼ã‚¿åˆ†æ</li>
                <li><strong>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</strong>ï¼šå¤§å®¹é‡ãƒ‡ãƒ¼ã‚¿ã®åŠ¹ç‡çš„ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°</li>
            </ul>
        </div>

        <div class="tip-box">
            <h4>å®Ÿè·µçš„ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h4>
            <p>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¯è¦–åŒ–ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ‡ãƒ¼ã‚¿ã¨å¯¾è©±ã™ã‚‹ã“ã¨ã§æ–°ãŸãªæ´å¯Ÿã‚’ç™ºè¦‹ã§ãã‚‹å¼·åŠ›ãªæ‰‹æ³•ã§ã™ã€‚plotlyã¯æ—¢å­˜ã®ggplot2ã‚³ãƒ¼ãƒ‰ã‚’æ´»ç”¨ã—ãªãŒã‚‰æ®µéšçš„ã«ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–è¦ç´ ã‚’è¿½åŠ ã§ãã‚‹ãŸã‚ã€å­¦ç¿’ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã¦é«˜åº¦ãªæ©Ÿèƒ½ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚Shinyã¨ã®çµ„ã¿åˆã‚ã›ã«ã‚ˆã‚Šã€ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã®æœ¬æ ¼çš„ãªåˆ†æã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚‚æ§‹ç¯‰å¯èƒ½ã§ã™ã€‚</p>
        </div>

        <nav class="chapter-nav">
            <a href="chapter13-advanced-ggplot2.html" class="nav-button">â† ç¬¬13ç« </a>
            <a href="chapter15-advanced-data-viz.html" class="nav-button">ç¬¬15ç«  â†’</a>
        </nav>
    </div>
</body>
</html>