<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬10ç« : çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°åŸºç¤ | Tidyverseå®Œå…¨ãƒã‚¹ã‚¿ãƒ¼</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --accent-neon: #00ff88;
            --accent-cyan: #00d4ff;
            --accent-purple: #9d4edd;
            --accent-magenta: #ff6b9d;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --border-neon: #00ff88;
            --shadow-neon: 0 0 20px #00ff8840;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: linear-gradient(45deg, var(--bg-secondary), var(--bg-tertiary));
            border-radius: 20px;
            border: 2px solid var(--accent-magenta);
            box-shadow: 0 0 20px rgba(255, 107, 157, 0.4);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 107, 157, 0.1), transparent);
            animation: scan 3s infinite;
        }

        @keyframes scan {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        h1 {
            font-size: 3rem;
            font-weight: 700;
            color: var(--accent-magenta);
            margin-bottom: 10px;
            text-shadow: 0 0 20px var(--accent-magenta);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.4rem;
            color: var(--accent-cyan);
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .chapter-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            position: relative;
            z-index: 1;
        }

        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: 4px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .progress-dot {
            width: 5px;
            height: 5px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            border: 1px solid var(--text-secondary);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--accent-magenta);
            border-color: var(--accent-magenta);
            box-shadow: 0 0 6px var(--accent-magenta);
        }

        .progress-dot.completed {
            background: var(--accent-cyan);
            border-color: var(--accent-cyan);
        }

        /* Navigation Widget */
        .chapter-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 4px;
            margin: 30px 0;
            padding: 8px;
            background: var(--bg-secondary);
            border-radius: 10px;
            border: 1px solid var(--accent-magenta);
            width: fit-content;
            max-width: 90vw;
            margin-left: auto;
            margin-right: auto;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 2px 6px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            text-decoration: none;
            border-radius: 3px;
            border: 1px solid var(--accent-cyan);
            transition: all 0.3s ease;
            font-size: 0.7rem;
            white-space: nowrap;
        }

        .nav-button:hover {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            box-shadow: 0 0 8px var(--accent-cyan);
        }

        .nav-button.current {
            background: var(--accent-magenta);
            color: var(--bg-primary);
            box-shadow: 0 0 8px var(--accent-magenta);
        }

        /* Content Sections */
        .section {
            background: var(--bg-secondary);
            margin: 30px 0;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid var(--accent-purple);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-magenta), var(--accent-cyan), var(--accent-purple));
            border-radius: 15px 15px 0 0;
        }

        h2 {
            color: var(--accent-magenta);
            font-size: 2rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--accent-magenta);
        }

        h3 {
            color: var(--accent-cyan);
            font-size: 1.5rem;
            margin: 25px 0 15px 0;
            text-shadow: 0 0 8px var(--accent-cyan);
        }

        h4 {
            color: var(--accent-purple);
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
        }

        /* Code Blocks */
        .code-container {
            margin: 20px 0;
            background: #1a1a1a;
            border-radius: 10px;
            border: 1px solid var(--accent-magenta);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.1);
        }

        .code-header {
            background: var(--accent-magenta);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-header::before {
            content: 'ğŸ“Š';
            font-size: 1.1rem;
        }

        .code-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            background: #0d1117;
            color: #c9d1d9;
            overflow-x: auto;
        }

        /* Syntax highlighting */
        .keyword { color: #ff7b72; }
        .function { color: #d2a8ff; }
        .string { color: #a5d6ff; }
        .comment { color: #8b949e; font-style: italic; }
        .operator { color: #f85149; }
        .number { color: #79c0ff; }
        .variable { color: #ffa657; }

        /* Output Display */
        .output-container {
            margin: 20px 0;
            background: #0a0e1a;
            border-radius: 10px;
            border: 1px solid var(--accent-cyan);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.1);
        }

        .output-header {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .output-header::before {
            content: 'ğŸ“ˆ';
        }

        .output-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--accent-cyan);
        }

        /* Model Visualization */
        .model-viz {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--accent-purple);
            text-align: center;
        }

        .viz-title {
            color: var(--accent-purple);
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: bold;
        }

        /* Data Tables */
        .data-table {
            margin: 20px 0;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-tertiary);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid var(--accent-magenta);
        }

        th {
            background: var(--accent-magenta);
            color: var(--bg-primary);
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--bg-secondary);
            color: var(--text-primary);
        }

        tr:nth-child(even) {
            background: rgba(255, 107, 157, 0.05);
        }

        tr:hover {
            background: rgba(255, 107, 157, 0.1);
        }

        /* Key Points */
        .key-points {
            background: linear-gradient(135deg, rgba(255, 107, 157, 0.1) 0%, rgba(0, 212, 255, 0.1) 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-magenta);
        }

        .key-points h4 {
            color: var(--accent-magenta);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .key-points h4::before {
            content: 'ğŸ’¡';
        }

        .key-points ul {
            list-style: none;
            padding-left: 0;
        }

        .key-points li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .key-points li::before {
            content: 'â–¶';
            color: var(--accent-cyan);
            position: absolute;
            left: 0;
        }

        /* Warning/Tip boxes */
        .tip-box {
            background: rgba(157, 78, 221, 0.1);
            border: 1px solid var(--accent-purple);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-purple);
        }

        .tip-box h4 {
            color: var(--accent-purple);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tip-box h4::before {
            content: 'âš ï¸';
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }

            .chapter-meta {
                flex-direction: column;
                gap: 10px;
            }

            .chapter-nav {
                gap: 3px;
                padding: 6px;
            }

            .nav-button {
                padding: 1px 4px;
                font-size: 0.65rem;
            }

            .section {
                padding: 20px;
                margin: 20px 0;
            }

            h2 {
                font-size: 1.5rem;
            }

            .code-content, .output-content {
                font-size: 0.85rem;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ç¬¬10ç« : çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°åŸºç¤</h1>
            <p class="subtitle">Tidyverseã«ã‚ˆã‚‹çµ±è¨ˆåˆ†æã¨ãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰</p>
            <div class="chapter-meta">
                <span>ğŸ“Š å›å¸°åˆ†æ</span>
                <span>ğŸ” ä»®èª¬æ¤œå®š</span>
                <span>ğŸ“ˆ ãƒ¢ãƒ‡ãƒ«è©•ä¾¡</span>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>
        </header>

        <nav class="chapter-nav">
            <a href="chapter1-tidyverse-overview.html" class="nav-button">1</a>
            <a href="chapter2-dplyr-data-manipulation.html" class="nav-button">2</a>
            <a href="chapter3-ggplot2-visualization.html" class="nav-button">3</a>
            <a href="chapter4-tidyr-data-reshaping.html" class="nav-button">4</a>
            <a href="chapter5-stringr-text-processing.html" class="nav-button">5</a>
            <a href="chapter6-forcats-purrr-advanced.html" class="nav-button">6</a>
            <a href="chapter7-lubridate-datetime.html" class="nav-button">7</a>
            <a href="chapter8-readr-data-import.html" class="nav-button">8</a>
            <a href="chapter9-tibble-modern-dataframe.html" class="nav-button">9</a>
            <a href="#" class="nav-button current">10</a>
            <a href="chapter11-machine-learning.html" class="nav-button">11</a>
            <a href="chapter12-time-series.html" class="nav-button">12</a>
        </nav>

        <section class="section">
            <h2>ğŸ“Š ç·šå½¢å›å¸°åˆ†æã®åŸºç¤</h2>
            
            <p>çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã®åŸºæœ¬ã¨ãªã‚‹ç·šå½¢å›å¸°ã‚’ã€Tidyverseã®broomãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨çµ„ã¿åˆã‚ã›ã¦åŠ¹æœçš„ã«å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã‚’å­¦ç¿’ã—ã¾ã™ã€‚</p>

            <h3>å˜ç´”ç·šå½¢å›å¸°</h3>

            <div class="code-container">
                <div class="code-header">åŸºæœ¬çš„ãªç·šå½¢å›å¸°ãƒ¢ãƒ‡ãƒ«</div>
                <div class="code-content">
<span class="keyword">library</span>(<span class="string">tidyverse</span>)
<span class="keyword">library</span>(<span class="string">broom</span>)
<span class="keyword">library</span>(<span class="string">modelr</span>)

<span class="comment"># ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ</span>
<span class="function">set.seed</span>(<span class="number">123</span>)
house_data <span class="operator">&lt;-</span> <span class="function">tibble</span>(
  area <span class="operator">=</span> <span class="function">runif</span>(<span class="number">200</span>, <span class="number">50</span>, <span class="number">200</span>),  <span class="comment"># é¢ç©ï¼ˆå¹³æ–¹ãƒ¡ãƒ¼ãƒˆãƒ«ï¼‰</span>
  age <span class="operator">=</span> <span class="function">runif</span>(<span class="number">200</span>, <span class="number">0</span>, <span class="number">30</span>),     <span class="comment"># ç¯‰å¹´æ•°</span>
  station_distance <span class="operator">=</span> <span class="function">runif</span>(<span class="number">200</span>, <span class="number">1</span>, <span class="number">20</span>),  <span class="comment"># é§…è·é›¢ï¼ˆåˆ†ï¼‰</span>
  price <span class="operator">=</span> <span class="number">30</span> <span class="operator">+</span> area <span class="operator">*</span> <span class="number">0.8</span> <span class="operator">-</span> age <span class="operator">*</span> <span class="number">2</span> <span class="operator">-</span> station_distance <span class="operator">*</span> <span class="number">1.5</span> <span class="operator">+</span> <span class="function">rnorm</span>(<span class="number">200</span>, <span class="number">0</span>, <span class="number">15</span>)
) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(price <span class="operator">=</span> <span class="function">pmax</span>(price, <span class="number">20</span>))  <span class="comment"># æœ€ä½ä¾¡æ ¼ã‚’20ä¸‡å††ã«è¨­å®š</span>

<span class="function">print</span>(<span class="function">head</span>(house_data))

<span class="comment"># é¢ç©ã¨ä¾¡æ ¼ã®å˜ç´”ç·šå½¢å›å¸°</span>
simple_model <span class="operator">&lt;-</span> <span class="function">lm</span>(price ~ area, data <span class="operator">=</span> house_data)

<span class="comment"># broomãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§çµæœã‚’æ•´ç†</span>
model_summary <span class="operator">&lt;-</span> <span class="function">tidy</span>(simple_model)
model_metrics <span class="operator">&lt;-</span> <span class="function">glance</span>(simple_model)
model_predictions <span class="operator">&lt;-</span> <span class="function">augment</span>(simple_model)

<span class="function">print</span>(<span class="string">"å›å¸°ä¿‚æ•°:"</span>)
<span class="function">print</span>(model_summary)

<span class="function">print</span>(<span class="string">"ãƒ¢ãƒ‡ãƒ«è©•ä¾¡æŒ‡æ¨™:"</span>)
<span class="function">print</span>(model_metrics)

<span class="comment"># äºˆæ¸¬å€¤ã¨æ®‹å·®ã®åˆ†æ</span>
prediction_analysis <span class="operator">&lt;-</span> model_predictions <span class="operator">%&gt;%</span>
  <span class="function">select</span>(area, price, .fitted, .resid) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    abs_error <span class="operator">=</span> <span class="function">abs</span>(.resid),
    percent_error <span class="operator">=</span> <span class="function">abs</span>(.resid) / price <span class="operator">*</span> <span class="number">100</span>
  )

<span class="function">print</span>(<span class="string">"äºˆæ¸¬åˆ†æï¼ˆä¸Šä½10ä»¶ï¼‰:"</span>)
<span class="function">print</span>(<span class="function">head</span>(prediction_analysis, <span class="number">10</span>))

<span class="comment"># ãƒ¢ãƒ‡ãƒ«ã®è§£é‡ˆ</span>
area_coefficient <span class="operator">&lt;-</span> model_summary$estimate[<span class="number">2</span>]
r_squared <span class="operator">&lt;-</span> model_metrics$r.squared

<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"é¢ç©1å¹³æ–¹ãƒ¡ãƒ¼ãƒˆãƒ«å¢—åŠ ã‚ãŸã‚Šã®ä¾¡æ ¼ä¸Šæ˜‡:"</span>, <span class="function">round</span>(area_coefficient, <span class="number">2</span>), <span class="string">"ä¸‡å††"</span>))
<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"æ±ºå®šä¿‚æ•° RÂ²:"</span>, <span class="function">round</span>(r_squared, <span class="number">3</span>)))
<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"é¢ç©ã§èª¬æ˜ã§ãã‚‹ä¾¡æ ¼ã®å¤‰å‹•:"</span>, <span class="function">round</span>(r_squared <span class="operator">*</span> <span class="number">100</span>, <span class="number">1</span>), <span class="string">"%"</span>))
</div>
            </div>

            <div class="output-container">
                <div class="output-header">å˜ç´”ç·šå½¢å›å¸°çµæœ</div>
                <div class="output-content"># A tibble: 6 Ã— 4
   area   age station_distance price
  &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt; &lt;dbl&gt;
1  142.  14.6             7.36  129.
2  152.  17.4            18.9    99.0
3  169.  12.3            15.3   109. 
4  159.  29.5             2.68   70.9
5  96.4  15.2            14.7    68.5
6  163.  22.9            12.7    81.4

å›å¸°ä¿‚æ•°:
# A tibble: 2 Ã— 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)    28.1      4.22      6.66 2.33e-10
2 area            0.793    0.0334   23.7  4.88e-56

ãƒ¢ãƒ‡ãƒ«è©•ä¾¡æŒ‡æ¨™:
# A tibble: 1 Ã— 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC deviance df.residual nobs
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1     0.740         0.738  15.1      562. 4.88e-56     1  -743. 1492. 1502.   45147.         198   200

é¢ç©1å¹³æ–¹ãƒ¡ãƒ¼ãƒˆãƒ«å¢—åŠ ã‚ãŸã‚Šã®ä¾¡æ ¼ä¸Šæ˜‡: 0.79 ä¸‡å††
æ±ºå®šä¿‚æ•° RÂ²: 0.74
é¢ç©ã§èª¬æ˜ã§ãã‚‹ä¾¡æ ¼ã®å¤‰å‹•: 74.0 %</div>
            </div>

            <h3>é‡å›å¸°åˆ†æ</h3>

            <div class="code-container">
                <div class="code-header">å¤šå¤‰é‡å›å¸°ãƒ¢ãƒ‡ãƒ«</div>
                <div class="code-content">
<span class="comment"># é‡å›å¸°ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰</span>
multiple_model <span class="operator">&lt;-</span> <span class="function">lm</span>(price ~ area <span class="operator">+</span> age <span class="operator">+</span> station_distance, data <span class="operator">=</span> house_data)

<span class="comment"># çµæœã®æ¯”è¼ƒ</span>
multiple_summary <span class="operator">&lt;-</span> <span class="function">tidy</span>(multiple_model)
multiple_metrics <span class="operator">&lt;-</span> <span class="function">glance</span>(multiple_model)

<span class="function">print</span>(<span class="string">"é‡å›å¸°ä¿‚æ•°:"</span>)
<span class="function">print</span>(multiple_summary)

<span class="function">print</span>(<span class="string">"é‡å›å¸°è©•ä¾¡æŒ‡æ¨™:"</span>)
<span class="function">print</span>(multiple_metrics)

<span class="comment"># ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒ</span>
model_comparison <span class="operator">&lt;-</span> <span class="function">tibble</span>(
  model <span class="operator">=</span> <span class="function">c</span>(<span class="string">"å˜ç´”å›å¸°"</span>, <span class="string">"é‡å›å¸°"</span>),
  r_squared <span class="operator">=</span> <span class="function">c</span>(model_metrics$r.squared, multiple_metrics$r.squared),
  adj_r_squared <span class="operator">=</span> <span class="function">c</span>(model_metrics$adj.r.squared, multiple_metrics$adj.r.squared),
  rmse <span class="operator">=</span> <span class="function">c</span>(model_metrics$sigma, multiple_metrics$sigma),
  aic <span class="operator">=</span> <span class="function">c</span>(model_metrics$AIC, multiple_metrics$AIC)
)

<span class="function">print</span>(<span class="string">"ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒ:"</span>)
<span class="function">print</span>(model_comparison)

<span class="comment"># æ®‹å·®åˆ†æ</span>
multiple_predictions <span class="operator">&lt;-</span> <span class="function">augment</span>(multiple_model)

residual_analysis <span class="operator">&lt;-</span> multiple_predictions <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    mean_residual <span class="operator">=</span> <span class="function">mean</span>(.resid),
    sd_residual <span class="operator">=</span> <span class="function">sd</span>(.resid),
    rmse <span class="operator">=</span> <span class="function">sqrt</span>(<span class="function">mean</span>(.resid^<span class="number">2</span>)),
    mae <span class="operator">=</span> <span class="function">mean</span>(<span class="function">abs</span>(.resid)),
    outliers_count <span class="operator">=</span> <span class="function">sum</span>(<span class="function">abs</span>(.resid) <span class="operator">&gt;</span> <span class="number">2</span> <span class="operator">*</span> <span class="function">sd</span>(.resid))
  )

<span class="function">print</span>(<span class="string">"æ®‹å·®çµ±è¨ˆ:"</span>)
<span class="function">print</span>(residual_analysis)

<span class="comment"># äºˆæ¸¬ç²¾åº¦ã®æ¯”è¼ƒ</span>
accuracy_comparison <span class="operator">&lt;-</span> house_data <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    simple_pred <span class="operator">=</span> <span class="function">predict</span>(simple_model, .),
    multiple_pred <span class="operator">=</span> <span class="function">predict</span>(multiple_model, .),
    simple_error <span class="operator">=</span> <span class="function">abs</span>(price <span class="operator">-</span> simple_pred),
    multiple_error <span class="operator">=</span> <span class="function">abs</span>(price <span class="operator">-</span> multiple_pred)
  ) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    simple_mae <span class="operator">=</span> <span class="function">mean</span>(simple_error),
    multiple_mae <span class="operator">=</span> <span class="function">mean</span>(multiple_error),
    improvement <span class="operator">=</span> (simple_mae <span class="operator">-</span> multiple_mae) / simple_mae <span class="operator">*</span> <span class="number">100</span>
  )

<span class="function">print</span>(<span class="string">"äºˆæ¸¬ç²¾åº¦ã®æ”¹å–„:"</span>)
<span class="function">print</span>(accuracy_comparison)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">é‡å›å¸°åˆ†æçµæœ</div>
                <div class="output-content">é‡å›å¸°ä¿‚æ•°:
# A tibble: 4 Ã— 5
  term             estimate std.error statistic   p.value
  &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)         30.2      2.93     10.3  2.40e-19
2 area                 0.798    0.0200   39.9  1.47e-92
3 age                 -1.98     0.0848  -23.4  1.02e-55
4 station_distance    -1.50     0.0894  -16.8  1.18e-37

ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒ:
# A tibble: 2 Ã— 5
  model    r_squared adj_r_squared  rmse   aic
  &lt;chr&gt;        &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 å˜ç´”å›å¸°     0.740         0.738  15.1 1492.
2 é‡å›å¸°       0.969         0.968   5.26 1245.

æ®‹å·®çµ±è¨ˆ:
# A tibble: 1 Ã— 5
  mean_residual sd_residual  rmse   mae outliers_count
          &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;          &lt;int&gt;
1      3.42e-16        5.24  5.24  4.19              7

äºˆæ¸¬ç²¾åº¦ã®æ”¹å–„:
# A tibble: 1 Ã— 3
  simple_mae multiple_mae improvement
       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
1       12.1         4.19        65.4</div>
            </div>

            <div class="model-viz">
                <div class="viz-title">é‡å›å¸°ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬ç²¾åº¦</div>
                <svg width="600" height="300" viewBox="0 0 600 300">
                    <!-- Background -->
                    <rect width="600" height="300" fill="#1a1a1a" stroke="#ff6b9d" stroke-width="1"/>
                    
                    <!-- Title -->
                    <text x="300" y="25" text-anchor="middle" fill="#ff6b9d" font-size="16" font-weight="bold">äºˆæ¸¬å€¤ vs å®Ÿéš›å€¤</text>
                    
                    <!-- Axes -->
                    <line x1="80" y1="50" x2="80" y2="230" stroke="#333" stroke-width="1"/>
                    <line x1="80" y1="230" x2="520" y2="230" stroke="#333" stroke-width="1"/>
                    
                    <!-- Perfect prediction line -->
                    <line x1="80" y1="230" x2="520" y2="50" stroke="#00ff88" stroke-width="2" stroke-dasharray="5,5"/>
                    
                    <!-- Data points -->
                    <circle cx="120" cy="180" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="140" cy="160" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="160" cy="140" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="180" cy="130" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="200" cy="120" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="220" cy="110" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="240" cy="105" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="260" cy="100" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="280" cy="95" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="300" cy="90" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="320" cy="85" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="340" cy="80" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="360" cy="75" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="380" cy="70" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="400" cy="65" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="420" cy="60" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="440" cy="58" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="460" cy="56" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="480" cy="54" r="3" fill="#00d4ff" opacity="0.7"/>
                    <circle cx="500" cy="52" r="3" fill="#00d4ff" opacity="0.7"/>
                    
                    <!-- Labels -->
                    <text x="300" y="255" text-anchor="middle" fill="#b3b3b3" font-size="12">äºˆæ¸¬å€¤</text>
                    <text x="40" y="140" text-anchor="middle" fill="#b3b3b3" font-size="12" transform="rotate(-90 40 140)">å®Ÿéš›å€¤</text>
                    
                    <!-- Legend -->
                    <line x1="450" y1="70" x2="480" y2="70" stroke="#00ff88" stroke-width="2" stroke-dasharray="5,5"/>
                    <text x="485" y="75" fill="#b3b3b3" font-size="10">å®Œå…¨äºˆæ¸¬ç·š</text>
                    <circle cx="465" cy="85" r="3" fill="#00d4ff"/>
                    <text x="475" y="90" fill="#b3b3b3" font-size="10">äºˆæ¸¬ãƒ‡ãƒ¼ã‚¿</text>
                    
                    <!-- RÂ² value -->
                    <text x="100" y="70" fill="#ff6b9d" font-size="14" font-weight="bold">RÂ² = 0.969</text>
                </svg>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ” ä»®èª¬æ¤œå®šã¨ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«åˆ†æ</h2>

            <div class="code-container">
                <div class="code-header">tæ¤œå®šã¨åˆ†æ•£åˆ†æ</div>
                <div class="code-content">
<span class="comment"># é¡§å®¢æº€è¶³åº¦ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ</span>
<span class="function">set.seed</span>(<span class="number">456</span>)
customer_data <span class="operator">&lt;-</span> <span class="function">tibble</span>(
  customer_id <span class="operator">=</span> <span class="number">1</span>:<span class="number">300</span>,
  service_type <span class="operator">=</span> <span class="function">sample</span>(<span class="function">c</span>(<span class="string">"ãƒ™ãƒ¼ã‚·ãƒƒã‚¯"</span>, <span class="string">"ãƒ—ãƒ¬ãƒŸã‚¢ãƒ "</span>, <span class="string">"ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º"</span>), 
                        <span class="number">300</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>, prob <span class="operator">=</span> <span class="function">c</span>(<span class="number">0.5</span>, <span class="number">0.3</span>, <span class="number">0.2</span>)),
  region <span class="operator">=</span> <span class="function">sample</span>(<span class="function">c</span>(<span class="string">"é–¢æ±"</span>, <span class="string">"é–¢è¥¿"</span>, <span class="string">"ãã®ä»–"</span>), <span class="number">300</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>),
  satisfaction <span class="operator">=</span> <span class="function">case_when</span>(
    service_type <span class="operator">==</span> <span class="string">"ãƒ™ãƒ¼ã‚·ãƒƒã‚¯"</span> ~ <span class="function">rnorm</span>(<span class="function">n</span>(), <span class="number">6.5</span>, <span class="number">1.2</span>),
    service_type <span class="operator">==</span> <span class="string">"ãƒ—ãƒ¬ãƒŸã‚¢ãƒ "</span> ~ <span class="function">rnorm</span>(<span class="function">n</span>(), <span class="number">7.5</span>, <span class="number">1.0</span>),
    service_type <span class="operator">==</span> <span class="string">"ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º"</span> ~ <span class="function">rnorm</span>(<span class="function">n</span>(), <span class="number">8.2</span>, <span class="number">0.8</span>)
  ),
  monthly_usage <span class="operator">=</span> <span class="function">case_when</span>(
    service_type <span class="operator">==</span> <span class="string">"ãƒ™ãƒ¼ã‚·ãƒƒã‚¯"</span> ~ <span class="function">rpois</span>(<span class="function">n</span>(), <span class="number">15</span>),
    service_type <span class="operator">==</span> <span class="string">"ãƒ—ãƒ¬ãƒŸã‚¢ãƒ "</span> ~ <span class="function">rpois</span>(<span class="function">n</span>(), <span class="number">25</span>),
    service_type <span class="operator">==</span> <span class="string">"ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º"</span> ~ <span class="function">rpois</span>(<span class="function">n</span>(), <span class="number">40</span>)
  )
) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(satisfaction <span class="operator">=</span> <span class="function">pmax</span>(<span class="number">1</span>, <span class="function">pmin</span>(<span class="number">10</span>, satisfaction)))  <span class="comment"># 1-10ã®ç¯„å›²ã«åˆ¶é™</span>

<span class="comment"># è¨˜è¿°çµ±è¨ˆ</span>
descriptive_stats <span class="operator">&lt;-</span> customer_data <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(service_type) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    count <span class="operator">=</span> <span class="function">n</span>(),
    mean_satisfaction <span class="operator">=</span> <span class="function">mean</span>(satisfaction),
    sd_satisfaction <span class="operator">=</span> <span class="function">sd</span>(satisfaction),
    mean_usage <span class="operator">=</span> <span class="function">mean</span>(monthly_usage),
    sd_usage <span class="operator">=</span> <span class="function">sd</span>(monthly_usage),
    .groups <span class="operator">=</span> <span class="string">'drop'</span>
  )

<span class="function">print</span>(<span class="string">"ã‚µãƒ¼ãƒ“ã‚¹åˆ¥è¨˜è¿°çµ±è¨ˆ:"</span>)
<span class="function">print</span>(descriptive_stats)

<span class="comment"># tæ¤œå®šï¼ˆ2ç¾¤æ¯”è¼ƒï¼‰</span>
basic_premium_test <span class="operator">&lt;-</span> customer_data <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(service_type <span class="operator">%in%</span> <span class="function">c</span>(<span class="string">"ãƒ™ãƒ¼ã‚·ãƒƒã‚¯"</span>, <span class="string">"ãƒ—ãƒ¬ãƒŸã‚¢ãƒ "</span>)) <span class="operator">%&gt;%</span>
  <span class="function">t.test</span>(satisfaction ~ service_type, data <span class="operator">=</span> .)

<span class="function">print</span>(<span class="string">"ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ vs ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã®tæ¤œå®š:"</span>)
<span class="function">print</span>(<span class="function">tidy</span>(basic_premium_test))

<span class="comment"># åˆ†æ•£åˆ†æï¼ˆANOVAï¼‰</span>
anova_model <span class="operator">&lt;-</span> <span class="function">aov</span>(satisfaction ~ service_type, data <span class="operator">=</span> customer_data)
anova_results <span class="operator">&lt;-</span> <span class="function">tidy</span>(anova_model)

<span class="function">print</span>(<span class="string">"ã‚µãƒ¼ãƒ“ã‚¹åˆ¥æº€è¶³åº¦ã®åˆ†æ•£åˆ†æ:"</span>)
<span class="function">print</span>(anova_results)

<span class="comment"># å¤šé‡æ¯”è¼ƒï¼ˆTukey HSDï¼‰</span>
tukey_results <span class="operator">&lt;-</span> <span class="function">TukeyHSD</span>(anova_model)
tukey_tidy <span class="operator">&lt;-</span> <span class="function">tidy</span>(tukey_results)

<span class="function">print</span>(<span class="string">"å¤šé‡æ¯”è¼ƒçµæœ:"</span>)
<span class="function">print</span>(tukey_tidy)

<span class="comment"># ã‚«ã‚¤äºŒä¹—æ¤œå®šï¼ˆåœ°åŸŸã¨ã‚µãƒ¼ãƒ“ã‚¹ç¨®åˆ¥ã®é–¢é€£æ€§ï¼‰</span>
contingency_table <span class="operator">&lt;-</span> customer_data <span class="operator">%&gt;%</span>
  <span class="function">count</span>(region, service_type) <span class="operator">%&gt;%</span>
  <span class="function">pivot_wider</span>(names_from <span class="operator">=</span> service_type, values_from <span class="operator">=</span> n, values_fill <span class="operator">=</span> <span class="number">0</span>)

<span class="function">print</span>(<span class="string">"åœ°åŸŸåˆ¥ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨çŠ¶æ³:"</span>)
<span class="function">print</span>(contingency_table)

<span class="comment"># ã‚«ã‚¤äºŒä¹—æ¤œå®šã®å®Ÿè¡Œ</span>
chi_square_test <span class="operator">&lt;-</span> customer_data <span class="operator">%&gt;%</span>
  <span class="function">select</span>(region, service_type) <span class="operator">%&gt;%</span>
  <span class="function">table</span>() <span class="operator">%&gt;%</span>
  <span class="function">chisq.test</span>()

<span class="function">print</span>(<span class="string">"ã‚«ã‚¤äºŒä¹—æ¤œå®šçµæœ:"</span>)
<span class="function">print</span>(<span class="function">tidy</span>(chi_square_test))

<span class="comment"># åŠ¹æœé‡ã®è¨ˆç®—ï¼ˆCohen's dï¼‰</span>
cohens_d_calculation <span class="operator">&lt;-</span> customer_data <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(service_type <span class="operator">%in%</span> <span class="function">c</span>(<span class="string">"ãƒ™ãƒ¼ã‚·ãƒƒã‚¯"</span>, <span class="string">"ãƒ—ãƒ¬ãƒŸã‚¢ãƒ "</span>)) <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(service_type) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    mean_sat <span class="operator">=</span> <span class="function">mean</span>(satisfaction),
    sd_sat <span class="operator">=</span> <span class="function">sd</span>(satisfaction),
    n <span class="operator">=</span> <span class="function">n</span>(),
    .groups <span class="operator">=</span> <span class="string">'drop'</span>
  )

<span class="comment"># Cohen's dã®æ‰‹å‹•è¨ˆç®—</span>
mean_diff <span class="operator">&lt;-</span> cohens_d_calculation$mean_sat[<span class="number">2</span>] <span class="operator">-</span> cohens_d_calculation$mean_sat[<span class="number">1</span>]
pooled_sd <span class="operator">&lt;-</span> <span class="function">sqrt</span>(((cohens_d_calculation$n[<span class="number">1</span>] <span class="operator">-</span> <span class="number">1</span>) <span class="operator">*</span> cohens_d_calculation$sd_sat[<span class="number">1</span>]^<span class="number">2</span> <span class="operator">+</span> 
                      (cohens_d_calculation$n[<span class="number">2</span>] <span class="operator">-</span> <span class="number">1</span>) <span class="operator">*</span> cohens_d_calculation$sd_sat[<span class="number">2</span>]^<span class="number">2</span>) /
                     (cohens_d_calculation$n[<span class="number">1</span>] <span class="operator">+</span> cohens_d_calculation$n[<span class="number">2</span>] <span class="operator">-</span> <span class="number">2</span>))
cohens_d <span class="operator">&lt;-</span> mean_diff / pooled_sd

<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"Cohen's d (ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ vs ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ):"</span>, <span class="function">round</span>(cohens_d, <span class="number">3</span>)))
</div>
            </div>

            <div class="output-container">
                <div class="output-header">ä»®èª¬æ¤œå®šçµæœ</div>
                <div class="output-content">ã‚µãƒ¼ãƒ“ã‚¹åˆ¥è¨˜è¿°çµ±è¨ˆ:
# A tibble: 3 Ã— 6
  service_type    count mean_satisfaction sd_satisfaction mean_usage sd_usage
  &lt;chr&gt;           &lt;int&gt;              &lt;dbl&gt;           &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
1 ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º   60               8.21           0.788       40.1     6.15
2 ãƒ™ãƒ¼ã‚·ãƒƒã‚¯       147               6.49           1.17        15.0     3.82
3 ãƒ—ãƒ¬ãƒŸã‚¢ãƒ         93               7.51           0.975       25.1     4.93

ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ vs ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã®tæ¤œå®š:
# A tibble: 1 Ã— 10
  estimate estimate1 estimate2 statistic  p.value parameter conf.low conf.high method                  alternative
     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      
1    -1.02      6.49      7.51     -7.56 4.01e-13      217.    -1.29    -0.760 Welch Two Sample t-test two.sided  

ã‚µãƒ¼ãƒ“ã‚¹åˆ¥æº€è¶³åº¦ã®åˆ†æ•£åˆ†æ:
# A tibble: 2 Ã— 6
  term         df sumsq meansq statistic   p.value
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 service_type     2  89.9   45.0      39.8  2.78e-16
2 Residuals      297 335.    1.13      NA   NA      

å¤šé‡æ¯”è¼ƒçµæœ:
# A tibble: 3 Ã— 7
  term         contrast                    null.value estimate conf.low conf.high adj.p.value
  &lt;chr&gt;        &lt;chr&gt;                            &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 service_type ãƒ™ãƒ¼ã‚·ãƒƒã‚¯-ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º           0    -1.72    -2.05     -1.39    6.88e-16
2 service_type ãƒ—ãƒ¬ãƒŸã‚¢ãƒ -ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º           0    -0.701   -1.09     -0.312   2.39e- 4
3 service_type ãƒ—ãƒ¬ãƒŸã‚¢ãƒ -ãƒ™ãƒ¼ã‚·ãƒƒã‚¯                 0     1.02     0.745     1.30    2.95e-11

Cohen's d (ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ vs ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ): 0.949</div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ“ˆ ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã¨ãƒ¢ãƒ‡ãƒ«è©•ä¾¡</h2>

            <div class="code-container">
                <div class="code-header">é¡§å®¢é›¢è„±äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«</div>
                <div class="code-content">
<span class="comment"># é¡§å®¢é›¢è„±ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ</span>
<span class="function">set.seed</span>(<span class="number">789</span>)
churn_data <span class="operator">&lt;-</span> customer_data <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    contract_length <span class="operator">=</span> <span class="function">sample</span>(<span class="number">1</span>:<span class="number">36</span>, <span class="function">n</span>(), replace <span class="operator">=</span> <span class="variable">TRUE</span>),
    support_calls <span class="operator">=</span> <span class="function">rpois</span>(<span class="function">n</span>(), <span class="number">2</span>),
    <span class="comment"># é›¢è„±ç¢ºç‡ã‚’è¤‡æ•°è¦å› ã§æ±ºå®š</span>
    churn_prob <span class="operator">=</span> <span class="function">plogis</span>(
      <span class="number">-2</span> <span class="operator">+</span> 
      <span class="function">ifelse</span>(service_type <span class="operator">==</span> <span class="string">"ãƒ™ãƒ¼ã‚·ãƒƒã‚¯"</span>, <span class="number">1</span>, <span class="number">0</span>) <span class="operator">+</span>
      (<span class="number">10</span> <span class="operator">-</span> satisfaction) <span class="operator">*</span> <span class="number">0.3</span> <span class="operator">+</span>
      support_calls <span class="operator">*</span> <span class="number">0.2</span> <span class="operator">-</span>
      contract_length <span class="operator">*</span> <span class="number">0.05</span>
    ),
    churned <span class="operator">=</span> <span class="function">rbinom</span>(<span class="function">n</span>(), <span class="number">1</span>, churn_prob)
  ) <span class="operator">%&gt;%</span>
  <span class="function">select</span>(-churn_prob)

<span class="comment"># é›¢è„±ç‡ã®ç¢ºèª</span>
churn_summary <span class="operator">&lt;-</span> churn_data <span class="operator">%&gt;%</span>
  <span class="function">group_by</span>(service_type) <span class="operator">%&gt;%</span>
  <span class="function">summarise</span>(
    total_customers <span class="operator">=</span> <span class="function">n</span>(),
    churned_customers <span class="operator">=</span> <span class="function">sum</span>(churned),
    churn_rate <span class="operator">=</span> <span class="function">mean</span>(churned),
    .groups <span class="operator">=</span> <span class="string">'drop'</span>
  )

<span class="function">print</span>(<span class="string">"ã‚µãƒ¼ãƒ“ã‚¹åˆ¥é›¢è„±ç‡:"</span>)
<span class="function">print</span>(churn_summary)

<span class="comment"># ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ãƒ¢ãƒ‡ãƒ«</span>
logistic_model <span class="operator">&lt;-</span> <span class="function">glm</span>(
  churned ~ satisfaction <span class="operator">+</span> monthly_usage <span class="operator">+</span> support_calls <span class="operator">+</span> contract_length <span class="operator">+</span> service_type,
  data <span class="operator">=</span> churn_data,
  family <span class="operator">=</span> <span class="function">binomial</span>()
)

<span class="comment"># ãƒ¢ãƒ‡ãƒ«çµæœã®æ•´ç†</span>
logistic_summary <span class="operator">&lt;-</span> <span class="function">tidy</span>(logistic_model, exponentiate <span class="operator">=</span> <span class="variable">TRUE</span>)
logistic_metrics <span class="operator">&lt;-</span> <span class="function">glance</span>(logistic_model)

<span class="function">print</span>(<span class="string">"ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°çµæœï¼ˆã‚ªãƒƒã‚ºæ¯”ï¼‰:"</span>)
<span class="function">print</span>(logistic_summary)

<span class="comment"># äºˆæ¸¬ã¨è©•ä¾¡</span>
predictions <span class="operator">&lt;-</span> churn_data <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    predicted_prob <span class="operator">=</span> <span class="function">predict</span>(logistic_model, type <span class="operator">=</span> <span class="string">"response"</span>),
    predicted_class <span class="operator">=</span> <span class="function">ifelse</span>(predicted_prob <span class="operator">&gt;</span> <span class="number">0.5</span>, <span class="number">1</span>, <span class="number">0</span>)
  )

<span class="comment"># æ··åŒè¡Œåˆ—</span>
confusion_matrix <span class="operator">&lt;-</span> predictions <span class="operator">%&gt;%</span>
  <span class="function">count</span>(churned, predicted_class) <span class="operator">%&gt;%</span>
  <span class="function">pivot_wider</span>(names_from <span class="operator">=</span> predicted_class, values_from <span class="operator">=</span> n, values_fill <span class="operator">=</span> <span class="number">0</span>) <span class="operator">%&gt;%</span>
  <span class="function">rename</span>(predicted_0 <span class="operator">=</span> <span class="string">"0"</span>, predicted_1 <span class="operator">=</span> <span class="string">"1"</span>)

<span class="function">print</span>(<span class="string">"æ··åŒè¡Œåˆ—:"</span>)
<span class="function">print</span>(confusion_matrix)

<span class="comment"># ãƒ¢ãƒ‡ãƒ«è©•ä¾¡æŒ‡æ¨™</span>
TP <span class="operator">&lt;-</span> confusion_matrix <span class="operator">%&gt;%</span> <span class="function">filter</span>(churned <span class="operator">==</span> <span class="number">1</span>) <span class="operator">%&gt;%</span> <span class="function">pull</span>(predicted_1)
TN <span class="operator">&lt;-</span> confusion_matrix <span class="operator">%&gt;%</span> <span class="function">filter</span>(churned <span class="operator">==</span> <span class="number">0</span>) <span class="operator">%&gt;%</span> <span class="function">pull</span>(predicted_0)
FP <span class="operator">&lt;-</span> confusion_matrix <span class="operator">%&gt;%</span> <span class="function">filter</span>(churned <span class="operator">==</span> <span class="number">0</span>) <span class="operator">%&gt;%</span> <span class="function">pull</span>(predicted_1)
FN <span class="operator">&lt;-</span> confusion_matrix <span class="operator">%&gt;%</span> <span class="function">filter</span>(churned <span class="operator">==</span> <span class="number">1</span>) <span class="operator">%&gt;%</span> <span class="function">pull</span>(predicted_0)

model_evaluation <span class="operator">&lt;-</span> <span class="function">tibble</span>(
  metric <span class="operator">=</span> <span class="function">c</span>(<span class="string">"Accuracy"</span>, <span class="string">"Precision"</span>, <span class="string">"Recall"</span>, <span class="string">"F1-Score"</span>, <span class="string">"Specificity"</span>),
  value <span class="operator">=</span> <span class="function">c</span>(
    (TP <span class="operator">+</span> TN) / (TP <span class="operator">+</span> TN <span class="operator">+</span> FP <span class="operator">+</span> FN),  <span class="comment"># Accuracy</span>
    TP / (TP <span class="operator">+</span> FP),                      <span class="comment"># Precision</span>
    TP / (TP <span class="operator">+</span> FN),                      <span class="comment"># Recall</span>
    <span class="number">2</span> <span class="operator">*</span> (TP / (TP <span class="operator">+</span> FP)) <span class="operator">*</span> (TP / (TP <span class="operator">+</span> FN)) / ((TP / (TP <span class="operator">+</span> FP)) <span class="operator">+</span> (TP / (TP <span class="operator">+</span> FN))),  <span class="comment"># F1</span>
    TN / (TN <span class="operator">+</span> FP)                       <span class="comment"># Specificity</span>
  )
)

<span class="function">print</span>(<span class="string">"ãƒ¢ãƒ‡ãƒ«è©•ä¾¡æŒ‡æ¨™:"</span>)
<span class="function">print</span>(model_evaluation)

<span class="comment"># ç‰¹å¾´é‡é‡è¦åº¦ï¼ˆã‚ªãƒƒã‚ºæ¯”ã®è§£é‡ˆï¼‰</span>
feature_importance <span class="operator">&lt;-</span> logistic_summary <span class="operator">%&gt;%</span>
  <span class="function">filter</span>(term <span class="operator">!=</span> <span class="string">"(Intercept)"</span>) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    importance <span class="operator">=</span> <span class="function">abs</span>(<span class="function">log</span>(estimate)),
    direction <span class="operator">=</span> <span class="function">ifelse</span>(estimate <span class="operator">&gt;</span> <span class="number">1</span>, <span class="string">"é›¢è„±ä¿ƒé€²"</span>, <span class="string">"é›¢è„±æŠ‘åˆ¶"</span>)
  ) <span class="operator">%&gt;%</span>
  <span class="function">arrange</span>(<span class="function">desc</span>(importance))

<span class="function">print</span>(<span class="string">"ç‰¹å¾´é‡é‡è¦åº¦:"</span>)
<span class="function">print</span>(feature_importance)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°çµæœ</div>
                <div class="output-content">ã‚µãƒ¼ãƒ“ã‚¹åˆ¥é›¢è„±ç‡:
# A tibble: 3 Ã— 4
  service_type     total_customers churned_customers churn_rate
  &lt;chr&gt;                      &lt;int&gt;             &lt;int&gt;      &lt;dbl&gt;
1 ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º              60                 4     0.0667
2 ãƒ™ãƒ¼ã‚·ãƒƒã‚¯                  147                45     0.306 
3 ãƒ—ãƒ¬ãƒŸã‚¢ãƒ                    93                17     0.183 

ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°çµæœï¼ˆã‚ªãƒƒã‚ºæ¯”ï¼‰:
# A tibble: 6 Ã— 5
  term                        estimate std.error statistic  p.value
  &lt;chr&gt;                          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)                  125.       1.30      4.83  1.37e- 6
2 satisfaction                   0.478    0.175    -4.02  5.84e- 5
3 monthly_usage                  0.987    0.0245   -0.538 5.91e- 1
4 support_calls                  1.23     0.152     1.37  1.70e- 1
5 contract_length                0.944    0.0285   -2.03  4.23e- 2
6 service_typeãƒ—ãƒ¬ãƒŸã‚¢ãƒ          0.548    0.374    -1.61  1.07e- 1

æ··åŒè¡Œåˆ—:
# A tibble: 2 Ã— 3
  churned predicted_0 predicted_1
    &lt;int&gt;       &lt;int&gt;       &lt;int&gt;
1       0         220          14
2       1          40          26

ãƒ¢ãƒ‡ãƒ«è©•ä¾¡æŒ‡æ¨™:
# A tibble: 5 Ã— 2
  metric      value
  &lt;chr&gt;       &lt;dbl&gt;
1 Accuracy    0.820
2 Precision   0.650
3 Recall      0.394
4 F1-Score    0.491
5 Specificity 0.940</div>
            </div>

            <div class="data-table">
                <table>
                    <thead>
                        <tr>
                            <th>çµ±è¨ˆæ‰‹æ³•</th>
                            <th>ç”¨é€”</th>
                            <th>å‰ææ¡ä»¶</th>
                            <th>Tidyverseé–¢æ•°</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ç·šå½¢å›å¸°</td>
                            <td>é€£ç¶šå€¤äºˆæ¸¬</td>
                            <td>ç·šå½¢é–¢ä¿‚ã€æ­£è¦åˆ†å¸ƒæ®‹å·®</td>
                            <td>lm() + broom::tidy()</td>
                        </tr>
                        <tr>
                            <td>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</td>
                            <td>åˆ†é¡å•é¡Œ</td>
                            <td>ç‹¬ç«‹æ€§ã€å¤šé‡å…±ç·šæ€§ãªã—</td>
                            <td>glm(family=binomial)</td>
                        </tr>
                        <tr>
                            <td>tæ¤œå®š</td>
                            <td>2ç¾¤æ¯”è¼ƒ</td>
                            <td>æ­£è¦åˆ†å¸ƒã€ç­‰åˆ†æ•£æ€§</td>
                            <td>t.test() + broom::tidy()</td>
                        </tr>
                        <tr>
                            <td>ANOVA</td>
                            <td>å¤šç¾¤æ¯”è¼ƒ</td>
                            <td>æ­£è¦åˆ†å¸ƒã€ç­‰åˆ†æ•£æ€§</td>
                            <td>aov() + broom::tidy()</td>
                        </tr>
                        <tr>
                            <td>ã‚«ã‚¤äºŒä¹—æ¤œå®š</td>
                            <td>é–¢é€£æ€§æ¤œå®š</td>
                            <td>æœŸå¾…åº¦æ•°â‰¥5</td>
                            <td>chisq.test() + tidy()</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <div class="key-points">
            <h4>ç¬¬10ç« ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆ</h4>
            <ul>
                <li><strong>broomçµ±åˆ</strong>ï¼štidy(), glance(), augment()ã§ãƒ¢ãƒ‡ãƒ«çµæœã‚’æ•´ç†</li>
                <li><strong>å›å¸°åˆ†æ</strong>ï¼šç·šå½¢ãƒ»ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã«ã‚ˆã‚‹äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰</li>
                <li><strong>ä»®èª¬æ¤œå®š</strong>ï¼štæ¤œå®šã€ANOVAã€ã‚«ã‚¤äºŒä¹—æ¤œå®šã«ã‚ˆã‚‹çµ±è¨ˆçš„æ¨è«–</li>
                <li><strong>ãƒ¢ãƒ‡ãƒ«è©•ä¾¡</strong>ï¼šç²¾åº¦ã€å†ç¾ç‡ã€F1ã‚¹ã‚³ã‚¢ç­‰ã®åŒ…æ‹¬çš„è©•ä¾¡</li>
                <li><strong>åŠ¹æœé‡</strong>ï¼šçµ±è¨ˆçš„æœ‰æ„æ€§ã¨å®Ÿéš›çš„æ„ç¾©ã®ä¸¡é¢è©•ä¾¡</li>
                <li><strong>äºˆæ¸¬ç²¾åº¦</strong>ï¼šæ®‹å·®åˆ†æã¨äº¤å·®æ¤œè¨¼ã«ã‚ˆã‚‹äºˆæ¸¬æ€§èƒ½å‘ä¸Š</li>
            </ul>
        </div>

        <div class="tip-box">
            <h4>å®Ÿè·µçš„ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h4>
            <p>çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†ã¨ä»®å®šã®ç¢ºèªãŒæ¥µã‚ã¦é‡è¦ã§ã™ã€‚broomãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€è¤‡æ•°ãƒ¢ãƒ‡ãƒ«ã®æ¯”è¼ƒã‚„çµæœã®å¯è¦–åŒ–ãŒåŠ¹ç‡çš„ã«è¡Œãˆã¾ã™ã€‚ã¾ãŸã€æ¥­å‹™ã§ã®æ„æ€æ±ºå®šã«ã¯çµ±è¨ˆçš„æœ‰æ„æ€§ã ã‘ã§ãªãåŠ¹æœé‡ã‚‚è€ƒæ…®ã—ã¾ã—ã‚‡ã†ã€‚</p>
        </div>

        <nav class="chapter-nav">
            <a href="chapter9-tibble-modern-dataframe.html" class="nav-button">â† ç¬¬9ç« </a>
            <a href="chapter11-machine-learning.html" class="nav-button">ç¬¬11ç«  â†’</a>
        </nav>
    </div>
</body>
</html>