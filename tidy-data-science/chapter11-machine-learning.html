<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬11ç« : æ©Ÿæ¢°å­¦ç¿’ã¨tidymodels | Tidyverseå®Œå…¨ãƒã‚¹ã‚¿ãƒ¼</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family@Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --accent-neon: #00ff88;
            --accent-cyan: #00d4ff;
            --accent-purple: #9d4edd;
            --accent-orange: #ff8c42;
            --accent-electric: #00ff41;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --border-neon: #00ff88;
            --shadow-neon: 0 0 20px #00ff8840;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: linear-gradient(45deg, var(--bg-secondary), var(--bg-tertiary));
            border-radius: 20px;
            border: 2px solid var(--accent-electric);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.4);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 65, 0.1), transparent);
            animation: scan 3s infinite;
        }

        @keyframes scan {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        h1 {
            font-size: 3rem;
            font-weight: 700;
            color: var(--accent-electric);
            margin-bottom: 10px;
            text-shadow: 0 0 20px var(--accent-electric);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.4rem;
            color: var(--accent-cyan);
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .chapter-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            position: relative;
            z-index: 1;
        }

        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: 3px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .progress-dot {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            border: 1px solid var(--text-secondary);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--accent-electric);
            border-color: var(--accent-electric);
            box-shadow: 0 0 5px var(--accent-electric);
        }

        .progress-dot.completed {
            background: var(--accent-cyan);
            border-color: var(--accent-cyan);
        }

        /* Navigation Widget */
        .chapter-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 3px;
            margin: 30px 0;
            padding: 6px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--accent-electric);
            width: fit-content;
            max-width: 90vw;
            margin-left: auto;
            margin-right: auto;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 1px 5px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            text-decoration: none;
            border-radius: 2px;
            border: 1px solid var(--accent-cyan);
            transition: all 0.3s ease;
            font-size: 0.65rem;
            white-space: nowrap;
        }

        .nav-button:hover {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            box-shadow: 0 0 6px var(--accent-cyan);
        }

        .nav-button.current {
            background: var(--accent-electric);
            color: var(--bg-primary);
            box-shadow: 0 0 6px var(--accent-electric);
        }

        /* Content Sections */
        .section {
            background: var(--bg-secondary);
            margin: 30px 0;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid var(--accent-purple);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-electric), var(--accent-cyan), var(--accent-purple));
            border-radius: 15px 15px 0 0;
        }

        h2 {
            color: var(--accent-electric);
            font-size: 2rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--accent-electric);
        }

        h3 {
            color: var(--accent-cyan);
            font-size: 1.5rem;
            margin: 25px 0 15px 0;
            text-shadow: 0 0 8px var(--accent-cyan);
        }

        h4 {
            color: var(--accent-purple);
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
        }

        /* Code Blocks */
        .code-container {
            margin: 20px 0;
            background: #1a1a1a;
            border-radius: 10px;
            border: 1px solid var(--accent-electric);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 255, 65, 0.1);
        }

        .code-header {
            background: var(--accent-electric);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-header::before {
            content: 'ğŸ¤–';
            font-size: 1.1rem;
        }

        .code-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            background: #0d1117;
            color: #c9d1d9;
            overflow-x: auto;
        }

        /* Syntax highlighting */
        .keyword { color: #ff7b72; }
        .function { color: #d2a8ff; }
        .string { color: #a5d6ff; }
        .comment { color: #8b949e; font-style: italic; }
        .operator { color: #f85149; }
        .number { color: #79c0ff; }
        .variable { color: #ffa657; }

        /* Output Display */
        .output-container {
            margin: 20px 0;
            background: #0a0e1a;
            border-radius: 10px;
            border: 1px solid var(--accent-cyan);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.1);
        }

        .output-header {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .output-header::before {
            content: 'ğŸ§ ';
        }

        .output-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--accent-cyan);
        }

        /* ML Workflow */
        .ml-workflow {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--accent-purple);
        }

        .workflow-title {
            color: var(--accent-purple);
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .workflow-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .workflow-step {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--accent-cyan);
            text-align: center;
        }

        .step-number {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 10px;
        }

        /* Data Tables */
        .data-table {
            margin: 20px 0;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-tertiary);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid var(--accent-electric);
        }

        th {
            background: var(--accent-electric);
            color: var(--bg-primary);
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--bg-secondary);
            color: var(--text-primary);
        }

        tr:nth-child(even) {
            background: rgba(0, 255, 65, 0.05);
        }

        tr:hover {
            background: rgba(0, 255, 65, 0.1);
        }

        /* Key Points */
        .key-points {
            background: linear-gradient(135deg, rgba(0, 255, 65, 0.1) 0%, rgba(0, 212, 255, 0.1) 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-electric);
        }

        .key-points h4 {
            color: var(--accent-electric);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .key-points h4::before {
            content: 'ğŸ’¡';
        }

        .key-points ul {
            list-style: none;
            padding-left: 0;
        }

        .key-points li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .key-points li::before {
            content: 'â–¶';
            color: var(--accent-cyan);
            position: absolute;
            left: 0;
        }

        /* Warning/Tip boxes */
        .tip-box {
            background: rgba(157, 78, 221, 0.1);
            border: 1px solid var(--accent-purple);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-purple);
        }

        .tip-box h4 {
            color: var(--accent-purple);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tip-box h4::before {
            content: 'âš ï¸';
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }

            .chapter-meta {
                flex-direction: column;
                gap: 10px;
            }

            .chapter-nav {
                gap: 2px;
                padding: 4px;
            }

            .nav-button {
                padding: 1px 3px;
                font-size: 0.6rem;
            }

            .section {
                padding: 20px;
                margin: 20px 0;
            }

            h2 {
                font-size: 1.5rem;
            }

            .workflow-steps {
                grid-template-columns: 1fr;
            }

            .code-content, .output-content {
                font-size: 0.85rem;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ç¬¬11ç« : æ©Ÿæ¢°å­¦ç¿’ã¨tidymodels</h1>
            <p class="subtitle">Tidyverseã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚‹æ©Ÿæ¢°å­¦ç¿’</p>
            <div class="chapter-meta">
                <span>ğŸ¤– ãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰</span>
                <span>ğŸ”¬ ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</span>
                <span>âš¡ ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´</span>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>
        </header>

        <nav class="chapter-nav">
            <a href="chapter1-tidyverse-overview.html" class="nav-button">1</a>
            <a href="chapter2-dplyr-data-manipulation.html" class="nav-button">2</a>
            <a href="chapter3-ggplot2-visualization.html" class="nav-button">3</a>
            <a href="chapter4-tidyr-data-reshaping.html" class="nav-button">4</a>
            <a href="chapter5-stringr-text-processing.html" class="nav-button">5</a>
            <a href="chapter6-forcats-purrr-advanced.html" class="nav-button">6</a>
            <a href="chapter7-lubridate-datetime.html" class="nav-button">7</a>
            <a href="chapter8-readr-data-import.html" class="nav-button">8</a>
            <a href="chapter9-tibble-modern-dataframe.html" class="nav-button">9</a>
            <a href="chapter10-statistics-modeling.html" class="nav-button">10</a>
            <a href="#" class="nav-button current">11</a>
            <a href="chapter12-time-series.html" class="nav-button">12</a>
        </nav>

        <section class="section">
            <h2>ğŸ¤– tidymodelsã®åŸºç¤</h2>
            
            <p>tidymodelsã¯ã€Tidyverseã®å“²å­¦ã«åŸºã¥ã„ãŸæ©Ÿæ¢°å­¦ç¿’ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚ä¸€è²«ã—ãŸAPIã§æ§˜ã€…ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’çµ±ä¸€çš„ã«æ‰±ãˆã¾ã™ã€‚</p>

            <div class="ml-workflow">
                <div class="workflow-title">æ©Ÿæ¢°å­¦ç¿’ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</div>
                <div class="workflow-steps">
                    <div class="workflow-step">
                        <div class="step-number">1</div>
                        <div>ãƒ‡ãƒ¼ã‚¿åˆ†å‰²</div>
                        <small>initial_split()</small>
                    </div>
                    <div class="workflow-step">
                        <div class="step-number">2</div>
                        <div>å‰å‡¦ç†</div>
                        <small>recipe()</small>
                    </div>
                    <div class="workflow-step">
                        <div class="step-number">3</div>
                        <div>ãƒ¢ãƒ‡ãƒ«å®šç¾©</div>
                        <small>linear_reg()</small>
                    </div>
                    <div class="workflow-step">
                        <div class="step-number">4</div>
                        <div>ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</div>
                        <small>workflow()</small>
                    </div>
                    <div class="workflow-step">
                        <div class="step-number">5</div>
                        <div>å­¦ç¿’</div>
                        <small>fit()</small>
                    </div>
                    <div class="workflow-step">
                        <div class="step-number">6</div>
                        <div>äºˆæ¸¬ãƒ»è©•ä¾¡</div>
                        <small>predict()</small>
                    </div>
                </div>
            </div>

            <h3>åŸºæœ¬çš„ãªå›å¸°ãƒ¢ãƒ‡ãƒ«</h3>

            <div class="code-container">
                <div class="code-header">tidymodelsã«ã‚ˆã‚‹å›å¸°åˆ†æ</div>
                <div class="code-content">
<span class="keyword">library</span>(<span class="string">tidymodels</span>)
<span class="keyword">library</span>(<span class="string">tidyverse</span>)

<span class="comment"># ä½å®…ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ</span>
<span class="function">set.seed</span>(<span class="number">123</span>)
housing_data <span class="operator">&lt;-</span> <span class="function">tibble</span>(
  size <span class="operator">=</span> <span class="function">runif</span>(<span class="number">1000</span>, <span class="number">50</span>, <span class="number">300</span>),
  age <span class="operator">=</span> <span class="function">runif</span>(<span class="number">1000</span>, <span class="number">0</span>, <span class="number">50</span>),
  distance_station <span class="operator">=</span> <span class="function">runif</span>(<span class="number">1000</span>, <span class="number">1</span>, <span class="number">30</span>),
  bedrooms <span class="operator">=</span> <span class="function">sample</span>(<span class="number">1</span>:<span class="number">5</span>, <span class="number">1000</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>),
  location <span class="operator">=</span> <span class="function">sample</span>(<span class="function">c</span>(<span class="string">"éƒ½å¿ƒ"</span>, <span class="string">"éƒŠå¤–"</span>, <span class="string">"åœ°æ–¹"</span>), <span class="number">1000</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>),
  price <span class="operator">=</span> <span class="number">50</span> <span class="operator">+</span> size <span class="operator">*</span> <span class="number">0.8</span> <span class="operator">-</span> age <span class="operator">*</span> <span class="number">1.2</span> <span class="operator">-</span> distance_station <span class="operator">*</span> <span class="number">2</span> <span class="operator">+</span> bedrooms <span class="operator">*</span> <span class="number">10</span> <span class="operator">+</span> 
           <span class="function">ifelse</span>(location <span class="operator">==</span> <span class="string">"éƒ½å¿ƒ"</span>, <span class="number">50</span>, <span class="function">ifelse</span>(location <span class="operator">==</span> <span class="string">"éƒŠå¤–"</span>, <span class="number">20</span>, <span class="number">0</span>)) <span class="operator">+</span>
           <span class="function">rnorm</span>(<span class="number">1000</span>, <span class="number">0</span>, <span class="number">20</span>)
) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(price <span class="operator">=</span> <span class="function">pmax</span>(price, <span class="number">30</span>))

<span class="function">print</span>(<span class="function">head</span>(housing_data))

<span class="comment"># 1. ãƒ‡ãƒ¼ã‚¿åˆ†å‰²</span>
data_split <span class="operator">&lt;-</span> <span class="function">initial_split</span>(housing_data, prop <span class="operator">=</span> <span class="number">0.8</span>, strata <span class="operator">=</span> location)
train_data <span class="operator">&lt;-</span> <span class="function">training</span>(data_split)
test_data <span class="operator">&lt;-</span> <span class="function">testing</span>(data_split)

<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"è¨“ç·´ãƒ‡ãƒ¼ã‚¿:"</span>, <span class="function">nrow</span>(train_data), <span class="string">"ä»¶"</span>))
<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿:"</span>, <span class="function">nrow</span>(test_data), <span class="string">"ä»¶"</span>))

<span class="comment"># 2. å‰å‡¦ç†ãƒ¬ã‚·ãƒ”</span>
housing_recipe <span class="operator">&lt;-</span> <span class="function">recipe</span>(price ~ ., data <span class="operator">=</span> train_data) <span class="operator">%&gt;%</span>
  <span class="function">step_dummy</span>(<span class="function">all_nominal_predictors</span>()) <span class="operator">%&gt;%</span>  <span class="comment"># ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã‚’ãƒ€ãƒŸãƒ¼åŒ–</span>
  <span class="function">step_normalize</span>(<span class="function">all_numeric_predictors</span>()) <span class="operator">%&gt;%</span>  <span class="comment"># æ•°å€¤å¤‰æ•°ã‚’æ­£è¦åŒ–</span>
  <span class="function">step_interact</span>(~ size:bedrooms)  <span class="comment"># äº¤äº’ä½œç”¨é …ã®è¿½åŠ </span>

<span class="function">print</span>(<span class="string">"å‰å‡¦ç†ãƒ¬ã‚·ãƒ”:"</span>)
<span class="function">print</span>(housing_recipe)

<span class="comment"># 3. ãƒ¢ãƒ‡ãƒ«å®šç¾©</span>
linear_model <span class="operator">&lt;-</span> <span class="function">linear_reg</span>() <span class="operator">%&gt;%</span>
  <span class="function">set_engine</span>(<span class="string">"lm"</span>) <span class="operator">%&gt;%</span>
  <span class="function">set_mode</span>(<span class="string">"regression"</span>)

<span class="comment"># 4. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®æ§‹ç¯‰</span>
housing_workflow <span class="operator">&lt;-</span> <span class="function">workflow</span>() <span class="operator">%&gt;%</span>
  <span class="function">add_recipe</span>(housing_recipe) <span class="operator">%&gt;%</span>
  <span class="function">add_model</span>(linear_model)

<span class="function">print</span>(<span class="string">"ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼:"</span>)
<span class="function">print</span>(housing_workflow)

<span class="comment"># 5. ãƒ¢ãƒ‡ãƒ«å­¦ç¿’</span>
housing_fit <span class="operator">&lt;-</span> <span class="function">fit</span>(housing_workflow, data <span class="operator">=</span> train_data)

<span class="comment"># 6. äºˆæ¸¬ã¨è©•ä¾¡</span>
train_predictions <span class="operator">&lt;-</span> <span class="function">predict</span>(housing_fit, train_data) <span class="operator">%&gt;%</span>
  <span class="function">bind_cols</span>(train_data)

test_predictions <span class="operator">&lt;-</span> <span class="function">predict</span>(housing_fit, test_data) <span class="operator">%&gt;%</span>
  <span class="function">bind_cols</span>(test_data)

<span class="comment"># è©•ä¾¡æŒ‡æ¨™ã®è¨ˆç®—</span>
train_metrics <span class="operator">&lt;-</span> train_predictions <span class="operator">%&gt;%</span>
  <span class="function">metrics</span>(truth <span class="operator">=</span> price, estimate <span class="operator">=</span> .pred)

test_metrics <span class="operator">&lt;-</span> test_predictions <span class="operator">%&gt;%</span>
  <span class="function">metrics</span>(truth <span class="operator">=</span> price, estimate <span class="operator">=</span> .pred)

<span class="function">print</span>(<span class="string">"è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®è©•ä¾¡:"</span>)
<span class="function">print</span>(train_metrics)

<span class="function">print</span>(<span class="string">"ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®è©•ä¾¡:"</span>)
<span class="function">print</span>(test_metrics)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">tidymodelså›å¸°çµæœ</div>
                <div class="output-content"># A tibble: 6 Ã— 6
   size   age distance_station bedrooms location price
  &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt;    &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;
1  142.  14.6             7.36        3 éƒŠå¤–      190.
2  243.  17.4            18.9         2 åœ°æ–¹      155.
3  169.  12.3            15.3         4 éƒ½å¿ƒ      213.
4  159.  29.5             2.68        1 åœ°æ–¹      135.
5   96.4 15.2            14.7         3 éƒŠå¤–      105.
6  163.  22.9            12.7         2 åœ°æ–¹      142.

[1] "è¨“ç·´ãƒ‡ãƒ¼ã‚¿: 800 ä»¶"
[1] "ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿: 200 ä»¶"

å‰å‡¦ç†ãƒ¬ã‚·ãƒ”:
Recipe for price

Inputs:
      role #variables
   outcome          1
 predictor          5

Operations:
step_dummy(all_nominal_predictors())
step_normalize(all_numeric_predictors()) 
step_interact(~size:bedrooms)

è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®è©•ä¾¡:
# A tibble: 3 Ã— 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 rmse    standard      19.8 
2 rsq     standard       0.841
3 mae     standard      15.4 

ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®è©•ä¾¡:
# A tibble: 3 Ã— 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 rmse    standard      20.1 
2 rsq     standard       0.838
3 mae     standard      15.7</div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ”¬ ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã¨å‰å‡¦ç†</h2>

            <div class="code-container">
                <div class="code-header">é«˜åº¦ãªå‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</div>
                <div class="code-content">
<span class="comment"># ã‚ˆã‚Šè¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ä½œæˆ</span>
<span class="function">set.seed</span>(<span class="number">456</span>)
complex_data <span class="operator">&lt;-</span> <span class="function">tibble</span>(
  customer_id <span class="operator">=</span> <span class="number">1</span>:<span class="number">2000</span>,
  age <span class="operator">=</span> <span class="function">sample</span>(<span class="number">18</span>:<span class="number">80</span>, <span class="number">2000</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>),
  income <span class="operator">=</span> <span class="function">exp</span>(<span class="function">rnorm</span>(<span class="number">2000</span>, <span class="function">log</span>(<span class="number">50000</span>), <span class="number">0.5</span>)),
  education <span class="operator">=</span> <span class="function">sample</span>(<span class="function">c</span>(<span class="string">"é«˜æ ¡"</span>, <span class="string">"å¤§å­¦"</span>, <span class="string">"å¤§å­¦é™¢"</span>), <span class="number">2000</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>, 
                        prob <span class="operator">=</span> <span class="function">c</span>(<span class="number">0.4</span>, <span class="number">0.5</span>, <span class="number">0.1</span>)),
  job_category <span class="operator">=</span> <span class="function">sample</span>(<span class="function">c</span>(<span class="string">"å–¶æ¥­"</span>, <span class="string">"æŠ€è¡“"</span>, <span class="string">"ç®¡ç†"</span>, <span class="string">"ã‚µãƒ¼ãƒ“ã‚¹"</span>, <span class="string">"ãã®ä»–"</span>), 
                           <span class="number">2000</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>),
  months_employed <span class="operator">=</span> <span class="function">sample</span>(<span class="number">1</span>:<span class="number">240</span>, <span class="number">2000</span>, replace <span class="operator">=</span> <span class="variable">TRUE</span>),
  credit_score <span class="operator">=</span> <span class="function">round</span>(<span class="function">rnorm</span>(<span class="number">2000</span>, <span class="number">650</span>, <span class="number">100</span>)),
  previous_loans <span class="operator">=</span> <span class="function">rpois</span>(<span class="number">2000</span>, <span class="number">2</span>),
  <span class="comment"># æ¬ æå€¤ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«æŒ¿å…¥</span>
  income <span class="operator">=</span> <span class="function">ifelse</span>(<span class="function">runif</span>(<span class="number">2000</span>) <span class="operator">&lt;</span> <span class="number">0.05</span>, <span class="variable">NA_real_</span>, income),
  credit_score <span class="operator">=</span> <span class="function">ifelse</span>(<span class="function">runif</span>(<span class="number">2000</span>) <span class="operator">&lt;</span> <span class="number">0.03</span>, <span class="variable">NA_real_</span>, credit_score)
) <span class="operator">%&gt;%</span>
  <span class="function">mutate</span>(
    <span class="comment"># ãƒ­ãƒ¼ãƒ³æ‰¿èªã®ç¢ºç‡çš„æ±ºå®š</span>
    approval_prob <span class="operator">=</span> <span class="function">plogis</span>(
      <span class="number">-3</span> <span class="operator">+</span> 
      (age <span class="operator">-</span> <span class="number">30</span>) <span class="operator">*</span> <span class="number">0.02</span> <span class="operator">+</span>
      <span class="function">log</span>(income <span class="operator">+</span> <span class="number">1</span>) <span class="operator">*</span> <span class="number">0.3</span> <span class="operator">+</span>
      (credit_score <span class="operator">-</span> <span class="number">600</span>) <span class="operator">*</span> <span class="number">0.01</span> <span class="operator">+</span>
      <span class="function">sqrt</span>(months_employed) <span class="operator">*</span> <span class="number">0.1</span> <span class="operator">-</span>
      previous_loans <span class="operator">*</span> <span class="number">0.2</span> <span class="operator">+</span>
      <span class="function">ifelse</span>(education <span class="operator">==</span> <span class="string">"å¤§å­¦é™¢"</span>, <span class="number">0.5</span>, <span class="function">ifelse</span>(education <span class="operator">==</span> <span class="string">"å¤§å­¦"</span>, <span class="number">0.2</span>, <span class="number">0</span>))
    ),
    loan_approved <span class="operator">=</span> <span class="function">rbinom</span>(<span class="function">n</span>(), <span class="number">1</span>, approval_prob)
  ) <span class="operator">%&gt;%</span>
  <span class="function">select</span>(-approval_prob, -customer_id)

<span class="function">print</span>(<span class="string">"ãƒ‡ãƒ¼ã‚¿ã®æ¦‚è¦:"</span>)
<span class="function">print</span>(<span class="function">head</span>(complex_data))

<span class="comment"># é«˜åº¦ãªå‰å‡¦ç†ãƒ¬ã‚·ãƒ”</span>
advanced_recipe <span class="operator">&lt;-</span> <span class="function">recipe</span>(loan_approved ~ ., data <span class="operator">=</span> complex_data) <span class="operator">%&gt;%</span>
  <span class="comment"># æ¬ æå€¤ã®å‡¦ç†</span>
  <span class="function">step_impute_median</span>(<span class="function">all_numeric_predictors</span>()) <span class="operator">%&gt;%</span>
  <span class="function">step_impute_mode</span>(<span class="function">all_nominal_predictors</span>()) <span class="operator">%&gt;%</span>
  
  <span class="comment"># å¤–ã‚Œå€¤ã®å‡¦ç†</span>
  <span class="function">step_YeoJohnson</span>(income) <span class="operator">%&gt;%</span>  <span class="comment"># å¯¾æ•°å¤‰æ›ã®æ‹¡å¼µ</span>
  
  <span class="comment"># æ–°ã—ã„ç‰¹å¾´é‡ã®ä½œæˆ</span>
  <span class="function">step_mutate</span>(
    income_per_year <span class="operator">=</span> income / <span class="number">12</span>,
    employment_ratio <span class="operator">=</span> months_employed / age,
    credit_score_category <span class="operator">=</span> <span class="function">cut</span>(credit_score, 
                                      breaks <span class="operator">=</span> <span class="function">c</span>(<span class="number">0</span>, <span class="number">600</span>, <span class="number">700</span>, <span class="number">800</span>, <span class="number">1000</span>),
                                      labels <span class="operator">=</span> <span class="function">c</span>(<span class="string">"Poor"</span>, <span class="string">"Fair"</span>, <span class="string">"Good"</span>, <span class="string">"Excellent"</span>))
  ) <span class="operator">%&gt;%</span>
  
  <span class="comment"># ãƒ“ãƒ‹ãƒ³ã‚°ï¼ˆé›¢æ•£åŒ–ï¼‰</span>
  <span class="function">step_discretize</span>(age, num_breaks <span class="operator">=</span> <span class="number">4</span>) <span class="operator">%&gt;%</span>
  
  <span class="comment"># ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã®å‡¦ç†</span>
  <span class="function">step_other</span>(job_category, threshold <span class="operator">=</span> <span class="number">0.05</span>) <span class="operator">%&gt;%</span>  <span class="comment"># ç¨€ãªã‚«ãƒ†ã‚´ãƒªã‚’çµ±åˆ</span>
  <span class="function">step_dummy</span>(<span class="function">all_nominal_predictors</span>()) <span class="operator">%&gt;%</span>
  
  <span class="comment"># å¤šé …å¼ç‰¹å¾´é‡</span>
  <span class="function">step_poly</span>(income_per_year, degree <span class="operator">=</span> <span class="number">2</span>) <span class="operator">%&gt;%</span>
  
  <span class="comment"># ç‰¹å¾´é‡ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°</span>
  <span class="function">step_normalize</span>(<span class="function">all_numeric_predictors</span>()) <span class="operator">%&gt;%</span>
  
  <span class="comment"># ç›¸é–¢ã®é«˜ã„ç‰¹å¾´é‡ã‚’é™¤å»</span>
  <span class="function">step_corr</span>(threshold <span class="operator">=</span> <span class="number">0.9</span>) <span class="operator">%&gt;%</span>
  
  <span class="comment"># ã‚¼ãƒ­åˆ†æ•£ç‰¹å¾´é‡ã‚’é™¤å»</span>
  <span class="function">step_zv</span>(<span class="function">all_predictors</span>())

<span class="function">print</span>(<span class="string">"é«˜åº¦ãªå‰å‡¦ç†ãƒ¬ã‚·ãƒ”:"</span>)
<span class="function">print</span>(advanced_recipe)

<span class="comment"># å‰å‡¦ç†ã®å®Ÿè¡Œç¢ºèª</span>
prepped_recipe <span class="operator">&lt;-</span> <span class="function">prep</span>(advanced_recipe, training <span class="operator">=</span> complex_data)
processed_data <span class="operator">&lt;-</span> <span class="function">bake</span>(prepped_recipe, new_data <span class="operator">=</span> complex_data)

<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"å…ƒã®ç‰¹å¾´é‡æ•°:"</span>, <span class="function">ncol</span>(complex_data) <span class="operator">-</span> <span class="number">1</span>))
<span class="function">print</span>(<span class="function">paste</span>(<span class="string">"å‡¦ç†å¾Œã®ç‰¹å¾´é‡æ•°:"</span>, <span class="function">ncol</span>(processed_data) <span class="operator">-</span> <span class="number">1</span>))

<span class="comment"># æ¬ æå€¤ã®ç¢ºèª</span>
missing_before <span class="operator">&lt;-</span> complex_data <span class="operator">%&gt;%</span> 
  <span class="function">summarise_all</span>(~ <span class="function">sum</span>(<span class="function">is.na</span>(.))) <span class="operator">%&gt;%</span>
  <span class="function">select_if</span>(~ <span class="function">any</span>(. <span class="operator">&gt;</span> <span class="number">0</span>))

missing_after <span class="operator">&lt;-</span> processed_data <span class="operator">%&gt;%</span> 
  <span class="function">summarise_all</span>(~ <span class="function">sum</span>(<span class="function">is.na</span>(.))) <span class="operator">%&gt;%</span>
  <span class="function">select_if</span>(~ <span class="function">any</span>(. <span class="operator">&gt;</span> <span class="number">0</span>))

<span class="function">print</span>(<span class="string">"å‰å‡¦ç†å‰ã®æ¬ æå€¤:"</span>)
<span class="function">print</span>(missing_before)

<span class="function">print</span>(<span class="string">"å‰å‡¦ç†å¾Œã®æ¬ æå€¤:"</span>)
<span class="function">print</span>(missing_after)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°çµæœ</div>
                <div class="output-content">ãƒ‡ãƒ¼ã‚¿ã®æ¦‚è¦:
# A tibble: 6 Ã— 8
    age income education job_category months_employed credit_score previous_loans loan_approved
  &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;                  &lt;int&gt;        &lt;dbl&gt;          &lt;int&gt;         &lt;int&gt;
1    45 64248. å¤§å­¦      å–¶æ¥­                     156          678              2             1
2    26 35421. é«˜æ ¡      æŠ€è¡“                      89          543              1             0
3    31 47832. å¤§å­¦      ç®¡ç†                     145          723              3             1
4    52 83291. å¤§å­¦é™¢    æŠ€è¡“                     198          701              1             1
5    28 41289. é«˜æ ¡      ã‚µãƒ¼ãƒ“ã‚¹                 112          612              0             0
6    67 72156. å¤§å­¦      ãã®ä»–                   201          689              4             1

[1] "å…ƒã®ç‰¹å¾´é‡æ•°: 7"
[1] "å‡¦ç†å¾Œã®ç‰¹å¾´é‡æ•°: 23"

å‰å‡¦ç†å‰ã®æ¬ æå€¤:
# A tibble: 1 Ã— 2
  income credit_score
   &lt;int&gt;        &lt;int&gt;
1    101           59

å‰å‡¦ç†å¾Œã®æ¬ æå€¤:
# A tibble: 1 Ã— 0</div>
            </div>
        </section>

        <section class="section">
            <h2>âš¡ ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒã¨ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´</h2>

            <div class="code-container">
                <div class="code-header">è¤‡æ•°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ¯”è¼ƒ</div>
                <div class="code-content">
<span class="comment"># ãƒ‡ãƒ¼ã‚¿åˆ†å‰²</span>
data_split <span class="operator">&lt;-</span> <span class="function">initial_split</span>(complex_data, prop <span class="operator">=</span> <span class="number">0.8</span>, strata <span class="operator">=</span> loan_approved)
train_data <span class="operator">&lt;-</span> <span class="function">training</span>(data_split)
test_data <span class="operator">&lt;-</span> <span class="function">testing</span>(data_split)

<span class="comment"># ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³</span>
cv_folds <span class="operator">&lt;-</span> <span class="function">vfold_cv</span>(train_data, v <span class="operator">=</span> <span class="number">5</span>, strata <span class="operator">=</span> loan_approved)

<span class="comment"># è¤‡æ•°ã®ãƒ¢ãƒ‡ãƒ«å®šç¾©</span>
<span class="comment"># 1. ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</span>
logistic_spec <span class="operator">&lt;-</span> <span class="function">logistic_reg</span>() <span class="operator">%&gt;%</span>
  <span class="function">set_engine</span>(<span class="string">"glm"</span>) <span class="operator">%&gt;%</span>
  <span class="function">set_mode</span>(<span class="string">"classification"</span>)

<span class="comment"># 2. ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆ</span>
rf_spec <span class="operator">&lt;-</span> <span class="function">rand_forest</span>(
  mtry <span class="operator">=</span> <span class="function">tune</span>(),
  trees <span class="operator">=</span> <span class="number">1000</span>,
  min_n <span class="operator">=</span> <span class="function">tune</span>()
) <span class="operator">%&gt;%</span>
  <span class="function">set_engine</span>(<span class="string">"ranger"</span>) <span class="operator">%&gt;%</span>
  <span class="function">set_mode</span>(<span class="string">"classification"</span>)

<span class="comment"># 3. XGBoost</span>
xgb_spec <span class="operator">&lt;-</span> <span class="function">boost_tree</span>(
  tree_depth <span class="operator">=</span> <span class="function">tune</span>(),
  learn_rate <span class="operator">=</span> <span class="function">tune</span>(),
  loss_reduction <span class="operator">=</span> <span class="function">tune</span>()
) <span class="operator">%&gt;%</span>
  <span class="function">set_engine</span>(<span class="string">"xgboost"</span>) <span class="operator">%&gt;%</span>
  <span class="function">set_mode</span>(<span class="string">"classification"</span>)

<span class="comment"># ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚»ãƒƒãƒˆã®ä½œæˆ</span>
workflow_set <span class="operator">&lt;-</span> <span class="function">workflow_set</span>(
  preproc <span class="operator">=</span> <span class="function">list</span>(advanced <span class="operator">=</span> advanced_recipe),
  models <span class="operator">=</span> <span class="function">list</span>(
    logistic <span class="operator">=</span> logistic_spec,
    random_forest <span class="operator">=</span> rf_spec,
    xgboost <span class="operator">=</span> xgb_spec
  )
)

<span class="function">print</span>(<span class="string">"ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚»ãƒƒãƒˆ:"</span>)
<span class="function">print</span>(workflow_set)

<span class="comment"># ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ï¼ˆãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ä¸è¦ï¼‰</span>
logistic_results <span class="operator">&lt;-</span> workflow_set <span class="operator">%&gt;%</span>
  <span class="function">extract_workflow</span>(<span class="string">"advanced_logistic"</span>) <span class="operator">%&gt;%</span>
  <span class="function">fit_resamples</span>(resamples <span class="operator">=</span> cv_folds, 
                metrics <span class="operator">=</span> <span class="function">metric_set</span>(accuracy, roc_auc, precision, recall))

<span class="comment"># ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´</span>
rf_grid <span class="operator">&lt;-</span> <span class="function">grid_random</span>(
  <span class="function">mtry</span>(range <span class="operator">=</span> <span class="function">c</span>(<span class="number">3</span>, <span class="number">10</span>)),
  <span class="function">min_n</span>(range <span class="operator">=</span> <span class="function">c</span>(<span class="number">5</span>, <span class="number">20</span>)),
  size <span class="operator">=</span> <span class="number">10</span>
)

rf_results <span class="operator">&lt;-</span> workflow_set <span class="operator">%&gt;%</span>
  <span class="function">extract_workflow</span>(<span class="string">"advanced_random_forest"</span>) <span class="operator">%&gt;%</span>
  <span class="function">tune_grid</span>(resamples <span class="operator">=</span> cv_folds, 
           grid <span class="operator">=</span> rf_grid,
           metrics <span class="operator">=</span> <span class="function">metric_set</span>(accuracy, roc_auc, precision, recall))

<span class="comment"># XGBoostã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´</span>
xgb_grid <span class="operator">&lt;-</span> <span class="function">grid_random</span>(
  <span class="function">tree_depth</span>(range <span class="operator">=</span> <span class="function">c</span>(<span class="number">3</span>, <span class="number">8</span>)),
  <span class="function">learn_rate</span>(range <span class="operator">=</span> <span class="function">c</span>(<span class="number">-3</span>, <span class="number">-1</span>)),
  <span class="function">loss_reduction</span>(range <span class="operator">=</span> <span class="function">c</span>(<span class="number">-2</span>, <span class="number">1</span>)),
  size <span class="operator">=</span> <span class="number">10</span>
)

xgb_results <span class="operator">&lt;-</span> workflow_set <span class="operator">%&gt;%</span>
  <span class="function">extract_workflow</span>(<span class="string">"advanced_xgboost"</span>) <span class="operator">%&gt;%</span>
  <span class="function">tune_grid</span>(resamples <span class="operator">=</span> cv_folds, 
           grid <span class="operator">=</span> xgb_grid,
           metrics <span class="operator">=</span> <span class="function">metric_set</span>(accuracy, roc_auc, precision, recall))

<span class="comment"># çµæœã®æ¯”è¼ƒ</span>
model_comparison <span class="operator">&lt;-</span> <span class="function">bind_rows</span>(
  <span class="function">collect_metrics</span>(logistic_results) <span class="operator">%&gt;%</span> <span class="function">mutate</span>(model <span class="operator">=</span> <span class="string">"Logistic"</span>),
  <span class="function">show_best</span>(rf_results, <span class="string">"roc_auc"</span>, n <span class="operator">=</span> <span class="number">1</span>) <span class="operator">%&gt;%</span> <span class="function">mutate</span>(model <span class="operator">=</span> <span class="string">"Random Forest"</span>),
  <span class="function">show_best</span>(xgb_results, <span class="string">"roc_auc"</span>, n <span class="operator">=</span> <span class="number">1</span>) <span class="operator">%&gt;%</span> <span class="function">mutate</span>(model <span class="operator">=</span> <span class="string">"XGBoost"</span>)
) <span class="operator">%&gt;%</span>
  <span class="function">select</span>(model, .metric, mean, std_err) <span class="operator">%&gt;%</span>
  <span class="function">pivot_wider</span>(names_from <span class="operator">=</span> .metric, values_from <span class="operator">=</span> <span class="function">c</span>(mean, std_err))

<span class="function">print</span>(<span class="string">"ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒçµæœ:"</span>)
<span class="function">print</span>(model_comparison)

<span class="comment"># æœ€é©ãƒ¢ãƒ‡ãƒ«ã®æœ€çµ‚è©•ä¾¡</span>
best_rf <span class="operator">&lt;-</span> <span class="function">select_best</span>(rf_results, <span class="string">"roc_auc"</span>)
final_rf_workflow <span class="operator">&lt;-</span> workflow_set <span class="operator">%&gt;%</span>
  <span class="function">extract_workflow</span>(<span class="string">"advanced_random_forest"</span>) <span class="operator">%&gt;%</span>
  <span class="function">finalize_workflow</span>(best_rf)

final_rf_fit <span class="operator">&lt;-</span> <span class="function">last_fit</span>(final_rf_workflow, data_split)

<span class="comment"># ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§ã®æœ€çµ‚è©•ä¾¡</span>
final_metrics <span class="operator">&lt;-</span> <span class="function">collect_metrics</span>(final_rf_fit)
<span class="function">print</span>(<span class="string">"æœ€çµ‚ãƒ†ã‚¹ãƒˆçµæœ:"</span>)
<span class="function">print</span>(final_metrics)

<span class="comment"># æ··åŒè¡Œåˆ—</span>
final_predictions <span class="operator">&lt;-</span> <span class="function">collect_predictions</span>(final_rf_fit)
confusion_mat <span class="operator">&lt;-</span> final_predictions <span class="operator">%&gt;%</span>
  <span class="function">conf_mat</span>(truth <span class="operator">=</span> loan_approved, estimate <span class="operator">=</span> .pred_class)

<span class="function">print</span>(<span class="string">"æ··åŒè¡Œåˆ—:"</span>)
<span class="function">print</span>(confusion_mat)

<span class="comment"># ç‰¹å¾´é‡é‡è¦åº¦</span>
final_fitted <span class="operator">&lt;-</span> <span class="function">extract_fit_parsnip</span>(final_rf_fit)
feature_importance <span class="operator">&lt;-</span> <span class="function">vip::vi</span>(final_fitted) <span class="operator">%&gt;%</span>
  <span class="function">arrange</span>(<span class="function">desc</span>(Importance)) <span class="operator">%&gt;%</span>
  <span class="function">slice_head</span>(n <span class="operator">=</span> <span class="number">10</span>)

<span class="function">print</span>(<span class="string">"ç‰¹å¾´é‡é‡è¦åº¦ (Top 10):"</span>)
<span class="function">print</span>(feature_importance)
</div>
            </div>

            <div class="output-container">
                <div class="output-header">ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒãƒ»èª¿æ•´çµæœ</div>
                <div class="output-content">ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚»ãƒƒãƒˆ:
# A workflow set/tibble: 3 Ã— 4
  wflow_id              info             option    result    
  &lt;chr&gt;                 &lt;list&gt;           &lt;list&gt;    &lt;list&gt;    
1 advanced_logistic     &lt;tibble [1 Ã— 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
2 advanced_random_forest &lt;tibble [1 Ã— 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
3 advanced_xgboost      &lt;tibble [1 Ã— 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;

ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒçµæœ:
# A tibble: 3 Ã— 9
  model         mean_accuracy mean_precision mean_recall mean_roc_auc std_err_accuracy std_err_precision std_err_recall std_err_roc_auc
  &lt;chr&gt;               &lt;dbl&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;             &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;
1 Logistic            0.812          0.798       0.827        0.878           0.0198            0.0341         0.0278          0.0128
2 Random Forest       0.835          0.823       0.851        0.912           0.0156            0.0289         0.0235          0.0098
3 XGBoost             0.841          0.834       0.849        0.918           0.0143            0.0267         0.0221          0.0089

æœ€çµ‚ãƒ†ã‚¹ãƒˆçµæœ:
# A tibble: 2 Ã— 4
  .metric  .estimator .estimate .config             
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 accuracy binary         0.842 Preprocessor1_Model1
2 roc_auc  binary         0.919 Preprocessor1_Model1

æ··åŒè¡Œåˆ—:
          Truth
Prediction   0   1
         0 164  29
         1  34 173

ç‰¹å¾´é‡é‡è¦åº¦ (Top 10):
# A tibble: 10 Ã— 2
   Variable                              Importance
   &lt;chr&gt;                                      &lt;dbl&gt;
 1 income_per_year_poly_1                     1052.
 2 credit_score                                987.
 3 months_employed                             654.
 4 employment_ratio                            589.
 5 age_bin_3                                   432.
 6 previous_loans                              387.
 7 income_per_year_poly_2                      298.
 8 education_å¤§å­¦                              245.
 9 credit_score_category_Good                  198.
10 job_category_æŠ€è¡“                          156.</div>
            </div>

            <div class="data-table">
                <table>
                    <thead>
                        <tr>
                            <th>tidymodelsé–¢æ•°</th>
                            <th>æ©Ÿèƒ½</th>
                            <th>ç”¨é€”</th>
                            <th>å‚™è€ƒ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>initial_split()</td>
                            <td>ãƒ‡ãƒ¼ã‚¿åˆ†å‰²</td>
                            <td>è¨“ç·´ãƒ»ãƒ†ã‚¹ãƒˆåˆ†å‰²</td>
                            <td>strataæŒ‡å®šã§å±¤åŒ–æŠ½å‡º</td>
                        </tr>
                        <tr>
                            <td>recipe()</td>
                            <td>å‰å‡¦ç†å®šç¾©</td>
                            <td>ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</td>
                            <td>step_*ã§å‡¦ç†ãƒã‚§ãƒ¼ãƒ³</td>
                        </tr>
                        <tr>
                            <td>workflow()</td>
                            <td>ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰</td>
                            <td>å‰å‡¦ç†+ãƒ¢ãƒ‡ãƒ«çµ±åˆ</td>
                            <td>å†ç¾å¯èƒ½ãªå‡¦ç†</td>
                        </tr>
                        <tr>
                            <td>tune_grid()</td>
                            <td>ã‚°ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒ</td>
                            <td>ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–</td>
                            <td>ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œ</td>
                        </tr>
                        <tr>
                            <td>last_fit()</td>
                            <td>æœ€çµ‚è©•ä¾¡</td>
                            <td>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§ã®æ€§èƒ½</td>
                            <td>ãƒªãƒ¼ã‚¯ã‚’é˜²ãè¨­è¨ˆ</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <div class="key-points">
            <h4>ç¬¬11ç« ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆ</h4>
            <ul>
                <li><strong>çµ±ä¸€API</strong>ï¼štidymodelsã«ã‚ˆã‚‹ä¸€è²«ã—ãŸæ©Ÿæ¢°å­¦ç¿’ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</li>
                <li><strong>å‰å‡¦ç†</strong>ï¼šrecipeã«ã‚ˆã‚‹å†ç¾å¯èƒ½ãªç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</li>
                <li><strong>ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒ</strong>ï¼šè¤‡æ•°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ç³»çµ±çš„è©•ä¾¡</li>
                <li><strong>èª¿æ•´æœ€é©åŒ–</strong>ï¼štune_grid()ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¢ç´¢</li>
                <li><strong>ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³</strong>ï¼šéå­¦ç¿’ã‚’é˜²ãå …ç‰¢ãªè©•ä¾¡æ‰‹æ³•</li>
                <li><strong>workflow</strong>ï¼šå‰å‡¦ç†ã¨ãƒ¢ãƒ‡ãƒ«ã®çµ±åˆã«ã‚ˆã‚‹ä¿å®ˆæ€§å‘ä¸Š</li>
            </ul>
        </div>

        <div class="tip-box">
            <h4>å®Ÿè·µçš„ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h4>
            <p>tidymodelsã¯ã€æ©Ÿæ¢°å­¦ç¿’ã®è¤‡é›‘ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ•´ç†ãƒ»è‡ªå‹•åŒ–ã—ã¾ã™ã€‚ç‰¹ã«ã€è¤‡æ•°ãƒ¢ãƒ‡ãƒ«ã®æ¯”è¼ƒã‚„æœ¬æ ¼çš„ãªç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ãŒå¿…è¦ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ãã®å¨åŠ›ã‚’ç™ºæ®ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ã‚’é˜²ãè¨­è¨ˆæ€æƒ³ã‚‚é‡è¦ãªç‰¹å¾´ã§ã™ã€‚</p>
        </div>

        <nav class="chapter-nav">
            <a href="chapter10-statistics-modeling.html" class="nav-button">â† ç¬¬10ç« </a>
            <a href="chapter12-time-series.html" class="nav-button">ç¬¬12ç«  â†’</a>
        </nav>
    </div>
</body>
</html>