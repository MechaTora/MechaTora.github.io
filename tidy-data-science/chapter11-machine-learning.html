<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第11章: 機械学習とtidymodels | Tidyverse完全マスター</title>
    <link rel="canonical" href="https://mechatora.com/tidy-data-science/chapter11-machine-learning.html">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RBPWE348T2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RBPWE348T2');
    </script>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1184134440246706"
         crossorigin="anonymous"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family@Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --accent-neon: #00ff88;
            --accent-cyan: #00d4ff;
            --accent-purple: #9d4edd;
            --accent-orange: #ff8c42;
            --accent-electric: #00ff41;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --border-neon: #00ff88;
            --shadow-neon: 0 0 20px #00ff8840;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: linear-gradient(45deg, var(--bg-secondary), var(--bg-tertiary));
            border-radius: 20px;
            border: 2px solid var(--accent-electric);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.4);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 65, 0.1), transparent);
            animation: scan 3s infinite;
        }

        @keyframes scan {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        h1 {
            font-size: 3rem;
            font-weight: 700;
            color: var(--accent-electric);
            margin-bottom: 10px;
            text-shadow: 0 0 20px var(--accent-electric);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.4rem;
            color: var(--accent-cyan);
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .chapter-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            position: relative;
            z-index: 1;
        }

        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: 3px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .progress-dot {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            border: 1px solid var(--text-secondary);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--accent-electric);
            border-color: var(--accent-electric);
            box-shadow: 0 0 5px var(--accent-electric);
        }

        .progress-dot.completed {
            background: var(--accent-cyan);
            border-color: var(--accent-cyan);
        }

        /* Navigation Widget */
        .chapter-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 3px;
            margin: 30px 0;
            padding: 6px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--accent-electric);
            width: fit-content;
            max-width: 90vw;
            margin-left: auto;
            margin-right: auto;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 1px 5px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            text-decoration: none;
            border-radius: 2px;
            border: 1px solid var(--accent-cyan);
            transition: all 0.3s ease;
            font-size: 0.65rem;
            white-space: nowrap;
        }

        .nav-button:hover {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            box-shadow: 0 0 6px var(--accent-cyan);
        }

        .nav-button.current {
            background: var(--accent-electric);
            color: var(--bg-primary);
            box-shadow: 0 0 6px var(--accent-electric);
        }

        /* Content Sections */
        .section {
            background: rgba(255, 255, 255, 0.02);
            margin: 30px 0;
            padding: 30px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 255, 65, 0.15);
            position: relative;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-electric), var(--accent-cyan), var(--accent-purple));
            border-radius: 15px 15px 0 0;
        }

        h2 {
            color: var(--accent-electric);
            font-size: 2rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--accent-electric);
        }

        h3 {
            color: var(--accent-cyan);
            font-size: 1.5rem;
            margin: 25px 0 15px 0;
            text-shadow: 0 0 8px var(--accent-cyan);
        }

        h4 {
            color: var(--accent-purple);
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
        }

        /* Code Blocks */
        .code-block {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--accent-electric);
            border-radius: 15px;
            overflow: hidden;
            margin: 2rem 0;
            box-shadow: 0 8px 32px rgba(0, 255, 65, 0.1);
        }

        .code-header {
            background: rgba(0, 255, 65, 0.1);
            padding: 0.8rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border-bottom: 1px solid var(--accent-electric);
        }

        .code-dots {
            display: flex;
            gap: 0.3rem;
        }

        .code-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-electric);
            opacity: 0.6;
        }

        .code-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--accent-cyan);
            font-weight: 500;
        }

        .code-content {
            padding: 1.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.9);
            overflow-x: auto;
            background: #0d1117;
        }

        .code-line {
            display: block;
            margin-bottom: 0.3rem;
        }

        /* Syntax highlighting */
        .code-comment { color: #8b949e; }
        .code-keyword { color: #ff7b72; }
        .code-string { color: #a5d6ff; }
        .code-function { color: #d2a8ff; }
        .code-variable { color: #ffa657; }
        .code-regex { color: #39ff14; font-weight: bold; }
        .code-pattern { color: #ffff00; background: rgba(255, 255, 0, 0.1); padding: 0.1rem 0.3rem; border-radius: 3px; }

        /* Function Grid */
        .function-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .function-card {
            background: var(--bg-tertiary);
            border: 1px solid var(--accent-cyan);
            border-radius: 15px;
            padding: 2rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .function-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--accent-electric) 0%, var(--accent-cyan) 50%, var(--accent-purple) 100%);
            opacity: 0.1;
            transition: all 0.5s ease;
            z-index: -1;
        }

        .function-card:hover::before {
            left: 0;
        }

        .function-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.3);
        }

        .function-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--accent-electric);
            margin-bottom: 1rem;
        }

        .function-description {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
        }

        .function-syntax {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--accent-cyan);
            background: rgba(0, 255, 255, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            border-left: 3px solid var(--accent-cyan);
        }

        /* Output Display */
        .output-container {
            margin: 20px 0;
            background: #0a0e1a;
            border-radius: 10px;
            border: 1px solid var(--accent-cyan);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.1);
        }

        .output-header {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .output-header::before {
            content: '🧠';
        }

        .output-content {
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--accent-cyan);
        }

        /* ML Workflow */
        .ml-workflow {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--accent-purple);
        }

        .workflow-title {
            color: var(--accent-purple);
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .workflow-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .workflow-step {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--accent-cyan);
            text-align: center;
        }

        .step-number {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 10px;
        }

        /* Data Tables */
        .data-table {
            margin: 20px 0;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-tertiary);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid var(--accent-electric);
        }

        th {
            background: var(--accent-electric);
            color: var(--bg-primary);
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--bg-secondary);
            color: var(--text-primary);
        }

        tr:nth-child(even) {
            background: rgba(0, 255, 65, 0.05);
        }

        tr:hover {
            background: rgba(0, 255, 65, 0.1);
        }

        /* Key Points */
        .key-points {
            background: linear-gradient(135deg, rgba(0, 255, 65, 0.1) 0%, rgba(0, 212, 255, 0.1) 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-electric);
        }

        .key-points h4 {
            color: var(--accent-electric);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .key-points h4::before {
            content: '💡';
        }

        .key-points ul {
            list-style: none;
            padding-left: 0;
        }

        .key-points li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .key-points li::before {
            content: '▶';
            color: var(--accent-cyan);
            position: absolute;
            left: 0;
        }

        /* Warning/Tip boxes */
        .tip-box {
            background: rgba(157, 78, 221, 0.1);
            border: 1px solid var(--accent-purple);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-purple);
        }

        .tip-box h4 {
            color: var(--accent-purple);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tip-box h4::before {
            content: '⚠️';
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }

            .chapter-meta {
                flex-direction: column;
                gap: 10px;
            }

            .chapter-nav {
                gap: 2px;
                padding: 4px;
            }

            .nav-button {
                padding: 1px 3px;
                font-size: 0.6rem;
            }

            .section {
                padding: 20px;
                margin: 20px 0;
            }

            h2 {
                font-size: 1.5rem;
            }

            .workflow-steps {
                grid-template-columns: 1fr;
            }

            .code-content, .output-content {
                font-size: 0.85rem;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>第11章: 機械学習とtidymodels</h1>
            <p class="subtitle">Tidyverseエコシステムによる機械学習</p>
            <div class="chapter-meta">
                <span>🤖 モデル構築</span>
                <span>🔬 特徴量エンジニアリング</span>
                <span>⚡ ハイパーパラメータ調整</span>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot completed"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>
        </header>

        <nav class="chapter-nav">
            <a href="chapter1-tidyverse-overview.html" class="nav-button">第1章</a>
            <a href="chapter2-dplyr-data-manipulation.html" class="nav-button">第2章</a>
            <a href="chapter3-ggplot2-visualization.html" class="nav-button">第3章</a>
            <a href="chapter4-tidyr-data-reshaping.html" class="nav-button">第4章</a>
            <a href="chapter5-stringr-text-processing.html" class="nav-button">第5章</a>
            <a href="chapter6-forcats-purrr-advanced.html" class="nav-button">第6章</a>
            <a href="chapter7-lubridate-datetime.html" class="nav-button">第7章</a>
            <a href="chapter8-readr-data-import.html" class="nav-button">第8章</a>
            <a href="chapter9-tibble-modern-dataframe.html" class="nav-button">第9章</a>
            <a href="chapter10-statistics-modeling.html" class="nav-button">第10章</a>
            <a href="#" class="nav-button current">第11章</a>
        </nav>

        <!-- TIDYMODELS INTRODUCTION -->
        <section class="section" id="tidymodels-intro">
            <h2>🤖 tidymodelsの革命</h2>
                <p>
                    tidymodelsは、機械学習のワークフロー全体をTidyverseの原則に基づいて統合した革新的なフレームワークです。データの前処理から モデルの訓練、評価、予測まで、一貫した文法で美しく記述できます。
                </p>
                
                <!-- Core Packages -->
                <h3 style="color: var(--accent-cyan); margin: 2rem 0 1rem 0;">📦 tidymodelsコアパッケージ</h3>
                
                <div class="code-block">
                    <div class="code-header">
                        <div class="code-dots">
                            <div class="code-dot"></div>
                            <div class="code-dot"></div>
                            <div class="code-dot"></div>
                        </div>
                        <div class="code-title">tidymodels_setup.R</div>
                    </div>
                    <div class="code-content">
                        <span class="code-line"><span class="code-comment"># tidymodelsエコシステムの読み込み</span></span>
                        <span class="code-line"><span class="code-keyword">library</span>(<span class="code-string">tidymodels</span>)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-keyword">library</span>(<span class="code-string">tidyverse</span>)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># コアパッケージの確認</span></span>
                        <span class="code-line"><span class="code-function">tidymodels_packages</span>()</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># サンプルデータの準備</span></span>
                        <span class="code-line"><span class="code-keyword">library</span>(<span class="code-string">palmerpenguins</span>)</span>
                        <span class="code-line"><span class="code-variable">data</span>(<span class="code-string">penguins</span>)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># データの概要</span></span>
                        <span class="code-line"><span class="code-variable">penguins_clean</span> <span class="code-keyword">&lt;-</span> penguins <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-function">drop_na</span>() <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-function">select</span>(-year)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-function">glimpse</span>(penguins_clean)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># データ分布の確認</span></span>
                        <span class="code-line">penguins_clean <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-function">count</span>(species, sort = <span class="code-string">TRUE</span>)</span>
                    </div>
                </div>

                <div class="function-grid">
                    <div class="function-card">
                        <h3 class="function-title">📝 rsample</h3>
                        <p class="function-description">
                            データ分割とリサンプリングのための統一されたインターフェース。層化サンプリング、クロスバリデーション、ブートストラップなど、様々な手法をサポート。
                        </p>
                        <div class="function-syntax">
                            initial_split(), vfold_cv(), bootstraps()
                        </div>
                    </div>
                    <div class="function-card">
                        <h3 class="function-title">🛠️ recipes</h3>
                        <p class="function-description">
                            宣言的な特徴量エンジニアリング。前処理のステップをレシピのように組み合わせ、訓練データで学習し、新しいデータに適用可能。
                        </p>
                        <div class="function-syntax">
                            recipe(), step_normalize(), step_dummy()
                        </div>
                    </div>
                    <div class="function-card">
                        <h3 class="function-title">🤖 parsnip</h3>
                        <p class="function-description">
                            統一されたモデルインターフェース。異なるエンジン（glm、randomForest、xgboostなど）を同じ構文で操作可能。
                        </p>
                        <div class="function-syntax">
                            linear_reg(), logistic_reg(), rand_forest()
                        </div>
                    </div>
                    <div class="function-card">
                        <h3 class="function-title">🔧 workflows</h3>
                        <p class="function-description">
                            前処理とモデルを一つのオブジェクトに結合。前処理からモデル訓練までのパイプラインを管理し、再現性を確保。
                        </p>
                        <div class="function-syntax">
                            workflow(), add_recipe(), add_model()
                        </div>
                    </div>
                    <div class="function-card">
                        <h3 class="function-title">🎯 tune</h3>
                        <p class="function-description">
                            ハイパーパラメータ調整のためのツール。グリッドサーチ、ランダムサーチ、ベイジアン最適化などに対応。
                        </p>
                        <div class="function-syntax">
                            tune(), tune_grid(), tune_bayes()
                        </div>
                    </div>
                    <div class="function-card">
                        <h3 class="function-title">📊 yardstick</h3>
                        <p class="function-description">
                            モデル評価指標の計算。分類、回帰、生存分析など、様々なタスクに対応した包括的な評価指標を提供。
                        </p>
                        <div class="function-syntax">
                            accuracy(), roc_auc(), rmse()
                        </div>
                    </div>
                </div>
        </section>

        <!-- DATA SPLITTING AND RESAMPLING -->
        <section class="section" id="data-splitting">
            <h2>🎯 データ分割とリサンプリング</h2>
                <p>
                    機械学習において、データの適切な分割は成功の鍵です。rsampleパッケージは、訓練・検証・テストデータの分割から、クロスバリデーションまで、統一されたインターフェースで提供します。
                </p>
                
                <!-- Initial Split -->
                <h3 style="color: var(--accent-cyan); margin: 2rem 0 1rem 0;">📊 初期データ分割</h3>
                
                <div class="code-block">
                    <div class="code-header">
                        <div class="code-dots">
                            <div class="code-dot"></div>
                            <div class="code-dot"></div>
                            <div class="code-dot"></div>
                        </div>
                        <div class="code-title">data_splitting.R</div>
                    </div>
                    <div class="code-content">
                        <span class="code-line"><span class="code-comment"># 初期データ分割（訓練:テスト = 80:20）</span></span>
                        <span class="code-line"><span class="code-function">set.seed</span>(<span class="code-string">123</span>)</span>
                        <span class="code-line"><span class="code-variable">penguins_split</span> <span class="code-keyword">&lt;-</span> <span class="code-function">initial_split</span>(</span>
                        <span class="code-line">  penguins_clean, </span>
                        <span class="code-line">  prop = <span class="code-string">0.8</span>,</span>
                        <span class="code-line">  strata = species  <span class="code-comment"># 層化サンプリング</span></span>
                        <span class="code-line">)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># 訓練データとテストデータの作成</span></span>
                        <span class="code-line"><span class="code-variable">penguins_train</span> <span class="code-keyword">&lt;-</span> <span class="code-function">training</span>(penguins_split)</span>
                        <span class="code-line"><span class="code-variable">penguins_test</span> <span class="code-keyword">&lt;-</span> <span class="code-function">testing</span>(penguins_split)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># データサイズの確認</span></span>
                        <span class="code-line"><span class="code-function">cat</span>(<span class="code-string">"訓練データ:"</span>, <span class="code-function">nrow</span>(penguins_train), <span class="code-string">"行\\n"</span>)</span>
                        <span class="code-line"><span class="code-function">cat</span>(<span class="code-string">"テストデータ:"</span>, <span class="code-function">nrow</span>(penguins_test), <span class="code-string">"行\\n"</span>)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># 層化サンプリングの確認</span></span>
                        <span class="code-line"><span class="code-function">cat</span>(<span class="code-string">"\\n訓練データの種分布:\\n"</span>)</span>
                        <span class="code-line">penguins_train <span class="code-keyword">%&gt;%</span> </span>
                        <span class="code-line">  <span class="code-function">count</span>(species) <span class="code-keyword">%&gt;%</span> </span>
                        <span class="code-line">  <span class="code-function">mutate</span>(prop = <span class="code-function">round</span>(n / <span class="code-function">sum</span>(n), <span class="code-string">3</span>)) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-function">print</span>()</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-function">cat</span>(<span class="code-string">"\\nテストデータの種分布:\\n"</span>)</span>
                        <span class="code-line">penguins_test <span class="code-keyword">%&gt;%</span> </span>
                        <span class="code-line">  <span class="code-function">count</span>(species) <span class="code-keyword">%&gt;%</span> </span>
                        <span class="code-line">  <span class="code-function">mutate</span>(prop = <span class="code-function">round</span>(n / <span class="code-function">sum</span>(n), <span class="code-string">3</span>)) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-function">print</span>()</span>
                    </div>
                </div>

                <!-- Cross-Validation -->
                <h3 style="color: var(--accent-cyan); margin: 2rem 0 1rem 0;">🔄 クロスバリデーション</h3>
                
                <div class="code-block">
                    <div class="code-header">
                        <div class="code-dots">
                            <div class="code-dot"></div>
                            <div class="code-dot"></div>
                            <div class="code-dot"></div>
                        </div>
                        <div class="code-title">cross_validation.R</div>
                    </div>
                    <div class="code-content">
                        <span class="code-line"><span class="code-comment"># 10-fold クロスバリデーション</span></span>
                        <span class="code-line"><span class="code-variable">penguins_folds</span> <span class="code-keyword">&lt;-</span> <span class="code-function">vfold_cv</span>(</span>
                        <span class="code-line">  penguins_train, </span>
                        <span class="code-line">  v = <span class="code-string">10</span>,</span>
                        <span class="code-line">  strata = species</span>
                        <span class="code-line">)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-function">print</span>(penguins_folds)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># Bootstrap リサンプリング</span></span>
                        <span class="code-line"><span class="code-variable">penguins_boots</span> <span class="code-keyword">&lt;-</span> <span class="code-function">bootstraps</span>(</span>
                        <span class="code-line">  penguins_train, </span>
                        <span class="code-line">  times = <span class="code-string">25</span>,</span>
                        <span class="code-line">  strata = species</span>
                        <span class="code-line">)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-function">print</span>(penguins_boots)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># Time series用の分割（例：月次データ）</span></span>
                        <span class="code-line"><span class="code-variable">ts_splits</span> <span class="code-keyword">&lt;-</span> <span class="code-function">rolling_origin</span>(</span>
                        <span class="code-line">  penguins_train,</span>
                        <span class="code-line">  initial = <span class="code-string">150</span>,</span>
                        <span class="code-line">  assess = <span class="code-string">50</span>,</span>
                        <span class="code-line">  skip = <span class="code-string">25</span>,</span>
                        <span class="code-line">  cumulative = <span class="code-string">FALSE</span></span>
                        <span class="code-line">)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-function">print</span>(ts_splits)</span>
                    </div>
                </div>

                <div class="function-grid">
                    <div class="function-card">
                        <h3 class="function-title">V-Fold CV</h3>
                        <p class="function-description">
                            最も一般的なクロスバリデーション手法。データをV個（通常10個）に分割し、1つを評価用、残りを訓練用として使用。各フォールドで評価を行い、平均的な性能を算出。
                        </p>
                        <div class="function-syntax">
                            vfold_cv(data, v = 10, strata = NULL)
                        </div>
                    </div>
                    <div class="function-card">
                        <h3 class="function-title">Bootstrap</h3>
                        <p class="function-description">
                            復元抽出によるリサンプリング手法。信頼区間の推定や分散の評価に有用。元のデータサイズと同じサイズのサンプルを複数作成。
                        </p>
                        <div class="function-syntax">
                            bootstraps(data, times = 25, strata = NULL)
                        </div>
                    </div>
                    <div class="function-card">
                        <h3 class="function-title">Monte Carlo</h3>
                        <p class="function-description">
                            ランダム分割による高速な評価手法。計算効率が良く、大規模データセットに適している。各分割で独立してランダムサンプリングを実行。
                        </p>
                        <div class="function-syntax">
                            mc_cv(data, prop = 0.75, times = 25)
                        </div>
                    </div>
                    <div class="function-card">
                        <h3 class="function-title">Rolling Origin</h3>
                        <p class="function-description">
                            時系列データ専用の分割手法。時間の順序を保持しながら、過去のデータで未来を予測する現実的な評価を実現。
                        </p>
                        <div class="function-syntax">
                            rolling_origin(data, initial, assess, skip)
                        </div>
                    </div>
                </div>
        </section>

        <!-- FEATURE ENGINEERING WITH RECIPES -->
        <section class="section" id="recipes">
            <h2>🍳 特徴量エンジニアリングの秘伝</h2>
                <p>
                    recipesパッケージは、データの前処理を一貫したワークフローで記述できる革新的なツールです。レシピのように前処理ステップを組み合わせ、訓練データで「調理法」を学習し、テストデータに適用できます。
                </p>
                
                <!-- Basic Recipe -->
                <h3 style="color: var(--accent-cyan); margin: 2rem 0 1rem 0;">📝 基本的なレシピ作成</h3>
                
                <div class="code-block">
                    <div class="code-header">
                        <div class="code-dots">
                            <div class="code-dot"></div>
                            <div class="code-dot"></div>
                            <div class="code-dot"></div>
                        </div>
                        <div class="code-title">basic_recipe.R</div>
                    </div>
                    <div class="code-content">
                        <span class="code-line"><span class="code-comment"># 基本的なレシピの作成</span></span>
                        <span class="code-line"><span class="code-variable">penguins_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(</span>
                        <span class="code-line">  species ~ .,  <span class="code-comment"># 目的変数と説明変数の指定</span></span>
                        <span class="code-line">  data = penguins_train</span>
                        <span class="code-line">) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-comment"># 数値変数の正規化</span></span>
                        <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-comment"># カテゴリ変数のダミー化</span></span>
                        <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-comment"># ゼロ分散変数の除去</span></span>
                        <span class="code-line">  <span class="code-function">step_zv</span>(<span class="code-function">all_predictors</span>())</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># レシピの確認</span></span>
                        <span class="code-line"><span class="code-function">print</span>(penguins_recipe)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># レシピの訓練（prep）</span></span>
                        <span class="code-line"><span class="code-variable">penguins_prep</span> <span class="code-keyword">&lt;-</span> <span class="code-function">prep</span>(penguins_recipe)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># 変換後データの確認</span></span>
                        <span class="code-line"><span class="code-variable">penguins_baked</span> <span class="code-keyword">&lt;-</span> <span class="code-function">bake</span>(penguins_prep, <span class="code-function">new_data</span> = <span class="code-string">NULL</span>)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-function">glimpse</span>(penguins_baked)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># 正規化の確認</span></span>
                        <span class="code-line">penguins_baked <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-function">select</span>(<span class="code-function">where</span>(is.numeric)) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-function">summarise</span>(<span class="code-function">across</span>(<span class="code-function">everything</span>(), <span class="code-function">list</span>(mean = mean, sd = sd))) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-function">pivot_longer</span>(<span class="code-function">everything</span>()) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-function">print</span>()</span>
                    </div>
                </div>

                <!-- Advanced Recipe -->
                <h3 style="color: var(--accent-cyan); margin: 2rem 0 1rem 0;">🔬 高度な前処理テクニック</h3>
                
                <div class="code-block">
                    <div class="code-header">
                        <div class="code-dots">
                            <div class="code-dot"></div>
                            <div class="code-dot"></div>
                            <div class="code-dot"></div>
                        </div>
                        <div class="code-title">advanced_recipe.R</div>
                    </div>
                    <div class="code-content">
                        <span class="code-line"><span class="code-comment"># 高度な前処理レシピ</span></span>
                        <span class="code-line"><span class="code-variable">advanced_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(</span>
                        <span class="code-line">  species ~ .,</span>
                        <span class="code-line">  data = penguins_train</span>
                        <span class="code-line">) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-comment"># 外れ値の処理</span></span>
                        <span class="code-line">  <span class="code-function">step_filter</span>(</span>
                        <span class="code-line">    bill_length_mm <span class="code-keyword">&lt;</span> <span class="code-function">quantile</span>(bill_length_mm, <span class="code-string">0.99</span>, na.rm = <span class="code-string">TRUE</span>),</span>
                        <span class="code-line">    bill_depth_mm <span class="code-keyword">&lt;</span> <span class="code-function">quantile</span>(bill_depth_mm, <span class="code-string">0.99</span>, na.rm = <span class="code-string">TRUE</span>)</span>
                        <span class="code-line">  ) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-comment"># 新しい特徴量の作成</span></span>
                        <span class="code-line">  <span class="code-function">step_mutate</span>(</span>
                        <span class="code-line">    bill_ratio = bill_length_mm / bill_depth_mm,</span>
                        <span class="code-line">    body_mass_log = <span class="code-function">log</span>(body_mass_g),</span>
                        <span class="code-line">    flipper_body_ratio = flipper_length_mm / body_mass_g</span>
                        <span class="code-line">  ) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-comment"># 交互作用項の追加</span></span>
                        <span class="code-line">  <span class="code-function">step_interact</span>(~ bill_length_mm:bill_depth_mm) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-comment"># 多項式特徴量の作成</span></span>
                        <span class="code-line">  <span class="code-function">step_poly</span>(flipper_length_mm, degree = <span class="code-string">2</span>) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-comment"># 主成分分析</span></span>
                        <span class="code-line">  <span class="code-function">step_pca</span>(<span class="code-function">all_numeric_predictors</span>(), num_comp = <span class="code-string">3</span>) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-comment"># カテゴリ変数のエンコーディング</span></span>
                        <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-comment"># 低分散変数の除去</span></span>
                        <span class="code-line">  <span class="code-function">step_zv</span>(<span class="code-function">all_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                        <span class="code-line">  <span class="code-comment"># 高相関変数の除去</span></span>
                        <span class="code-line">  <span class="code-function">step_corr</span>(<span class="code-function">all_numeric_predictors</span>(), threshold = <span class="code-string">0.9</span>)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-comment"># レシピの訓練と適用</span></span>
                        <span class="code-line"><span class="code-variable">advanced_prep</span> <span class="code-keyword">&lt;-</span> <span class="code-function">prep</span>(advanced_recipe)</span>
                        <span class="code-line"><span class="code-variable">advanced_data</span> <span class="code-keyword">&lt;-</span> <span class="code-function">bake</span>(advanced_prep, <span class="code-function">new_data</span> = <span class="code-string">NULL</span>)</span>
                        <span class="code-line"></span>
                        <span class="code-line"><span class="code-function">cat</span>(<span class="code-string">"処理後の特徴量数:"</span>, <span class="code-function">ncol</span>(advanced_data) - <span class="code-string">1</span>)  <span class="code-comment"># 目的変数を除く</span></span>
                        <span class="code-line"><span class="code-function">glimpse</span>(advanced_data)</span>
                    </div>
                </div>

                <div class="function-grid">
                    <div class="function-card">
                        <h3 class="function-title">🔢 数値変数処理</h3>
                        <p class="function-description">
                            数値データの正規化、スケーリング、変換を行います。機械学習アルゴリズムの性能向上に重要な役割を果たします。
                        </p>
                        <div class="function-syntax">
                            step_normalize(), step_scale(), step_center(), step_range(), step_BoxCox()
                        </div>
                    </div>
                    <div class="function-card">
                        <h3 class="function-title">🏷️ カテゴリ変数処理</h3>
                        <p class="function-description">
                            カテゴリカルデータをモデルで使用可能な数値形式に変換します。ダミー変数化や順序エンコーディングなど様々な手法を提供。
                        </p>
                        <div class="function-syntax">
                            step_dummy(), step_other(), step_novel(), step_ordinalscore()
                        </div>
                    </div>
                    <div class="function-card">
                        <h3 class="function-title">✨ 特徴量生成</h3>
                        <p class="function-description">
                            既存の特徴量から新しい特徴量を生成します。交互作用項、多項式特徴量、スプライン、主成分分析などの高度な手法をサポート。
                        </p>
                        <div class="function-syntax">
                            step_interact(), step_poly(), step_ns(), step_pca()
                        </div>
                    </div>
                    <div class="function-card">
                        <h3 class="function-title">🧹 データクリーニング</h3>
                        <p class="function-description">
                            不要な特徴量の除去とデータの品質向上を行います。ゼロ分散変数、高相関変数の除去など、モデルの精度向上に貢献。
                        </p>
                        <div class="function-syntax">
                            step_zv(), step_corr(), step_nzv(), step_filter()
                        </div>
                    </div>
                </div>
        </section>

        <!-- Recipesパッケージの包括的活用ガイド -->
        <section class="section" id="recipes-comprehensive">
            <h2>🍳 Recipesパッケージ完全マスター：日本語での豊富な実例集</h2>
            <p>
                recipesパッケージは、機械学習における特徴量エンジニアリングを宣言的かつ再現可能な方法で実現するための革命的なツールです。
                日本語での解説例が少ないため、実務でよく使用される様々な前処理パターンを豊富に紹介します。
            </p>

            <!-- 基本的なrecipe作成パターン -->
            <h3 style="color: var(--accent-cyan); margin: 2rem 0 1rem 0;">🏗️ 基本的なRecipe作成パターン</h3>
            
            <div class="code-block">
                <div class="code-header">
                    <div class="code-dots">
                        <div class="code-dot"></div>
                        <div class="code-dot"></div>
                        <div class="code-dot"></div>
                    </div>
                    <div class="code-title">basic_recipes.R</div>
                </div>
                <div class="code-content">
                    <span class="code-line"><span class="code-comment"># recipesパッケージによる基本的な前処理パイプライン</span></span>
                    <span class="code-line"><span class="code-function">library</span>(tidymodels)</span>
                    <span class="code-line"><span class="code-function">library</span>(tidyverse)</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># 日本の住宅価格データセット例</span></span>
                    <span class="code-line"><span class="code-function">set.seed</span>(<span class="code-string">123</span>)</span>
                    <span class="code-line"><span class="code-variable">housing_data</span> <span class="code-keyword">&lt;-</span> <span class="code-function">tibble</span>(</span>
                    <span class="code-line">  面積 = <span class="code-function">rnorm</span>(<span class="code-string">1000</span>, <span class="code-string">70</span>, <span class="code-string">20</span>),</span>
                    <span class="code-line">  築年数 = <span class="code-function">sample</span>(<span class="code-string">0</span>:<span class="code-string">40</span>, <span class="code-string">1000</span>, replace = <span class="code-string">TRUE</span>),</span>
                    <span class="code-line">  駅距離 = <span class="code-function">rexp</span>(<span class="code-string">1000</span>, <span class="code-string">0.3</span>),</span>
                    <span class="code-line">  階数 = <span class="code-function">sample</span>(<span class="code-string">1</span>:<span class="code-string">15</span>, <span class="code-string">1000</span>, replace = <span class="code-string">TRUE</span>),</span>
                    <span class="code-line">  エリア = <span class="code-function">sample</span>(<span class="code-function">c</span>(<span class="code-string">"都心部"</span>, <span class="code-string">"住宅地"</span>, <span class="code-string">"郊外"</span>, <span class="code-string">"駅前"</span>), <span class="code-string">1000</span>, replace = <span class="code-string">TRUE</span>),</span>
                    <span class="code-line">  建物種別 = <span class="code-function">sample</span>(<span class="code-function">c</span>(<span class="code-string">"マンション"</span>, <span class="code-string">"一戸建て"</span>, <span class="code-string">"アパート"</span>), <span class="code-string">1000</span>, replace = <span class="code-string">TRUE</span>),</span>
                    <span class="code-line">  リフォーム済み = <span class="code-function">sample</span>(<span class="code-function">c</span>(<span class="code-string">"済み"</span>, <span class="code-string">"未済"</span>), <span class="code-string">1000</span>, replace = <span class="code-string">TRUE</span>)</span>
                    <span class="code-line">) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">mutate</span>(</span>
                    <span class="code-line">    価格 = <span class="code-string">3000</span> + <span class="code-string">50</span> * 面積 - <span class="code-string">30</span> * 築年数 - <span class="code-string">200</span> * 駅距離 + </span>
                    <span class="code-line">           <span class="code-string">10</span> * 階数 + <span class="code-function">rnorm</span>(<span class="code-string">1000</span>, <span class="code-string">0</span>, <span class="code-string">300</span>)</span>
                    <span class="code-line">  )</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># 【1】基本的なrecipe：標準化と正規化</span></span>
                    <span class="code-line"><span class="code-variable">basic_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(価格 ~ ., data = housing_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 数値変数の標準化（平均0、分散1）</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># カテゴリ変数のダミー化</span></span>
                    <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 分散がゼロに近い変数の除去</span></span>
                    <span class="code-line">  <span class="code-function">step_zv</span>(<span class="code-function">all_predictors</span>())</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># recipeの準備と適用</span></span>
                    <span class="code-line"><span class="code-variable">prepped_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">prep</span>(basic_recipe)</span>
                    <span class="code-line"><span class="code-variable">processed_data</span> <span class="code-keyword">&lt;-</span> <span class="code-function">bake</span>(prepped_recipe, new_data = <span class="code-string">NULL</span>)</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-function">cat</span>(<span class="code-string">"元データの列数："</span>, <span class="code-function">ncol</span>(housing_data), <span class="code-string">"\n"</span>)</span>
                    <span class="code-line"><span class="code-function">cat</span>(<span class="code-string">"処理後の列数："</span>, <span class="code-function">ncol</span>(processed_data), <span class="code-string">"\n"</span>)</span>
                    <span class="code-line"><span class="code-function">cat</span>(<span class="code-string">"追加された変数名：\n"</span>)</span>
                    <span class="code-line"><span class="code-function">print</span>(<span class="code-function">setdiff</span>(<span class="code-function">names</span>(processed_data), <span class="code-function">names</span>(housing_data)))</span>
                </div>
            </div>

            <!-- 高度な特徴量エンジニアリング -->
            <h3 style="color: var(--accent-cyan); margin: 2rem 0 1rem 0;">🔧 高度な特徴量エンジニアリング パターン集</h3>
            
            <div class="code-block">
                <div class="code-header">
                    <div class="code-dots">
                        <div class="code-dot"></div>
                        <div class="code-dot"></div>
                        <div class="code-dot"></div>
                    </div>
                    <div class="code-title">advanced_feature_engineering.R</div>
                </div>
                <div class="code-content">
                    <span class="code-line"><span class="code-comment"># 【2】多項式特徴量とカテゴリエンコーディング</span></span>
                    <span class="code-line"><span class="code-variable">polynomial_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(価格 ~ ., data = housing_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 面積の2次・3次項を追加（非線形関係をキャプチャ）</span></span>
                    <span class="code-line">  <span class="code-function">step_poly</span>(面積, degree = <span class="code-string">3</span>) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 築年数の対数変換（減衰効果をモデル化）</span></span>
                    <span class="code-line">  <span class="code-function">step_log</span>(築年数, offset = <span class="code-string">1</span>) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 駅距離の平方根変換（距離効果の非線形性）</span></span>
                    <span class="code-line">  <span class="code-function">step_sqrt</span>(駅距離) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 頻度エンコーディング（カテゴリの出現頻度を数値化）</span></span>
                    <span class="code-line">  <span class="code-function">step_count</span>(エリア, 建物種別) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># ターゲットエンコーディング（カテゴリごとの目的変数平均）</span></span>
                    <span class="code-line">  <span class="code-function">step_lencode_glm</span>(エリア, outcome = <span class="code-function">vars</span>(価格)) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 交互作用項の作成</span></span>
                    <span class="code-line">  <span class="code-function">step_interact</span>(~ 面積:階数) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>())</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># 【3】外れ値処理とデータクリーニング</span></span>
                    <span class="code-line"><span class="code-variable">outlier_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(価格 ~ ., data = housing_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 四分位範囲による外れ値除去</span></span>
                    <span class="code-line">  <span class="code-function">step_rm_outliers</span>(面積, 価格, method = <span class="code-string">"IQR"</span>, multiplier = <span class="code-string">1.5</span>) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 欠損値の処理：数値変数は中央値で補完</span></span>
                    <span class="code-line">  <span class="code-function">step_impute_median</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># カテゴリ変数は最頻値で補完</span></span>
                    <span class="code-line">  <span class="code-function">step_impute_mode</span>(<span class="code-function">all_nominal_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># Winsorization：極値を95%・5%点でクリップ</span></span>
                    <span class="code-line">  <span class="code-function">step_range</span>(<span class="code-function">all_numeric_predictors</span>(), min = <span class="code-string">0.05</span>, max = <span class="code-string">0.95</span>) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>())</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># 【4】時系列特徴量の作成</span></span>
                    <span class="code-line"><span class="code-comment"># 日付データを含むサンプル作成</span></span>
                    <span class="code-line"><span class="code-variable">timeseries_data</span> <span class="code-keyword">&lt;-</span> housing_data <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">mutate</span>(</span>
                    <span class="code-line">    売却日 = <span class="code-function">sample</span>(</span>
                    <span class="code-line">      <span class="code-function">seq</span>(<span class="code-function">as.Date</span>(<span class="code-string">"2020-01-01"</span>), <span class="code-function">as.Date</span>(<span class="code-string">"2023-12-31"</span>), by = <span class="code-string">"day"</span>),</span>
                    <span class="code-line">      <span class="code-string">1000</span>, replace = <span class="code-string">TRUE</span></span>
                    <span class="code-line">    )</span>
                    <span class="code-line">  )</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-variable">datetime_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(価格 ~ ., data = timeseries_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 日付から年・月・曜日を抽出</span></span>
                    <span class="code-line">  <span class="code-function">step_date</span>(売却日, features = <span class="code-function">c</span>(<span class="code-string">"year"</span>, <span class="code-string">"month"</span>, <span class="code-string">"dow"</span>)) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 四半期情報の抽出</span></span>
                    <span class="code-line">  <span class="code-function">step_mutate</span>(四半期 = <span class="code-function">lubridate</span>::<span class="code-function">quarter</span>(売却日)) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 季節性の表現（三角関数変換）</span></span>
                    <span class="code-line">  <span class="code-function">step_harmonic</span>(売却日_month, frequency = <span class="code-string">12</span>, cycle_size = <span class="code-string">12</span>) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 元の日付列は削除</span></span>
                    <span class="code-line">  <span class="code-function">step_rm</span>(売却日) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>())</span>
                </div>
            </div>

            <!-- テキストデータの前処理 -->
            <h3 style="color: var(--accent-cyan); margin: 2rem 0 1rem 0;">📝 テキストデータの前処理パターン</h3>
            
            <div class="code-block">
                <div class="code-header">
                    <div class="code-dots">
                        <div class="code-dot"></div>
                        <div class="code-dot"></div>
                        <div class="code-dot"></div>
                    </div>
                    <div class="code-title">text_processing_recipes.R</div>
                </div>
                <div class="code-content">
                    <span class="code-line"><span class="code-comment"># 【5】テキストデータを含む不動産データ</span></span>
                    <span class="code-line"><span class="code-variable">text_housing_data</span> <span class="code-keyword">&lt;-</span> housing_data <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">mutate</span>(</span>
                    <span class="code-line">    物件説明 = <span class="code-function">sample</span>(<span class="code-function">c</span>(</span>
                    <span class="code-line">      <span class="code-string">"駅近で便利な立地です"</span>, <span class="code-string">"閑静な住宅街にあります"</span>, <span class="code-string">"リフォーム済みで綺麗です"</span>,</span>
                    <span class="code-line">      <span class="code-string">"日当たり良好で明るいです"</span>, <span class="code-string">"ペット可物件です"</span>, <span class="code-string">"南向きで眺望良好"</span>,</span>
                    <span class="code-line">      <span class="code-string">"新築同様の美品です"</span>, <span class="code-string">"駐車場完備しています"</span>, <span class="code-string">"商業施設が近くにあります"</span></span>
                    <span class="code-line">    ), <span class="code-string">1000</span>, replace = <span class="code-string">TRUE</span>)</span>
                    <span class="code-line">  )</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># textrecipesパッケージが必要</span></span>
                    <span class="code-line"><span class="code-comment"># install.packages("textrecipes")</span></span>
                    <span class="code-line"><span class="code-function">library</span>(textrecipes)</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-variable">text_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(価格 ~ ., data = text_housing_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># テキストのトークン化</span></span>
                    <span class="code-line">  <span class="code-function">step_tokenize</span>(物件説明) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 低頻度単語の除去（5回未満の単語を削除）</span></span>
                    <span class="code-line">  <span class="code-function">step_tokenfilter</span>(物件説明, min_times = <span class="code-string">5</span>) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># TF-IDF変換</span></span>
                    <span class="code-line">  <span class="code-function">step_tfidf</span>(物件説明) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 数値変数の標準化</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># カテゴリ変数のダミー化</span></span>
                    <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>())</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># より高度なテキスト前処理</span></span>
                    <span class="code-line"><span class="code-variable">advanced_text_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(価格 ~ ., data = text_housing_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 文字数・単語数の特徴量を作成</span></span>
                    <span class="code-line">  <span class="code-function">step_mutate</span>(</span>
                    <span class="code-line">    説明文字数 = <span class="code-function">nchar</span>(物件説明),</span>
                    <span class="code-line">    説明単語数 = <span class="code-function">stringr</span>::<span class="code-function">str_count</span>(物件説明, <span class="code-string">"\\S+"</span>)</span>
                    <span class="code-line">  ) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># キーワードの有無を特徴量化</span></span>
                    <span class="code-line">  <span class="code-function">step_mutate</span>(</span>
                    <span class="code-line">    駅近フラグ = <span class="code-function">ifelse</span>(<span class="code-function">stringr</span>::<span class="code-function">str_detect</span>(物件説明, <span class="code-string">"駅近"</span>), <span class="code-string">1</span>, <span class="code-string">0</span>),</span>
                    <span class="code-line">    リフォームフラグ = <span class="code-function">ifelse</span>(<span class="code-function">stringr</span>::<span class="code-function">str_detect</span>(物件説明, <span class="code-string">"リフォーム"</span>), <span class="code-string">1</span>, <span class="code-string">0</span>),</span>
                    <span class="code-line">    日当たりフラグ = <span class="code-function">ifelse</span>(<span class="code-function">stringr</span>::<span class="code-function">str_detect</span>(物件説明, <span class="code-string">"日当たり"</span>), <span class="code-string">1</span>, <span class="code-string">0</span>)</span>
                    <span class="code-line">  ) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_rm</span>(物件説明) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>())</span>
                </div>
            </div>

            <!-- 次元削減とPCA -->
            <h3 style="color: var(--accent-cyan); margin: 2rem 0 1rem 0;">📐 次元削減と主成分分析</h3>
            
            <div class="code-block">
                <div class="code-header">
                    <div class="code-dots">
                        <div class="code-dot"></div>
                        <div class="code-dot"></div>
                        <div class="code-dot"></div>
                    </div>
                    <div class="code-title">dimensionality_reduction.R</div>
                </div>
                <div class="code-content">
                    <span class="code-line"><span class="code-comment"># 【6】高次元データの作成（多くの特徴量を持つデータ）</span></span>
                    <span class="code-line"><span class="code-variable">high_dim_data</span> <span class="code-keyword">&lt;-</span> housing_data <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">mutate</span>(</span>
                    <span class="code-line">    <span class="code-comment"># 周辺環境指標を追加</span></span>
                    <span class="code-line">    学校距離 = <span class="code-function">rexp</span>(<span class="code-string">1000</span>, <span class="code-string">0.5</span>),</span>
                    <span class="code-line">    病院距離 = <span class="code-function">rexp</span>(<span class="code-string">1000</span>, <span class="code-string">0.3</span>),</span>
                    <span class="code-line">    商店街距離 = <span class="code-function">rexp</span>(<span class="code-string">1000</span>, <span class="code-string">0.4</span>),</span>
                    <span class="code-line">    公園距離 = <span class="code-function">rexp</span>(<span class="code-string">1000</span>, <span class="code-string">0.6</span>),</span>
                    <span class="code-line">    コンビニ距離 = <span class="code-function">rexp</span>(<span class="code-string">1000</span>, <span class="code-string">0.8</span>),</span>
                    <span class="code-line">    <span class="code-comment"># 建物詳細指標</span></span>
                    <span class="code-line">    バルコニー面積 = <span class="code-function">rnorm</span>(<span class="code-string">1000</span>, <span class="code-string">8</span>, <span class="code-string">3</span>),</span>
                    <span class="code-line">    収納面積 = <span class="code-function">rnorm</span>(<span class="code-string">1000</span>, <span class="code-string">5</span>, <span class="code-string">2</span>),</span>
                    <span class="code-line">    天井高 = <span class="code-function">rnorm</span>(<span class="code-string">1000</span>, <span class="code-string">2.4</span>, <span class="code-string">0.2</span>),</span>
                    <span class="code-line">    部屋数 = <span class="code-function">sample</span>(<span class="code-string">1</span>:<span class="code-string">5</span>, <span class="code-string">1000</span>, replace = <span class="code-string">TRUE</span>)</span>
                    <span class="code-line">  )</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># PCAによる次元削減recipe</span></span>
                    <span class="code-line"><span class="code-variable">pca_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(価格 ~ ., data = high_dim_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># カテゴリ変数のダミー化</span></span>
                    <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 分散ゼロの変数を除去</span></span>
                    <span class="code-line">  <span class="code-function">step_zv</span>(<span class="code-function">all_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 標準化（PCAの前に必須）</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># PCA：分散の90%を保持する成分数を自動選択</span></span>
                    <span class="code-line">  <span class="code-function">step_pca</span>(<span class="code-function">all_numeric_predictors</span>(), threshold = <span class="code-string">0.9</span>) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 高相関変数の除去</span></span>
                    <span class="code-line">  <span class="code-function">step_corr</span>(<span class="code-function">all_numeric_predictors</span>(), threshold = <span class="code-string">0.8</span>)</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># ICAによる独立成分分析</span></span>
                    <span class="code-line"><span class="code-variable">ica_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(価格 ~ ., data = high_dim_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_zv</span>(<span class="code-function">all_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 独立成分分析：5成分を抽出</span></span>
                    <span class="code-line">  <span class="code-function">step_ica</span>(<span class="code-function">all_numeric_predictors</span>(), num_comp = <span class="code-string">5</span>)</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># UMAP/t-SNEによる非線形次元削減</span></span>
                    <span class="code-line"><span class="code-comment"># embed パッケージが必要</span></span>
                    <span class="code-line"><span class="code-variable">umap_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(価格 ~ ., data = high_dim_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># UMAP：2次元に削減</span></span>
                    <span class="code-line">  <span class="code-function">step_umap</span>(<span class="code-function">all_numeric_predictors</span>(), num_comp = <span class="code-string">2</span>)</span>
                </div>
            </div>

            <!-- 特殊なrecipe応用例 -->
            <h3 style="color: var(--accent-cyan); margin: 2rem 0 1rem 0;">🎯 実務で役立つ特殊な前処理パターン</h3>
            
            <div class="code-block">
                <div class="code-header">
                    <div class="code-dots">
                        <div class="code-dot"></div>
                        <div class="code-dot"></div>
                        <div class="code-dot"></div>
                    </div>
                    <div class="code-title">special_recipes.R</div>
                </div>
                <div class="code-content">
                    <span class="code-line"><span class="code-comment"># 【7】不均衡データの処理</span></span>
                    <span class="code-line"><span class="code-comment"># themisパッケージが必要（install.packages("themis")）</span></span>
                    <span class="code-line"><span class="code-function">library</span>(themis)</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># 分類問題用の不均衡データを作成</span></span>
                    <span class="code-line"><span class="code-variable">imbalanced_data</span> <span class="code-keyword">&lt;-</span> housing_data <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">mutate</span>(</span>
                    <span class="code-line">    高額物件 = <span class="code-function">ifelse</span>(価格 &gt; <span class="code-function">quantile</span>(価格, <span class="code-string">0.8</span>), <span class="code-string">"Yes"</span>, <span class="code-string">"No"</span>) <span class="code-keyword">%&gt;%</span> <span class="code-function">as.factor</span>()</span>
                    <span class="code-line">  ) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">select</span>(-価格)</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-variable">resampling_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(高額物件 ~ ., data = imbalanced_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># SMOTE：合成マイノリティオーバーサンプリング</span></span>
                    <span class="code-line">  <span class="code-function">step_smote</span>(高額物件) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># または、単純なアップサンプリング</span></span>
                    <span class="code-line">  <span class="code-comment"># step_upsample(高額物件) %>%</span></span>
                    <span class="code-line">  <span class="code-comment"># または、ダウンサンプリング</span></span>
                    <span class="code-line">  <span class="code-comment"># step_downsample(高額物件) %>%</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>())</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># 【8】カスタム変換関数の作成</span></span>
                    <span class="code-line"><span class="code-comment"># 独自の前処理関数を定義</span></span>
                    <span class="code-line"><span class="code-variable">価格帯分類</span> <span class="code-keyword">&lt;-</span> <span class="code-keyword">function</span>(価格) {</span>
                    <span class="code-line">  <span class="code-function">case_when</span>(</span>
                    <span class="code-line">    価格 &lt; <span class="code-string">2000</span> ~ <span class="code-string">"低価格帯"</span>,</span>
                    <span class="code-line">    価格 &lt; <span class="code-string">4000</span> ~ <span class="code-string">"中価格帯"</span>,</span>
                    <span class="code-line">    価格 &lt; <span class="code-string">6000</span> ~ <span class="code-string">"高価格帯"</span>,</span>
                    <span class="code-line">    <span class="code-string">TRUE</span> ~ <span class="code-string">"超高級"</span></span>
                    <span class="code-line">  )</span>
                    <span class="code-line">}</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-variable">custom_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(価格 ~ ., data = housing_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># カスタム関数を使った特徴量作成</span></span>
                    <span class="code-line">  <span class="code-function">step_mutate</span>(</span>
                    <span class="code-line">    <span class="code-comment"># 面積と築年数の比率</span></span>
                    <span class="code-line">    面積築年数比 = 面積 / (<span class="code-function">pmax</span>(築年数, <span class="code-string">1</span>)),</span>
                    <span class="code-line">    <span class="code-comment"># 駅距離の逆数（近いほど大きい値）</span></span>
                    <span class="code-line">    駅近度 = <span class="code-string">1</span> / (<span class="code-string">1</span> + 駅距離),</span>
                    <span class="code-line">    <span class="code-comment"># 条件分岐による特徴量</span></span>
                    <span class="code-line">    新築フラグ = <span class="code-function">ifelse</span>(築年数 &lt;= <span class="code-string">3</span>, <span class="code-string">1</span>, <span class="code-string">0</span>),</span>
                    <span class="code-line">    大型物件フラグ = <span class="code-function">ifelse</span>(面積 &gt;= <span class="code-string">100</span>, <span class="code-string">1</span>, <span class="code-string">0</span>)</span>
                    <span class="code-line">  ) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 外れ値の処理：Yeo-Johnson変換</span></span>
                    <span class="code-line">  <span class="code-function">step_YeoJohnson</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># Box-Cox変換（正の値のみ）</span></span>
                    <span class="code-line">  <span class="code-comment"># step_BoxCox(all_numeric_predictors()) %>%</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>())</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># 【9】役割分担による複雑なrecipe</span></span>
                    <span class="code-line"><span class="code-variable">comprehensive_recipe</span> <span class="code-keyword">&lt;-</span> <span class="code-function">recipe</span>(価格 ~ ., data = housing_data) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 【段階1】データクリーニング</span></span>
                    <span class="code-line">  <span class="code-function">step_filter</span>(面積 &gt; <span class="code-string">0</span>, 築年数 &gt;= <span class="code-string">0</span>) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_impute_knn</span>(<span class="code-function">all_numeric_predictors</span>(), neighbors = <span class="code-string">5</span>) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 【段階2】特徴量エンジニアリング</span></span>
                    <span class="code-line">  <span class="code-function">step_mutate</span>(log_面積 = <span class="code-function">log</span>(面積 + <span class="code-string">1</span>)) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_interact</span>(~ 面積:エリア) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 【段階3】エンコーディング</span></span>
                    <span class="code-line">  <span class="code-function">step_novel</span>(<span class="code-function">all_nominal_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_other</span>(<span class="code-function">all_nominal_predictors</span>(), threshold = <span class="code-string">0.01</span>) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_dummy</span>(<span class="code-function">all_nominal_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 【段階4】正規化とスケーリング</span></span>
                    <span class="code-line">  <span class="code-function">step_zv</span>(<span class="code-function">all_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-function">step_normalize</span>(<span class="code-function">all_numeric_predictors</span>()) <span class="code-keyword">%&gt;%</span></span>
                    <span class="code-line">  <span class="code-comment"># 【段階5】最終調整</span></span>
                    <span class="code-line">  <span class="code-function">step_corr</span>(<span class="code-function">all_numeric_predictors</span>(), threshold = <span class="code-string">0.9</span>)</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-comment"># 全てのrecipeの確認</span></span>
                    <span class="code-line"><span class="code-function">cat</span>(<span class="code-string">"=== Recipe処理結果の比較 ===\n"</span>)</span>
                    <span class="code-line"><span class="code-function">recipes_list</span> <span class="code-keyword">&lt;-</span> <span class="code-function">list</span>(</span>
                    <span class="code-line">  基本処理 = basic_recipe,</span>
                    <span class="code-line">  多項式処理 = polynomial_recipe,</span>
                    <span class="code-line">  外れ値処理 = outlier_recipe,</span>
                    <span class="code-line">  PCA処理 = pca_recipe,</span>
                    <span class="code-line">  包括処理 = comprehensive_recipe</span>
                    <span class="code-line">)</span>
                    <span class="code-line"></span>
                    <span class="code-line"><span class="code-function">purrr</span>::<span class="code-function">imap</span>(recipes_list, <span class="code-keyword">function</span>(recipe, name) {</span>
                    <span class="code-line">  prepped <span class="code-keyword">&lt;-</span> <span class="code-function">prep</span>(recipe)</span>
                    <span class="code-line">  processed <span class="code-keyword">&lt;-</span> <span class="code-function">bake</span>(prepped, new_data = <span class="code-string">NULL</span>)</span>
                    <span class="code-line">  <span class="code-function">cat</span>(<span class="code-function">sprintf</span>(<span class="code-string">"%s: %d列 → %d列\n"</span>, name, <span class="code-function">ncol</span>(housing_data), <span class="code-function">ncol</span>(processed)))</span>
                    <span class="code-line">})</span>
                </div>
            </div>
        </section>

        <div class="key-points">
            <h4>第11章の重要ポイント</h4>
            <ul>
                <li><strong>tidymodels統合</strong>：一貫したワークフローでML全体をカバー</li>
                <li><strong>rsample</strong>：層化サンプリングとクロスバリデーション</li>
                <li><strong>recipes完全活用</strong>：30以上の実用的前処理パターンを網羅</li>
                <li><strong>parsnip</strong>：統一されたモデルインターフェース</li>
                <li><strong>workflows</strong>：前処理とモデルの結合</li>
                <li><strong>再現性</strong>：Tidyverseの原則に基づく美しいコード</li>
            </ul>
        </div>

        <div class="tip-box">
            <h4>実践的アドバイス</h4>
            <p>tidymodelsは、機械学習のベストプラクティスを自然に身につけられるよう設計されています。データリークの防止、適切なリサンプリング、一貫した評価指標など、実務で重要な要素が組み込まれています。従来のRの機械学習ワークフローと比較して、より安全で再現性の高い分析が可能になります。</p>
        </div>


    <!-- 学習におすすめの書籍 -->
    <section class="book-recommendations" style="margin: 4rem 0; padding: 2rem; background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 20px; backdrop-filter: blur(10px);">
        <div class="container">
            <h3 style="color: var(--neon-cyan); font-family: var(--font-tech); font-size: 1.8rem; margin-bottom: 2rem; text-align: center;">
                📚 学習におすすめの書籍
            </h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem;">
                
                <!-- Book 1 -->
                <div class="book-card" style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 15px; padding: 1.5rem; transition: all 0.3s ease; position: relative; overflow: hidden;">
                    <a href="https://amzn.to/48d9vpc" target="_blank" rel="noopener" style="text-decoration: none; color: inherit;">
                        <div style="display: flex; flex-direction: column; height: 100%;">
                            <div style="flex: 1;">
                                <h4 style="color: var(--neon-lime); font-size: 1.2rem; margin-bottom: 1rem; font-family: var(--font-tech);">
                                    🔥 RユーザのためのRStudio[実践]入門
                                </h4>
                                <p style="color: rgba(255, 255, 255, 0.8); font-size: 0.95rem; line-height: 1.6; margin-bottom: 1rem;">
                                    tidyverseの基礎から実践まで網羅した日本語決定版。RStudioとtidyverseでデータ分析をマスター。
                                </p>
                            </div>
                            <div style="background: var(--gradient-cyber); color: var(--void-black); padding: 0.8rem 1.5rem; border-radius: 25px; text-align: center; font-weight: 600; font-family: var(--font-tech); margin-top: auto;">
                                Amazonで詳細を見る →
                            </div>
                        </div>
                    </a>
                </div>
                
                <!-- Book 2 -->
                <div class="book-card" style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 15px; padding: 1.5rem; transition: all 0.3s ease; position: relative; overflow: hidden;">
                    <a href="https://amzn.to/3IfcanU" target="_blank" rel="noopener" style="text-decoration: none; color: inherit;">
                        <div style="display: flex; flex-direction: column; height: 100%;">
                            <div style="flex: 1;">
                                <h4 style="color: var(--neon-magenta); font-size: 1.2rem; margin-bottom: 1rem; font-family: var(--font-tech);">
                                    🤖 Rユーザのためのtidymodels[実践]入門
                                </h4>
                                <p style="color: rgba(255, 255, 255, 0.8); font-size: 0.95rem; line-height: 1.6; margin-bottom: 1rem;">
                                    tidymodelsで機械学習を実践するための日本語ガイド。モデル構築から評価まで完全網羅。
                                </p>
                            </div>
                            <div style="background: var(--gradient-plasma); color: white; padding: 0.8rem 1.5rem; border-radius: 25px; text-align: center; font-weight: 600; font-family: var(--font-tech); margin-top: auto;">
                                Amazonで詳細を見る →
                            </div>
                        </div>
                    </a>
                </div>
                
            </div>
            
            <div style="text-align: center; margin-top: 2rem;">
                <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; font-style: italic;">
                    ※ 当サイトはAmazonアソシエイトプログラムに参加しています
                </p>
            </div>
        </div>
    </section>

    <!-- Chapter Navigation -->
    <nav style="margin: 4rem 0; display: flex; justify-content: space-between; align-items: center; padding: 2rem; background: var(--bg-secondary); border-radius: 15px; max-width: 1200px; margin-left: auto; margin-right: auto;">
        <a href="chapter10-statistics-modeling.html" style="padding: 12px 24px; background: var(--accent-electric); color: var(--bg-primary); text-decoration: none; border-radius: 8px; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 0 10px rgba(0, 255, 65, 0.4);">← 第10章: 統計モデリング</a>
        <a href="index.html" style="padding: 12px 24px; background: var(--accent-cyan); color: var(--bg-primary); text-decoration: none; border-radius: 8px; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 0 10px rgba(0, 212, 255, 0.4);">目次へ戻る</a>
        <a href="chapter12-next-topic.html" style="padding: 12px 24px; background: var(--accent-electric); color: var(--bg-primary); text-decoration: none; border-radius: 8px; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 0 10px rgba(0, 255, 65, 0.4);">第12章: 高度な分析手法 →</a>
    </nav>
    
    <style>
    .book-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
        border-color: var(--neon-cyan);
    }

    .book-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: left 0.5s ease;
    }

    .book-card:hover::before {
        left: 100%;
    }
    </style>

    </div>
</body>
</html>